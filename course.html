<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Sovereignty Mastery Program</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <!-- Fonts & Icons -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css"/>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" />

  <style>
    :root {
      --bg: #0b0f14; 
      --card: #121825; 
      --card-2: #0f1522; 
      --text: #e8eefc; 
      --muted: #aeb7c9;
      --accent: #7c7cff; 
      --accent-2: #5fe1b9; 
      --gold: #f6c667; 
      --danger: #ff6b6b; 
      --ok: #22c55e;
      --border: rgba(255,255,255,.08); 
      --shadow: 0 10px 30px rgba(0,0,0,.35); 
      --radius: 14px;
      --transition: all 0.3s ease;
    }
    
    * { box-sizing: border-box; margin: 0; padding: 0; }
    
    html, body {
      margin: 0;
      background: linear-gradient(180deg, #0b0f14 0%, #0e1320 100%);
      color: var(--text);
      font-family: Inter, system-ui, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
      line-height: 1.6;
      overflow-x: hidden;
    }
    
    a { color: inherit; text-decoration: none; }
    
    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 20px;
    }
    
    /* Header */
    .header {
      padding: 2rem 0 1rem;
      display: flex;
      flex-direction: column;
      gap: 0.75rem;
      margin-bottom: 1.5rem;
      position: relative;
    }
    
    .header h1 {
      margin: 0;
      font-weight: 800;
      letter-spacing: -0.5px;
      font-size: 2.5rem;
      background: linear-gradient(135deg, var(--accent-2), var(--accent));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }
    
    .header p {
      margin: 0;
      color: var(--muted);
      font-size: 1.1rem;
      max-width: 800px;
    }
    
    /* Navigation */
    .main-nav {
      display: flex;
      gap: 1rem;
      margin-bottom: 1.5rem;
      flex-wrap: wrap;
    }
    
    .nav-item {
      padding: 0.5rem 1rem;
      border-radius: 8px;
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid var(--border);
      cursor: pointer;
      transition: var(--transition);
    }
    
    .nav-item:hover, .nav-item.active {
      background: linear-gradient(90deg, var(--accent), #8a7cff);
      color: white;
    }
    
    /* Wallet */
    .wallet-bar {
      display: flex;
      gap: 10px;
      align-items: center;
      flex-wrap: wrap;
      margin-top: 1rem;
      padding: 1rem;
      background: rgba(15, 23, 42, 0.6);
      border-radius: var(--radius);
      border: 1px solid var(--border);
    }
    
    .wallet-btn {
      background: linear-gradient(90deg, var(--accent-2), var(--accent));
      border: none;
      color: #0b0f14;
      padding: 10px 16px;
      border-radius: 12px;
      font-weight: 700;
      cursor: pointer;
      transition: var(--transition);
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .wallet-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(124, 124, 255, 0.3);
    }
    
    .chip {
      background: rgba(15, 21, 35, 0.8);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 8px 12px;
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 0.9rem;
      transition: var(--transition);
    }
    
    .chip:hover {
      transform: translateY(-1px);
      box-shadow: var(--shadow);
    }
    
    .chip .dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: #777;
    }
    
    .chip.ok .dot {
      background: var(--ok);
    }
    
    .mono {
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
      letter-spacing: 0.2px;
    }
    
    .small-btn {
      background: transparent;
      border: 1px solid var(--border);
      color: #cfe2ff;
      border-radius: 8px;
      padding: 4px 8px;
      cursor: pointer;
      transition: var(--transition);
    }
    
    .small-btn:hover {
      background: rgba(255, 255, 255, 0.1);
    }
    
    /* Progress */
    .progress-container {
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      padding: 1.5rem;
      margin: 1.5rem 0;
      box-shadow: var(--shadow);
      transition: var(--transition);
    }
    
    .progress-container:hover {
      transform: translateY(-3px);
      box-shadow: 0 15px 35px rgba(0, 0, 0, 0.4);
    }
    
    .progress-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1rem;
    }
    
    .progress-title {
      font-weight: 700;
      font-size: 1.2rem;
    }
    
    .progress-percentage {
      font-weight: 700;
      color: var(--accent);
      font-size: 1.2rem;
    }
    
    .progress-bar {
      height: 12px;
      background: rgba(255, 255, 255, 0.06);
      border-radius: 999px;
      overflow: hidden;
      margin-bottom: 0.5rem;
    }
    
    .progress-fill {
      height: 100%;
      width: 0;
      background: linear-gradient(90deg, var(--accent), #8a7cff, var(--gold));
      border-radius: 999px;
      transition: width 0.7s ease;
      position: relative;
      overflow: hidden;
    }
    
    .progress-fill::after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      bottom: 0;
      right: 0;
      background-image: linear-gradient(
        -45deg,
        rgba(255, 255, 255, 0.2) 25%,
        transparent 25%,
        transparent 50%,
        rgba(255, 255, 255, 0.2) 50%,
        rgba(255, 255, 255, 0.2) 75%,
        transparent 75%,
        transparent
      );
      z-index: 1;
      background-size: 20px 20px;
      animation: move 1s linear infinite;
      overflow: hidden;
    }
    
    @keyframes move {
      0% {
        background-position: 0 0;
      }
      100% {
        background-position: 20px 20px;
      }
    }
    
    .progress-stats {
      display: flex;
      gap: 1.5rem;
      color: var(--muted);
      font-size: 0.95rem;
      flex-wrap: wrap;
    }
    
    /* Modules grid */
    .modules-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(340px, 1fr));
      gap: 20px;
      margin: 2rem 0;
    }
    
    .module-card {
      background: linear-gradient(180deg, var(--card), var(--card-2));
      border: 1px solid var(--border);
      border-radius: var(--radius);
      padding: 1.5rem;
      display: flex;
      flex-direction: column;
      gap: 1rem;
      box-shadow: var(--shadow);
      transition: var(--transition);
      position: relative;
      overflow: hidden;
      height: 100%;
    }
    
    .module-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: linear-gradient(90deg, var(--accent), var(--accent-2));
      opacity: 0;
      transition: var(--transition);
    }
    
    .module-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 15px 35px rgba(0, 0, 0, 0.4);
    }
    
    .module-card:hover::before {
      opacity: 1;
    }
    
    .module-header {
      display: grid;
      grid-template-columns: auto 1fr;
      grid-template-rows: auto auto;
      column-gap: 12px;
    }
    
    .module-badge {
      height: 40px;
      width: 40px;
      border-radius: 10px;
      background: rgba(124, 124, 255, 0.16);
      border: 1px solid rgba(124, 124, 255, 0.3);
      display: grid;
      place-items: center;
      font-weight: 800;
      color: #bfbfff;
      font-size: 1.1rem;
    }
    
    .module-title {
      margin: 0;
      font-size: 1.3rem;
      font-weight: 700;
    }
    
    .module-theme {
      grid-column: 2;
      color: var(--muted);
      font-size: 0.95rem;
      margin-top: -2px;
    }
    
    .module-content {
      color: var(--muted);
      flex-grow: 1;
    }
    
    .module-description {
      margin-bottom: 1rem;
    }
    
    .learning-objectives h4 {
      margin: 0.5rem 0 0.5rem;
      font-weight: 600;
      color: #dfe6fb;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .objectives-list {
      margin: 0.5rem 0 0 1.1rem;
    }
    
    .objectives-list li {
      margin: 0.35rem 0;
      position: relative;
    }
    
    .objectives-list li::marker {
      color: var(--accent);
    }
    
    .module-footer {
      margin-top: auto;
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 10px;
    }
    
    .module-status {
      display: flex;
      align-items: center;
      gap: 8px;
      color: var(--muted);
      font-size: 0.9rem;
    }
    
    .status-indicator {
      width: 10px;
      height: 10px;
      border-radius: 50%;
      background: #777;
      transition: var(--transition);
    }
    
    .status-indicator.completed {
      background: var(--ok);
      box-shadow: 0 0 10px rgba(34, 197, 94, 0.5);
    }
    
    .status-indicator.in-progress {
      background: #f59e0b;
      box-shadow: 0 0 10px rgba(245, 158, 11, 0.5);
    }
    
    .module-button {
      background: linear-gradient(90deg, var(--accent), #8a7cff);
      border: none;
      color: white;
      padding: 10px 16px;
      border-radius: 12px;
      cursor: pointer;
      font-weight: 600;
      display: inline-flex;
      align-items: center;
      gap: 8px;
      transition: var(--transition);
    }
    
    .module-button:hover {
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(124, 124, 255, 0.3);
    }
    
    .module-button:focus-visible {
      outline: 3px solid rgba(124, 124, 255, 0.45);
    }
    
    /* Detail */
    .back-to-modules {
      display: none;
      margin: 1.5rem 0 1rem;
      text-decoration: none;
      color: #cfe2ff;
      padding: 0.5rem 1rem;
      border-radius: 8px;
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid var(--border);
      width: fit-content;
      transition: var(--transition);
    }
    
    .back-to-modules:hover {
      background: rgba(255, 255, 255, 0.1);
    }
    
    .module-detail {
      display: none;
      background: linear-gradient(180deg, #0f1522, #0b101b);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      padding: 2rem;
      box-shadow: var(--shadow);
      margin-bottom: 2rem;
      animation: fadeIn 0.5s ease;
    }
    
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    .detail-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      gap: 10px;
      margin-bottom: 1.5rem;
      padding-bottom: 1rem;
      border-bottom: 1px solid var(--border);
    }
    
    .detail-title {
      margin: 0;
      font-size: 1.8rem;
      font-weight: 700;
    }
    
    .detail-theme {
      color: var(--muted);
      font-size: 1.1rem;
      margin-top: 0.5rem;
    }
    
    .detail-close {
      background: transparent;
      border: 1px solid var(--border);
      color: #98a4c8;
      height: 40px;
      width: 40px;
      border-radius: 8px;
      cursor: pointer;
      transition: var(--transition);
    }
    
    .detail-close:hover {
      background: rgba(255, 255, 255, 0.1);
    }
    
    /* Content styles */
    .detail-content {
      line-height: 1.7;
    }
    
    .detail-content h3 {
      margin: 1.5rem 0 0.75rem;
      color: var(--accent-2);
      font-weight: 600;
    }
    
    .detail-content p {
      margin: 0.75rem 0;
    }
    
    .detail-content ul, .detail-content ol {
      margin: 0.75rem 0;
      padding-left: 1.5rem;
    }
    
    .detail-content li {
      margin: 0.5rem 0;
    }
    
    .practice-box {
      background: rgba(124, 124, 255, 0.08);
      border: 1px dashed rgba(124, 124, 255, 0.35);
      border-radius: 12px;
      padding: 1.25rem;
      margin: 1.25rem 0;
    }
    
    .key-quote {
      background: rgba(255, 255, 255, 0.04);
      border-left: 4px solid var(--gold);
      padding: 1rem 1.25rem;
      border-radius: 8px;
      margin: 1.25rem 0;
      font-style: italic;
    }
    
    .module-complete {
      margin: 1.25rem 0;
      padding: 1rem;
      background: rgba(34, 197, 94, 0.1);
      border: 1px solid rgba(34, 197, 94, 0.3);
      border-radius: 8px;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    
    .module-next {
      color: #b7c7ff;
      text-decoration: none;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 8px;
      margin-top: 1rem;
      padding: 0.5rem 1rem;
      border-radius: 8px;
      background: rgba(183, 199, 255, 0.1);
      transition: var(--transition);
    }
    
    .module-next:hover {
      background: rgba(183, 199, 255, 0.2);
    }
    
    /* Wealth Codes nav */
    .nav-container {
      display: flex;
      gap: 0.75rem;
      flex-wrap: wrap;
      margin: 1.5rem 0;
    }
    
    .nav-button {
      background: #12172a;
      border: 1px solid var(--border);
      color: #dfe6fb;
      border-radius: 999px;
      padding: 8px 16px;
      cursor: pointer;
      transition: var(--transition);
    }
    
    .nav-button:hover, .nav-button.active {
      background: linear-gradient(90deg, var(--accent-2), var(--accent));
      color: #0b0f14;
      border: none;
    }
    
    /* Hide the source content block */
    #courseContent {
      display: none;
    }
    
    /* Toast */
    .toast {
      position: fixed;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      background: #0f1422;
      color: #eaf2ff;
      border: 1px solid var(--border);
      padding: 12px 18px;
      border-radius: 10px;
      box-shadow: var(--shadow);
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.3s ease;
      z-index: 1000;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .toast.show {
      opacity: 1;
    }
    
    /* Footer */
    .footer {
      margin-top: 3rem;
      padding: 2rem 0;
      border-top: 1px solid var(--border);
      text-align: center;
      color: var(--muted);
      font-size: 0.9rem;
    }
    
    /* Responsive */
    @media (max-width: 768px) {
      .header h1 {
        font-size: 2rem;
      }
      
      .modules-grid {
        grid-template-columns: 1fr;
      }
      
      .progress-stats {
        flex-direction: column;
        gap: 0.5rem;
      }
      
      .wallet-bar {
        flex-direction: column;
        align-items: flex-start;
      }
      
      .detail-header {
        flex-direction: column;
      }
    }
    
    /* Dark mode toggle */
    .theme-toggle {
      position: absolute;
      top: 1rem;
      right: 1rem;
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid var(--border);
      color: var(--text);
      width: 40px;
      height: 40px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: var(--transition);
    }
    
    .theme-toggle:hover {
      background: rgba(255, 255, 255, 0.2);
    }
    
    /* Loading animation */
    .loader {
      display: inline-block;
      width: 20px;
      height: 20px;
      border: 3px solid rgba(255, 255, 255, 0.3);
      border-radius: 50%;
      border-top-color: var(--accent);
      animation: spin 1s ease-in-out infinite;
    }
    
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
    
    /* Achievement badges */
    .achievement-badge {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 4px 8px;
      background: rgba(246, 198, 103, 0.15);
      border: 1px solid rgba(246, 198, 103, 0.3);
      border-radius: 999px;
      font-size: 0.8rem;
      color: var(--gold);
    }
    
    /* Sovereign Self specific styles */
    .bonus-section {
      background: rgba(124, 124, 255, 0.05);
      border: 1px solid rgba(124, 124, 255, 0.2);
      border-radius: var(--radius);
      padding: 1.5rem;
      margin: 1.5rem 0;
    }
    
    .bonus-section h3 {
      color: var(--gold);
      margin-top: 0;
    }
    
    .serif-italic {
      font-style: italic;
      font-family: Georgia, serif;
    }
    
    .code-number {
      position: absolute;
      top: -15px;
      left: -15px;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background: linear-gradient(135deg, var(--accent-2), var(--accent));
      color: #0b0f14;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 800;
      font-size: 1.2rem;
      box-shadow: var(--shadow);
      z-index: 1;
    }
    
    .sovereign-module {
      position: relative;
      background: linear-gradient(180deg, var(--card), var(--card-2));
      border: 1px solid var(--border);
      border-radius: var(--radius);
      padding: 2rem;
      margin: 2rem 0;
      box-shadow: var(--shadow);
    }
    
    .sovereign-module-title {
      font-size: 1.5rem;
      margin: 0 0 1rem 0;
      color: var(--accent-2);
    }
    
    .sovereign-module-content h3 {
      color: var(--gold);
      margin: 1.5rem 0 0.75rem;
    }
    
    .sovereign-module-content blockquote {
      background: rgba(255, 255, 255, 0.04);
      border-left: 4px solid var(--accent);
      padding: 1rem 1.25rem;
      border-radius: 8px;
      margin: 1.25rem 0;
      font-style: italic;
    }
    
    .sovereign-module-footer {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 2rem;
      padding-top: 1rem;
      border-top: 1px solid var(--border);
    }
    
    .completion-checkbox {
      display: flex;
      align-items: center;
      gap: 8px;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>Sovereignty Mastery Program</h1>
      <p>A 7-module transformative journey to reclaim your personal power and live with authentic authority</p>
      
      <button class="theme-toggle" id="themeToggle" aria-label="Toggle theme">
        <i class="fas fa-moon"></i>
      </button>

      <!-- Wallet bar -->
      <div class="wallet-bar">
        <button id="connectBtn" class="wallet-btn"><i class="fa-solid fa-wallet"></i> Connect Wallet</button>
        <div id="provChip" class="chip"><i class="fa-solid fa-triangle-exclamation" style="color:#ffd28a"></i> <span>No wallet detected</span></div>
        <div id="addrChip" class="chip" style="display:none"><span class="dot"></span><i class="fa-regular fa-id-card"></i> <span id="addrShort" class="mono">0xâ€¦</span> <button id="copyAddr" class="small-btn" title="Copy"><i class="fa-regular fa-copy"></i></button></div>
        <div id="chainChip" class="chip" style="display:none"><i class="fa-solid fa-network-wired"></i> <span id="chainName">Chain</span></div>
        <div id="balChip" class="chip" style="display:none"><i class="fa-solid fa-coins"></i> <span id="nativeBal" class="mono">0.0000</span> <button id="refreshBal" class="small-btn" title="Refresh"><i class="fa-solid fa-rotate"></i></button></div>
        <div id="gateChip" class="chip" style="display:none"><i class="fa-solid fa-key"></i> <span id="gateText">Checking accessâ€¦</span></div>
      </div>
    </div>

    <!-- Navigation -->
    <div class="main-nav">
      <div class="nav-item active" data-target="modules">Modules</div>
      <div class="nav-item" data-target="progress">Progress</div>
      <div class="nav-item" data-target="resources">Resources</div>
      <div class="nav-item" data-target="community">Community</div>
    </div>

    <!-- Progress -->
    <div class="progress-container" aria-live="polite">
      <div class="progress-header">
        <div class="progress-title">Your Progress</div>
        <div class="progress-percentage" id="progressPct">0% Complete</div>
      </div>
      <div class="progress-bar" aria-hidden="true">
        <div class="progress-fill" id="progressFill"></div>
      </div>
      <div class="progress-stats">
        <span id="progressCount">0 of 7 Modules Completed</span>
        <span>Estimated 12 hours to complete</span>
        <span id="timeSpent">Time spent: 0h 0m</span>
      </div>
    </div>

    <!-- Modules Grid -->
    <div class="modules-grid" id="modulesGrid" role="list">
      <!-- Cards 1â€“7 -->
      <div class="module-card" role="listitem" data-module="1">
        <div class="module-header">
          <div class="module-badge">1</div>
          <h3 class="module-title">Foundations of Self-Awareness</h3>
          <div class="module-theme">Becoming the Observer</div>
        </div>
        <div class="module-content">
          <p class="module-description">Self-awareness is the foundation of awakeningâ€”stepping out of unconscious streams to observe with clarity and compassion.</p>
          <div class="learning-objectives">
            <h4><i class="fas fa-brain"></i> Learning Objectives</h4>
            <ul class="objectives-list">
              <li>Lost-in-thought vs observing thought</li>
              <li>Daily mindfulness practices</li>
              <li>Journaling for clarity</li>
              <li>3-Layer Belief Audit</li>
            </ul>
          </div>
        </div>
        <div class="module-footer">
          <div class="module-status"><div class="status-indicator"></div><span class="status-text">Not Started</span></div>
          <button class="module-button" onclick="showModule(1)"><i class="fas fa-book-open"></i> Open</button>
        </div>
      </div>

      <div class="module-card" role="listitem" data-module="2">
        <div class="module-header">
          <div class="module-badge">2</div>
          <h3 class="module-title">Breaking the Illusion of Ego</h3>
          <div class="module-theme">You Are Not Your Story</div>
        </div>
        <div class="module-content">
          <p class="module-description">See through roles and labels; meet the silent watcher beyond narrative identity.</p>
          <div class="learning-objectives">
            <h4><i class="fas fa-bolt"></i> Learning Objectives</h4>
            <ul class="objectives-list">
              <li>Ego vs Essence</li>
              <li>Roles, labels & identity</li>
              <li>Silent Watcher practice</li>
              <li>Ego defenses</li>
            </ul>
          </div>
        </div>
        <div class="module-footer">
          <div class="module-status"><div class="status-indicator"></div><span class="status-text">Not Started</span></div>
          <button class="module-button" onclick="showModule(2)"><i class="fas fa-play-circle"></i> Open</button>
        </div>
      </div>

      <div class="module-card" role="listitem" data-module="3">
        <div class="module-header">
          <div class="module-badge">3</div>
          <h3 class="module-title">Entering the Now</h3>
          <div class="module-theme">Presence is Power</div>
        </div>
        <div class="module-content">
          <p class="module-description">Anchor attention in breath and senses; find the gap between thoughts.</p>
          <div class="learning-objectives">
            <h4><i class="fas fa-water"></i> Learning Objectives</h4>
            <ul class="objectives-list">
              <li>Past/Future fixation</li>
              <li>Sensory anchoring</li>
              <li>Listening as meditation</li>
              <li>Finding the silent gap</li>
            </ul>
          </div>
        </div>
        <div class="module-footer">
          <div class="module-status"><div class="status-indicator"></div><span class="status-text">Not Started</span></div>
          <button class="module-button" onclick="showModule(3)"><i class="fas fa-lock-open"></i> Open</button>
        </div>
      </div>

      <div class="module-card" role="listitem" data-module="4">
        <div class="module-header">
          <div class="module-badge">4</div>
          <h3 class="module-title">Surrender & Emotional Alchemy</h3>
          <div class="module-theme">Freedom Through Letting Go</div>
        </div>
        <div class="module-content">
          <p class="module-description">Transmute emotion by allowing, feeling, and releasing; discover power in surrender.</p>
          <div class="learning-objectives">
            <h4><i class="fas fa-feather"></i> Learning Objectives</h4>
            <ul class="objectives-list">
              <li>What surrender truly is</li>
              <li>Somatic flow of emotion</li>
              <li>3-Step alchemy</li>
              <li>Forgiveness as liberation</li>
            </ul>
          </div>
        </div>
        <div class="module-footer">
          <div class="module-status"><div class="status-indicator"></div><span class="status-text">Not Started</span></div>
          <button class="module-button" onclick="showModule(4)"><i class="fas fa-lock-open"></i> Open</button>
        </div>
      </div>

      <div class="module-card" role="listitem" data-module="5">
        <div class="module-header">
          <div class="module-badge">5</div>
          <h3 class="module-title">The Illusion of Separation</h3>
          <div class="module-theme">Remembering Oneness</div>
        </div>
        <div class="module-content">
          <p class="module-description">See the unity behind duality; meet relationships and nature as mirrors.</p>
          <div class="learning-objectives">
            <h4><i class="fas fa-infinity"></i> Learning Objectives</h4>
            <ul class="objectives-list">
              <li>Seeing through duality</li>
              <li>Relational mirrors</li>
              <li>Nature as teacher</li>
              <li>Entanglement & connection</li>
            </ul>
          </div>
        </div>
        <div class="module-footer">
          <div class="module-status"><div class="status-indicator"></div><span class="status-text">Not Started</span></div>
          <button class="module-button" onclick="showModule(5)"><i class="fas fa-lock-open"></i> Open</button>
        </div>
      </div>

      <div class="module-card" role="listitem" data-module="6">
        <div class="module-header">
          <div class="module-badge">6</div>
          <h3 class="module-title">Embodied Enlightenment</h3>
          <div class="module-theme">Wisdom in Action</div>
        </div>
        <div class="module-content">
          <p class="module-description">Integrate realization into daily life: shadow work, pillars of practice, sacred mundanity.</p>
          <div class="learning-objectives">
            <h4><i class="fas fa-seedling"></i> Learning Objectives</h4>
            <ul class="objectives-list">
              <li>Transcendence â†’ integration</li>
              <li>4 pillars of embodiment</li>
              <li>Shadow & wholeness</li>
              <li>Chop wood, carry water</li>
            </ul>
          </div>
        </div>
        <div class="module-footer">
          <div class="module-status"><div class="status-indicator"></div><span class="status-text">Not Started</span></div>
          <button class="module-button" onclick="showModule(6)"><i class="fas fa-lock-open"></i> Open</button>
        </div>
      </div>

      <div class="module-card" role="listitem" data-module="7">
        <div class="module-header">
          <div class="module-badge">7</div>
          <h3 class="module-title">Living as Awareness</h3>
          <div class="module-theme">The Unfolding Mystery</div>
        </div>
        <div class="module-content">
          <p class="module-description">Rest as awareness; move with spontaneity, impermanence, and effortless action.</p>
          <div class="learning-objectives">
            <h4><i class="fas fa-mountain-sun"></i> Learning Objectives</h4>
            <ul class="objectives-list">
              <li>Form & formlessness</li>
              <li>Flow & spontaneity</li>
              <li>Gift of impermanence</li>
              <li>Beyond seeking</li>
            </ul>
          </div>
        </div>
        <div class="module-footer">
          <div class="module-status"><div class="status-indicator"></div><span class="status-text">Not Started</span></div>
          <button class="module-button" onclick="showModule(7)"><i class="fas fa-lock-open"></i> Open</button>
        </div>
      </div>
    </div>

    <!-- Detail View -->
    <a href="#" class="back-to-modules" id="backToModules" onclick="hideModule();return false;">
      <i class="fas fa-arrow-left"></i> Back to All Modules
    </a>
    <div id="moduleDetail" class="module-detail" aria-live="polite">
      <div class="detail-header">
        <div>
          <h2 class="detail-title" id="detailTitle">Module</h2>
          <div class="detail-theme" id="detailTheme">Theme</div>
        </div>
        <button class="detail-close" onclick="hideModule()" aria-label="Close module details">
          <i class="fas fa-times"></i>
        </button>
      </div>
      <div id="detailBody" class="detail-content"></div>
    </div>

    <!-- Sovereign Self Section -->
    <hr style="border:0;border-top:1px solid rgba(255,255,255,.08);margin:2.5rem 0" />

    <!-- ===================================== -->
    <!-- The Sovereign Self (7) â€” Module Cards -->
    <!-- ===================================== -->
    <h2>ðŸŒŸ The Sovereign Self</h2>
    <p class="subtitle">Reclaim Your Throne, Live by Your Own Rules, and Embody Unshakable Authority</p>

    <!-- Sales Overview (optional intro card) -->
    <article class="bonus-section" id="sovereign-overview" style="margin-bottom:1.25rem">
      <h3>ðŸ”¥ Reclaim Your Throne</h3>
      <p class="serif-italic">Stop living by rules you never agreed to. Step into your sovereignty and claim your rightful throne as the author of your life.</p>
      <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));gap:1rem;margin-top:1rem">
        <div>
          <h4>Who This Is For</h4>
          <ul>
            <li>Seekers, healers & entrepreneurs ready for unshakable authority.</li>
            <li>Those tired of playing small or living by external expectations.</li>
            <li>Leaders who want systems of freedom, not control.</li>
            <li>Anyone who knows they're meant for more.</li>
          </ul>
        </div>
        <div>
          <h4>Who This Is Not For</h4>
          <ul>
            <li>Comfort over growth.</li>
            <li>Unwilling to self-reflect or face shadow.</li>
            <li>Quick fixes without commitment.</li>
            <li>Victimhood as identity.</li>
          </ul>
        </div>
      </div>
      <h4 style="margin-top:1rem">The Transformation</h4>
      <p><strong>Before:</strong> Approval-seeking, drained by systems of control, unsure of your inner voice.</p>
      <p><strong>After:</strong> Rooted in your inner throneâ€”clear boundaries, steady authority, sovereign stewardship, soul-aligned life.</p>
    </article>

    <!-- Sovereign Self Navigation -->
    <div class="nav-container" aria-label="Sovereign Self Navigation" style="margin:1rem 0 2rem; display:flex; gap:.5rem; flex-wrap:wrap">
      <button class="nav-button active" onclick="showSovereignModule('sv1')">Module 1</button>
      <button class="nav-button" onclick="showSovereignModule('sv2')">Module 2</button>
      <button class="nav-button" onclick="showSovereignModule('sv3')">Module 3</button>
      <button class="nav-button" onclick="showSovereignModule('sv4')">Module 4</button>
      <button class="nav-button" onclick="showSovereignModule('sv5')">Module 5</button>
      <button class="nav-button" onclick="showSovereignModule('sv6')">Module 6</button>
      <button class="nav-button" onclick="showSovereignModule('sv7')">Module 7</button>
    </div>

    <!-- SV Module 1 -->
    <div id="sv1" class="sovereign-module" style="display:block;">
      <div class="code-number">1</div>
      <div class="sovereign-module-title">The Call to Sovereignty</div>
      <div class="sovereign-module-content">
        <h3>Core Concept</h3>
        <p>True power begins with recognizing you're more than compliant patternsâ€”you are a sovereign soul called to reclaim your throne.</p>

        <h3>Learning Objectives</h3>
        <ul>
          <li>Identify where you've surrendered personal authority.</li>
          <li>Hear and trust the whisper of your sovereign self.</li>
          <li>Discern ego's fear from the soul's guidance.</li>
          <li>Commit to answering the call.</li>
        </ul>

        <h3>Key Lessons</h3>
        <ol>
          <li>Recognizing the Whisper of Your Soul</li>
          <li>The Illusion of the Matrix: Where You Gave Your Power Away</li>
          <li>The Archetype of The Sovereign: Mapping the Territory of Your Power</li>
          <li>The Sovereignty Audit: Taking Stock of Your Kingdom</li>
        </ol>

        <div class="practice-box">
          <h4>Worksheet â€” Sovereignty Audit</h4>
          <p>Journal on: Where do I delay my yes/no for external validation? What decision restores my power this week?</p>
        </div>

        <h3>Activation</h3>
        <blockquote>"The crown was never lost; it was waiting where you left itâ€”within."</blockquote>

        <div class="sovereign-module-footer">
          <div class="completion-checkbox">
            <input type="checkbox" id="svComplete1" data-track="sovereign-1">
            <label for="svComplete1">Mark as completed</label>
          </div>
          <a class="module-next" onclick="showSovereignModule('sv2')" style="cursor:pointer">Next: Dismantling the False Thrones â†’</a>
        </div>
      </div>
    </div>

    <!-- SV Module 2 -->
    <div id="sv2" class="sovereign-module" style="display:none;">
      <div class="code-number">2</div>
      <div class="sovereign-module-title">Dismantling the False Thrones</div>
      <div class="sovereign-module-content">
        <h3>Core Concept</h3>
        <p>To stand in sovereignty, first see the illusions and tyranniesâ€”external and internalâ€”that have claimed your throne.</p>

        <h3>Learning Objectives</h3>
        <ul>
          <li>Expose societal, cultural, and familial systems of disempowerment.</li>
          <li>Name and confront the "false kings" within.</li>
          <li>Recognize and dissolve hidden contracts of loyalty and silence.</li>
        </ul>

        <h3>Key Lessons</h3>
        <ol>
          <li>The Cultural Myths of Powerlessness</li>
          <li>Family Loyalties & Hidden Contracts</li>
          <li>Corporate, Religious & Social Thrones</li>
          <li>The Inner Critic as False King</li>
        </ol>

        <div class="practice-box">
          <h4>Practice â€” Breaking the Spell</h4>
          <p>Write one cultural/familial myth that limits you. Declare: "This no longer rules me." (Optional: burn safely as release.)</p>
        </div>

        <h3>Activation</h3>
        <blockquote>"You cannot overthrow what you refuse to name."</blockquote>

        <div class="sovereign-module-footer">
          <div class="completion-checkbox">
            <input type="checkbox" id="svComplete2" data-track="sovereign-2">
            <label for="svComplete2">Mark as completed</label>
          </div>
          <a class="module-next" onclick="showSovereignModule('sv3')" style="cursor:pointer">Next: The Inner Throne â†’</a>
        </div>
      </div>
    </div>

    <!-- SV Module 3 -->
    <div id="sv3" class="sovereign-module" style="display:none;">
      <div class="code-number">3</div>
      <div class="sovereign-module-title">The Inner Throne</div>
      <div class="sovereign-module-content">
        <h3>Core Concept</h3>
        <p>Sovereignty is an inner seat of power that no one can grant or revokeâ€”it must be claimed.</p>

        <h3>Learning Objectives</h3>
        <ul>
          <li>Anchor into soul-aligned values and principles.</li>
          <li>Establish embodied presence as your throne.</li>
          <li>Create self-anointing practices for daily alignment.</li>
        </ul>

        <h3>Key Lessons</h3>
        <ol>
          <li>The Anatomy of Inner Authority</li>
          <li>Claiming Your Core Values</li>
          <li>Presence, Posture & Power</li>
          <li>Rituals of Self-Anointing</li>
        </ol>

        <div class="practice-box">
          <h4>Practice â€” Sovereign Alignment Scan</h4>
          <p>Sit tall; breathe. Ask: "Where do I collapse when challenged?" With each exhale, re-seat yourself on the inner throne.</p>
        </div>

        <h3>Activation</h3>
        <blockquote>"Authority lives not only in words, but in the posture you practice."</blockquote>

        <div class="sovereign-module-footer">
          <div class="completion-checkbox">
            <input type="checkbox" id="svComplete3" data-track="sovereign-3">
            <label for="svComplete3">Mark as completed</label>
          </div>
          <a class="module-next" onclick="showSovereignModule('sv4')" style="cursor:pointer">Next: Boundaries, Consent & the Language of Power â†’</a>
        </div>
      </div>
    </div>

    <!-- SV Module 4 -->
    <div id="sv4" class="sovereign-module" style="display:none;">
      <div class="code-number">4</div>
      <div class="sovereign-module-title">Boundaries, Consent & the Language of Power</div>
      <div class="sovereign-module-content">
        <h3>Core Concept</h3>
        <p>Sovereign boundaries are not walls of defenseâ€”they are clear declarations of self-respect.</p>

        <h3>Learning Objectives</h3>
        <ul>
          <li>Redefine boundaries as sacred agreements.</li>
          <li>Practice consent as the sacred currency of power.</li>
          <li>Speak with clarity, strength, and compassion (C3).</li>
        </ul>

        <h3>Key Lessons</h3>
        <ol>
          <li>The Alchemy of Boundaries</li>
          <li>Consent as Sacred Currency</li>
          <li>The C3 Framework: Clear, Clean, Kind</li>
          <li>Saying No Without Guilt, Yes Without Fear</li>
        </ol>

        <div class="practice-box">
          <h4>Practice â€” Boundary Invocation</h4>
          <p>Aloud: "My yes is sacred. My no is holy. My consent is the throne from which I rule."</p>
        </div>

        <h3>Activation</h3>
        <blockquote>"What you allow becomes your law."</blockquote>

        <div class="sovereign-module-footer">
          <div class="completion-checkbox">
            <input type="checkbox" id="svComplete4" data-track="sovereign-4">
            <label for="svComplete4">Mark as completed</label>
          </div>
          <a class="module-next" onclick="showSovereignModule('sv5')" style="cursor:pointer">Next: Alchemy of Resources & Right Livelihood â†’</a>
        </div>
      </div>
    </div>

    <!-- SV Module 5 -->
    <div id="sv5" class="sovereign-module" style="display:none;">
      <div class="code-number">5</div>
      <div class="sovereign-module-title">Alchemy of Resources & Right Livelihood</div>
      <div class="sovereign-module-content">
        <h3>Core Concept</h3>
        <p>Sovereignty includes stewardship of time, energy, money, and relationships as sacred currents.</p>

        <h3>Learning Objectives</h3>
        <ul>
          <li>Transform scarcity into conscious stewardship.</li>
          <li>Align livelihood with soul-purpose.</li>
          <li>Redirect resources with intention.</li>
        </ul>

        <h3>Key Lessons</h3>
        <ol>
          <li>The Four Ledgers of Resource Sovereignty</li>
          <li>Wealth as Energy, Not Just Currency</li>
          <li>Right Livelihood & Sacred Work</li>
          <li>The Attention Economy & Energy Management</li>
        </ol>

        <div class="practice-box">
          <h4>Worksheet â€” Resource Audit</h4>
          <p>For each ledger (time, energy, money, relationships): Where am I leaking? Where am I aligned? One shift for this week?</p>
        </div>

        <h3>Activation</h3>
        <blockquote>"Every yes spends from a ledgerâ€”spend like a sovereign."</blockquote>

        <div class="sovereign-module-footer">
          <div class="completion-checkbox">
            <input type="checkbox" id="svComplete5" data-track="sovereign-5">
            <label for="svComplete5">Mark as completed</label>
          </div>
          <a class="module-next" onclick="showSovereignModule('sv6')" style="cursor:pointer">Next: Systems of Self-Governance â†’</a>
        </div>
      </div>
    </div>

    <!-- SV Module 6 -->
    <div id="sv6" class="sovereign-module" style="display:none;">
      <div class="code-number">6</div>
      <div class="sovereign-module-title">Systems of Self-Governance</div>
      <div class="sovereign-module-content">
        <h3>Core Concept</h3>
        <p>True freedom emerges from well-crafted agreements and systems that serve the soul.</p>

        <h3>Learning Objectives</h3>
        <ul>
          <li>Design rhythms, rituals, and agreements that support sovereignty.</li>
          <li>Create a personal constitution.</li>
          <li>Reduce decision fatigue through intentional design.</li>
        </ul>

        <h3>Key Lessons</h3>
        <ol>
          <li>Design Beats Discipline</li>
          <li>Minimum Viable Rituals</li>
          <li>Crafting Your Sovereign Constitution</li>
          <li>Review & Reset Rhythms</li>
        </ol>

        <div class="practice-box">
          <h4>Exercise â€” Draft Your Constitution</h4>
          <p>Write 5 Core Laws, 3 Practices, 2 Red Lines (non-negotiables). Read aloud each morning for 21 days.</p>
        </div>

        <h3>Activation</h3>
        <blockquote>"Freedom isn't the absence of structureâ€”it's the presence of sacred structure."</blockquote>

        <div class="sovereign-module-footer">
          <div class="completion-checkbox">
            <input type="checkbox" id="svComplete6" data-track="sovereign-6">
            <label for="svComplete6">Mark as completed</label>
          </div>
          <a class="module-next" onclick="showSovereignModule('sv7')" style="cursor:pointer">Next: The Sovereign in Service â†’</a>
        </div>
      </div>
    </div>

    <!-- SV Module 7 -->
    <div id="sv7" class="sovereign-module" style="display:none;">
      <div class="code-number">7</div>
      <div class="sovereign-module-title">The Sovereign in Service</div>
      <div class="sovereign-module-content">
        <h3>Core Concept</h3>
        <p>Sovereignty matures into stewardship and serviceâ€”your freedom empowers the collective.</p>

        <h3>Learning Objectives</h3>
        <ul>
          <li>Move from isolation into conscious contribution.</li>
          <li>Offer your gifts without depletion or martyrdom.</li>
          <li>Lead in reciprocity and responsibility.</li>
        </ul>

        <h3>Key Lessons</h3>
        <ol>
          <li>From Isolation to Belonging</li>
          <li>The Sovereign as Steward of the Commons</li>
          <li>Gifts, Roles & Service Design</li>
          <li>Legacy in Motion</li>
        </ol>

        <div class="practice-box">
          <h4>Exercise â€” Sovereign Service Vision</h4>
          <p>What gift burns to be shared? Who is it for? How do you serve without self-betrayal? One step in 72 hours.</p>
        </div>

        <h3>Activation</h3>
        <blockquote>"The true mark of a sovereign is the freedom they help others remember."</blockquote>

        <div class="sovereign-module-footer">
          <div class="completion-checkbox">
            <input type="checkbox" id="svComplete7" data-track="sovereign-7">
            <label for="svComplete7">Mark as completed</label>
          </div>
          <a class="module-next" onclick="showSovereignModule('sv1')" style="cursor:pointer">Return to Module 1 â†º</a>
        </div>
      </div>
    </div>

    <!-- Closing Ritual -->
    <article class="bonus-section" id="sovereign-closing" style="margin-top:1.25rem">
      <h3>ðŸ”® The Sovereign's Coronation</h3>
      <ol>
        <li>Dress in a way that symbolizes sovereignty.</li>
        <li>Light a candle and speak your personal constitution aloud.</li>
        <li>One hand on heart, one on crown: <em>"I reign from within. My sovereignty is sealed. I live, act, and serve as the Sovereign Self."</em></li>
        <li>Celebrate with a symbolic act (dance, feast, create).</li>
      </ol>
    </article>

    <!-- Hidden source Course Content (one copy only) -->
    <div id="courseContent">
      <!-- Module 1 Content -->
      <article id="module1">
        <h3>Foundations of Self-Awareness</h3>
        <h4>Theme: Becoming the Observer</h4>
        
        <p>Welcome to the first module of your sovereignty journey. Self-awareness is the foundational skill that allows you to step out of unconscious patterns and observe your experience with clarity and compassion.</p>
        
        <h3>Lost in Thought vs Observing Thought</h3>
        <p>Most people are completely identified with their thoughtsâ€”they believe they ARE their thoughts. The first step toward freedom is realizing that you are the awareness that witnesses thoughts, not the thoughts themselves.</p>
        
        <div class="practice-box">
          <h4><i class="fas fa-pen"></i> Practice: Thought Observation</h4>
          <p>Set a timer for 5 minutes. Sit quietly and simply notice thoughts as they arise. Don't engage with them or judge them. Just label them silently: "thinking... thinking..." Notice how thoughts come and go while your awareness remains.</p>
        </div>
        
        <h3>Daily Mindfulness Practices</h3>
        <p>Mindfulness is the practice of bringing non-judgmental awareness to the present moment. Regular practice strengthens your "observer muscle."</p>
        
        <ul>
          <li><strong>Breath awareness:</strong> 5 minutes upon waking, focusing only on the sensation of breathing</li>
          <li><strong>Sensory check-ins:</strong> Periodically throughout the day, notice what you see, hear, feel</li>
          <li><strong>Mindful eating:</strong> One meal daily with full attention to taste, texture, aroma</li>
        </ul>
        
        <h3>Journaling for Clarity</h3>
        <p>Writing helps externalize the contents of your mind, making patterns more visible. Try these prompts:</p>
        
        <ul>
          <li>What thoughts keep recurring today?</li>
          <li>What emotions am I experiencing without fully acknowledging them?</li>
          <li>Where did I operate on autopilot today?</li>
        </ul>
        
        <h3>3-Layer Belief Audit</h3>
        <p>Our beliefs shape our reality. Many operate unconsciously. Examine:</p>
        
        <ol>
          <li><strong>Surface beliefs:</strong> What do I say I believe? (Conscious opinions)</li>
          <li><strong>Operational beliefs:</strong> What do my actions reveal I believe? (Often unconscious)</li>
          <li><strong>Core beliefs:</strong> What fundamental assumptions shape my worldview? (Often formed in childhood)</li>
        </ol>
        
        <div class="key-quote">
          "The first step toward change is awareness. The second step is acceptance." â€” Nathaniel Branden
        </div>
        
        <div class="module-complete">
          <input type="checkbox" id="complete-module1" data-track="awakening-1">
          <label for="complete-module1">Mark this module complete</label>
        </div>
        
        <a href="#" class="module-next" onclick="showModule(2)">Next: Breaking the Illusion of Ego <i class="fas fa-arrow-right"></i></a>
      </article>
      
      <!-- Module 2 Content -->
      <article id="module2">
        <h3>Breaking the Illusion of Ego</h3>
        <h4>Theme: You Are Not Your Story</h4>
        
        <p>In this module, we explore the constructed nature of identity and learn to distinguish between the ego (the story of "me") and our essential being.</p>
        
        <h3>Ego vs Essence</h3>
        <p>The ego is a collection of thoughts, beliefs, memories, and identifications that form a sense of separate self. Essence is what remains when all these are seen throughâ€”your fundamental beingness.</p>
        
        <div class="practice-box">
          <h4><i class="fas fa-search"></i> Practice: Identity Inventory</h4>
          <p>Make a list of all the ways you identify yourself (roles, traits, accomplishments, relationships). For each, ask: "If I lost this, would I still be here? Who would I be without this story?"</p>
        </div>
        
        <h3>Roles, Labels & Identity</h3>
        <p>We unconsciously play roles: the good child, the competent professional, the victim, the helper. These roles come with unconscious rules and expectations that limit our freedom.</p>
        
        <ul>
          <li>Notice when you're playing a role rather than responding authentically</li>
          <li>Experiment with gently letting go of a familiar role for a day</li>
          <li>Observe the anxiety that arises when not identified with a familiar identity</li>
        </ul>
        
        <h3>Silent Watcher Practice</h3>
        <p>Beyond all stories and identities, there is simply awareness itselfâ€”the silent witness that observes everything without judgment.</p>
        
        <div class="practice-box">
          <h4><i class="fas fa-eye"></i> Practice: Abiding as Awareness</h4>
          <p>Sit quietly and notice: Can you find the one who is looking? Instead of looking for an object called "me," turn attention back on itself. Rest as the awareness that perceives everythingâ€”thoughts, sensations, soundsâ€”without needing to define or control any of it.</p>
        </div>
        
        <h3>Ego Defense Mechanisms</h3>
        <p>The ego defends its existence through various strategies. Common ones include:</p>
        
        <ul>
          <li><strong>Projection:</strong> Attributing disowned qualities to others</li>
          <li><strong>Rationalization:</strong> Making excuses for unconscious behavior</li>
          <li><strong>Identification:</strong> Strengthening identity through association</li>
          <li><strong>Resistance:</strong> Pushing away what threatens self-concept</li>
        </ul>
        
        <p>Simply noticing these patterns without judgment begins to dissolve their power.</p>
        
        <div class="key-quote">
          "The ego is nothing other than the focus of conscious attention." â€” Alan Watts
        </div>
        
        <div class="module-complete">
          <input type="checkbox" id="complete-module2" data-track="awakening-2">
          <label for="complete-module2">Mark this module complete</label>
        </div>
        
        <a href="#" class="module-next" onclick="showModule(3)">Next: Entering the Now <i class="fas fa-arrow-right"></i></a>
      </article>
      
      <!-- Module 3 Content -->
      <article id="module3">
        <h3>Entering the Now</h3>
        <h4>Theme: Presence is Power</h4>
        
        <p>Presence is the doorway to freedom. In this module, we practice anchoring attention in the eternal present moment where life actually occurs.</p>
        
        <h3>Past/Future Fixation</h3>
        <p>Most suffering arises from being mentally trapped in the past (regret, resentment, nostalgia) or future (anxiety, anticipation, planning). The present moment is often overlooked, yet it's the only place where we can actually experience life.</p>
        
        <div class="practice-box">
          <h4><i class="fas fa-hourglass-half"></i> Practice: Time Orientation Check</h4>
          <p>Periodically throughout the day, ask: "Where is my attention right now?" Note whether you're mentally in the past, future, or present. Without judgment, gently return to now.</p>
        </div>
        
        <h3>Sensory Anchoring</h3>
        <p>The senses only operate in the present moment. Using them as anchors is a powerful way to return to now.</p>
        
        <ul>
          <li><strong>Touch:</strong> Feel the contact points of your body with surfaces</li>
          <li><strong>Sight:</strong> Really look at something as if seeing it for the first time</li>
          <li><strong>Sound:</strong> Listen without labeling or interpretingâ€”just pure hearing</li>
          <li><strong>Breath:</strong> Notice the sensations of breathing without changing it</li>
        </ul>
        
        <h3>Listening as Meditation</h3>
        <p>Most listening is filtered through mental commentary, preparation of response, or judgment. Deep listening is a profound practice of presence.</p>
        
        <div class="practice-box">
          <h4><i class="fas fa-ear-listen"></i> Practice: Deep Listening</h4>
          <p>In your next conversation, give the speaker your complete attention. Notice when your mind wants to interrupt, judge, or prepare a response. Simply return to listening. Receive their words as pure sound before meaning arises.</p>
        </div>
        
        <h3>Finding the Silent Gap</h3>
        <p>Between thoughts, there is a natural gapâ€”a space of pure awareness. As practice deepens, these gaps widen, and you begin to rest in the silence that underlies all experience.</p>
        
        <ul>
          <li>Notice the space after a thought finishes and before the next begins</li>
          <li>Become interested in the silence between sounds</li>
          <li>Rest in the awareness that exists prior to mental content</li>
        </ul>
        
        <div class="key-quote">
          "Realize deeply that the present moment is all you ever have." â€” Eckhart Tolle
        </div>
        
        <div class="module-complete">
          <input type="checkbox" id="complete-module3" data-track="awakening-3">
          <label for="complete-module3">Mark this module complete</label>
        </div>
        
        <a href="#" class="module-next" onclick="showModule(4)">Next: Surrender & Emotional Alchemy <i class="fas fa-arrow-right"></i></a>
      </article>
      
      <!-- Module 4 Content -->
      <article id="module4">
        <h3>Surrender & Emotional Alchemy</h3>
        <h4>Theme: Freedom Through Letting Go</h4>
        
        <p>True freedom comes not from controlling our experience but from surrendering to what is. This module explores the transformative power of allowing and the alchemy of emotional energy.</p>
        
        <h3>What Surrender Truly Is</h3>
        <p>Surrender is not resignation or passivity. It is conscious acceptance of what is, without resistance. This creates space for intelligent response rather than reactive behavior.</p>
        
        <div class="practice-box">
          <h4><i class="fas fa-hands-open"></i> Practice: Micro-Surrender</h4>
          <p>Identify a minor irritation or discomfort. Instead of resisting or trying to fix it, consciously say "yes" to it. Allow it to be exactly as it is. Notice what happens to your relationship with the experience.</p>
        </div>
        
        <h3>Somatic Flow of Emotion</h3>
        <p>Emotions are energy in motion. When resisted, they become stuck. When allowed, they flow through and transform.</p>
        
        <ul>
          <li>Emotions manifest as sensations in the body</li>
          <li>Notice where you feel emotion physically</li>
          <li>Breathe into these areas without trying to change them</li>
          <li>Allow the energy to move and express naturally</li>
        </ul>
        
        <h3>3-Step Emotional Alchemy</h3>
        <ol>
          <li><strong>Allow:</strong> Let the emotion be here without judgment or story</li>
          <li><strong>Feel:</strong> Bring curious attention to the bodily sensations</li>
          <li><strong>Release:</strong> Breathe through the experience until it naturally dissolves</li>
        </ol>
        
        <div class="practice-box">
          <h4><i class="fas fa-fire"></i> Practice: Emotional Composting</h4>
          <p>When strong emotion arises, sit with it as if composting rich material. Don't act it out or repress it. Simply be present with the raw energy until it transforms into wisdom and vitality.</p>
        </div>
        
        <h3>Forgiveness as Liberation</h3>
        <p>Forgiveness is releasing the hope that the past could have been different. It's an act of self-liberation from the prison of resentment.</p>
        
        <ul>
          <li>Forgiveness doesn't mean condoning harmful behavior</li>
          <li>It means freeing yourself from the weight of carrying the past</li>
          <li>Practice forgiveness as a gift to yourself, not necessarily to others</li>
        </ul>
        
        <div class="key-quote">
          "Surrender is the simple but profound wisdom of yielding to rather than opposing the flow of life." â€” Eckhart Tolle
        </div>
        
        <div class="module-complete">
          <input type="checkbox" id="complete-module4" data-track="awakening-4">
          <label for="complete-module4">Mark this module complete</label>
        </div>
        
        <a href="#" class="module-next" onclick="showModule(5)">Next: The Illusion of Separation <i class="fas fa-arrow-right"></i></a>
      </article>
      
      <!-- Module 5 Content -->
      <article id="module5">
        <h3>The Illusion of Separation</h3>
        <h4>Theme: Remembering Oneness</h4>
        
        <p>As we awaken, we begin to see through the illusion of separation that creates suffering. This module explores the fundamental unity behind apparent diversity.</p>
        
        <h3>Seeing Through Duality</h3>
        <p>The mind operates through division: self/other, good/bad, pleasure/pain. Awakening reveals the underlying unity that contains and transcends all opposites.</p>
        
        <div class="practice-box">
          <h4><i class="fas fa-infinity"></i> Practice: Non-Dual Seeing</h4>
          <p>Look at an object without labeling it. See it as pure form, color, texture. Then expand awareness to include the space around it. Notice how object and space arise together. Can you find where one ends and the other begins?</p>
        </div>
        
        <h3>Relational Mirrors</h3>
        <p>Other people reflect back to us aspects of ourselves we've disowned or not yet recognized. Every relationship offers opportunities for awakening.</p>
        
        <ul>
          <li>What irritates you in others often points to unintegrated aspects of yourself</li>
          <li>What you admire in others may be qualities you're ready to embody</li>
          <li>Relationships as spiritual practice rather than means to fulfillment</li>
        </ul>
        
        <h3>Nature as Teacher</h3>
        <p>Nature operates without the illusion of separation. Spending time in natural settings can help reawaken our innate sense of connection.</p>
        
        <div class="practice-box">
          <h4><i class="fas fa-tree"></i> Practice: Nature Communion</h4>
          <p>Spend time in nature without devices or distractions. Allow your senses to open fully. Notice how the boundary between "you" and "nature" begins to soften. Experience yourself as part of the whole, not separate from it.</p>
        </div>
        
        <h3>Entanglement & Connection</h3>
        <p>Quantum physics reveals what mystics have always known: everything is interconnected at the fundamental level. Separation is an appearance, not ultimate reality.</p>
        
        <ul>
          <li>The illusion of separate existence creates suffering</li>
          <li>Recognizing interconnection naturally gives rise to compassion</li>
          <li>Service becomes natural expression rather than sacrifice</li>
        </ul>
        
        <div class="key-quote">
          "We are not drops in the ocean but the ocean in drops." â€” Rumi
        </div>
        
        <div class="module-complete">
          <input type="checkbox" id="complete-module5" data-track="awakening-5">
          <label for="complete-module5">Mark this module complete</label>
        </div>
        
        <a href="#" class="module-next" onclick="showModule(6)">Next: Embodied Enlightenment <i class="fas fa-arrow-right"></i></a>
      </article>
      
      <!-- Module 6 Content -->
      <article id="module6">
        <h3>Embodied Enlightenment</h3>
        <h4>Theme: Wisdom in Action</h4>
        
        <p>Awakening isn't just a transcendent experienceâ€”it must be embodied in daily life. This module focuses on integrating realization into your ordinary human experience.</p>
        
        <h3>Transcendence to Integration</h3>
        <p>Many spiritual seekers get stuck in transcendent states, avoiding the messy humanity of everyday life. True awakening includes and transforms our humanity rather than escaping it.</p>
        
        <div class="practice-box">
          <h4><i class="fas fa-arrows-alt-v"></i> Practice: Vertical and Horizontal</h4>
          <p>Practice alternating between "vertical" awareness (resting as pure consciousness) and "horizontal" engagement (fully participating in daily life). Gradually allow these to merge until there's no separation between presence and action.</p>
        </div>
        
        <h3>4 Pillars of Embodiment</h3>
        <ol>
          <li><strong>Presence:</strong> Bringing awareness to everyday activities</li>
          <li><strong>Feeling:</strong> Allowing emotions and sensations fully</li>
          <li><strong>Responsibility:</strong> Owning your experience without blame</li>
          <li><strong>Expression:</strong> Allowing life to move through you authentically</li>
        </ol>
        
        <h3>Shadow & Wholeness</h3>
        <p>The shadow contains disowned aspects of ourselves. Integration brings these aspects to light, making us more whole and authentic.</p>
        
        <ul>
          <li>What we judge in ourselves we often project onto others</li>
          <li>Shadow work involves compassionate investigation of our denied aspects</li>
          <li>Integration leads to greater authenticity and reduced internal conflict</li>
        </ul>
        
        <div class="practice-box">
          <h4><i class="fas fa-box-open"></i> Practice: Shadow Dialog</h4>
          <p>Identify a trait you dislike in others. Journal a conversation with this quality as if it were a part of you. Ask what gift it might bring if integrated consciously.</p>
        </div>
        
        <h3>Chop Wood, Carry Water</h3>
        <p>After awakening, the ordinary becomes extraordinary. Daily tasks become opportunities for presence and gratitude.</p>
        
        <ul>
          <li>Find the sacred in the mundane</li>
          <li>Let each activity be its own reward</li>
          <li>Practice full engagement regardless of the task</li>
        </ul>
        
        <div class="key-quote">
          "Before enlightenment, chop wood, carry water. After enlightenment, chop wood, carry water." â€” Zen Proverb
        </div>
        
        <div class="module-complete">
          <input type="checkbox" id="complete-module6" data-track="awakening-6">
          <label for="complete-module6">Mark this module complete</label>
        </div>
        
        <a href="#" class="module-next" onclick="showModule(7)">Next: Living as Awareness <i class="fas fa-arrow-right"></i></a>
      </article>
      
      <!-- Module 7 Content -->
      <article id="module7">
        <h3>Living as Awareness</h3>
        <h4>Theme: The Unfolding Mystery</h4>
        
        <p>In this final module, we explore what it means to live as awareness itselfâ€”allowing life to unfold with spontaneity, wisdom, and effortless action.</p>
        
        <h3>Form & Formlessness</h3>
        <p>You are both the manifest (form) and the unmanifest (formlessness). Living this paradox allows you to participate fully in life while resting in the eternal.</p>
        
        <div class="practice-box">
          <h4><i class="fas fa-chess-board"></i> Practice: Being and Doing</h4>
          <p>Alternate between periods of pure being (sitting in awareness without agenda) and engaged doing (action flowing from presence). Notice how these two modes begin to inform each other until action arises from being.</p>
        </div>
        
        <h3>Flow & Spontaneity</h3>
        <p>When identified as awareness, action arises spontaneously from intelligence rather than from egoic calculation.</p>
        
        <ul>
          <li>Notice the difference between calculated action and spontaneous movement</li>
          <li>Practice trusting the intelligence of the present moment</li>
          <li>Allow action to arise from stillness rather than mental agitation</li>
        </ul>
        
        <h3>Gift of Impermanence</h3>
        <p>Everything arises and passes away. Rather than creating suffering, impermanence can be recognized as the dance of life itself.</p>
        
        <div class="practice-box">
          <h4><i class="fas fa-hourglass-end"></i> Practice: Impermanence Meditation</h4>
          <p>Sit and notice everything that arisesâ€”thoughts, sensations, sounds. Watch each thing come and go. Rest in the awareness that witnesses this endless flow. Notice how even the witness itself is not a fixed thing.</p>
        </div>
        
        <h3>Beyond Seeking</h3>
        <p>Eventually, the seeking itself falls away. You recognize that what you've been looking for has always been hereâ€”your own presence.</p>
        
        <ul>
          <li>The end of seeking is the beginning of truly living</li>
          <li>Life becomes an exploration rather than a project of self-improvement</li>
          <li>Each moment is complete as it is, even as it flows into the next</li>
        </ul>
        
        <div class="key-quote">
          "The mystery of life is not a problem to be solved but a reality to be experienced." â€” Jan van der Leeuw
        </div>
        
        <div class="module-complete">
          <input type="checkbox" id="complete-module7" data-track="awakening-7">
          <label for="complete-module7">Mark this module complete</label>
        </div>
        
        <div class="practice-box" style="background:rgba(246,198,103,0.1);border-color:rgba(246,198,103,0.4)">
          <h4><i class="fas fa-graduation-cap"></i> Congratulations on Completing the Program!</h4>
          <p>You've journeyed through the essential teachings of sovereignty mastery. Remember that this is not an endpoint but a new beginning. Continue to live these understandings, and allow them to deepen organically over time.</p>
        </div>
      </article>
      
      <!-- Wealth Codes Content -->
      <article id="swc1">
        <h3>Sovereign Wealth Code 1: Value Alignment</h3>
        <p>True wealth begins with aligning your resources with your deepest values. Money becomes energy that expresses your sovereignty rather than compromises it.</p>
        
        <h4>Key Principles:</h4>
        <ul>
          <li>Your net worth is not your self-worth</li>
          <li>Wealth flows to those who create value authentically</li>
          <li>Financial decisions should reflect your truth, not external expectations</li>
        </ul>
        
        <div class="practice-box">
          <h4><i class="fas fa-balance-scale"></i> Practice: Value-Based Budgeting</h4>
          <p>Review your expenses from the past month. Categorize them according to how well they align with your core values. Notice where your money supports your sovereignty and where it might be compromising it.</p>
        </div>
        
        <div class="nav-container">
          <button class="nav-button" onclick="showModule('swc2')">Code 2</button>
          <button class="nav-button" onclick="showModule('swc3')">Code 3</button>
          <button class="nav-button" onclick="showModule('swc4')">Code 4</button>
          <button class="nav-button" onclick="showModule('swc5')">Code 5</button>
          <button class="nav-button" onclick="showModule('swc6')">Code 6</button>
          <button class="nav-button" onclick="showModule('swc7')">Code 7</button>
        </div>
      </article>
      
      <article id="swc2">
        <h3>Sovereign Wealth Code 2: Energy Exchange</h3>
        <p>Money represents energy exchange. Sovereign wealth comes from exchanges that honor both parties' energy and contribute to genuine well-being.</p>
        
        <h4>Key Principles:</h4>
        <ul>
          <li>Charge what you're worth without apology</li>
          <li>Pay others fairly for their contributions</li>
          <li>Notice where exchanges feel draining versus energizing</li>
        </ul>
        
        <div class="practice-box">
          <h4><i class="fas fa-exchange-alt"></i> Practice: Energy Audit</h4>
          <p>List your current income sources. Rate each on a scale of 1-10 for how energetically aligned they feel. For lower-rated sources, explore how to either transform the energy of the exchange or transition to more aligned work.</p>
        </div>
        
        <div class="nav-container">
          <button class="nav-button" onclick="showModule('swc1')">Code 1</button>
          <button class="nav-button" onclick="showModule('swc3')">Code 3</button>
          <button class="nav-button" onclick="showModule('swc4')">Code 4</button>
          <button class="nav-button" onclick="showModule('swc5')">Code 5</button>
          <button class="nav-button" onclick="showModule('swc6')">Code 6</button>
          <button class="nav-button" onclick="showModule('swc7')">Code 7</button>
        </div>
      </article>
      
      <article id="swc3">
        <h3>Sovereign Wealth Code 3: Abundance Mindset</h3>
        <p>Scarcity is a mental construct. Sovereignty involves recognizing the abundant nature of reality and operating from that awareness.</p>
        
        <h4>Key Principles:</h4>
        <ul>
          <li>The universe is fundamentally abundant</li>
          <li>Scarcity thinking creates contraction and limitation</li>
          <li>Gratitude opens the flow of abundance</li>
        </ul>
        
        <div class="practice-box">
          <h4><i class="fas fa-hand-holding-heart"></i> Practice: Abundance Journal</h4>
          <p>Each day, write down three evidence of abundance in your lifeâ€”not just financial, but also relational, creative, natural, etc. Notice how this practice shifts your perception over time.</p>
        </div>
        
        <div class="nav-container">
          <button class="nav-button" onclick="showModule('swc1')">Code 1</button>
          <button class="nav-button" onclick="showModule('swc2')">Code 2</button>
          <button class="nav-button" onclick="showModule('swc4')">Code 4</button>
          <button class="nav-button" onclick="showModule('swc5')">Code 5</button>
          <button class="nav-button" onclick="showModule('swc6')">Code 6</button>
          <button class="nav-button" onclick="showModule('swc7')">Code 7</button>
        </div>
      </article>
      
      <article id="swc4">
        <h3>Sovereign Wealth Code 4: Conscious Consumption</h3>
        <p>Every purchase is a vote for the world you want to create. Sovereign wealth involves mindful stewardship of resources.</p>
        
        <h4>Key Principles:</h4>
        <ul>
          <li>Spend in alignment with your values</li>
          <li>Support ethical businesses and practices</li>
          <li>Reduce consumption where it doesn't serve well-being</li>
        </ul>
        
        <div class="practice-box">
          <h4><i class="fas fa-shopping-cart"></i> Practice: Values-Based Spending</h4>
          <p>Before making any significant purchase, pause and ask: "Does this purchase align with my values? Does it support my well-being and the well-being of others? Is there a more conscious alternative?"</p>
        </div>
        
        <div class="nav-container">
          <button class="nav-button" onclick="showModule('swc1')">Code 1</button>
          <button class="nav-button" onclick="showModule('swc2')">Code 2</button>
          <button class="nav-button" onclick="showModule('swc3')">Code 3</button>
          <button class="nav-button" onclick="showModule('swc5')">Code 5</button>
          <button class="nav-button" onclick="showModule('swc6')">Code 6</button>
          <button class="nav-button" onclick="showModule('swc7')">Code 7</button>
        </div>
      </article>
      
      <article id="swc5">
        <h3>Sovereign Wealth Code 5: Generous Flow</h3>
        <p>Wealth circulates like bloodâ€”hoarding creates stagnation, while generous flow enhances vitality for all.</p>
        
        <h4>Key Principles:</h4>
        <ul>
          <li>Giving reinforces abundance consciousness</li>
          <li>Generosity should feel joyful, not obligatory</li>
          <li>Wealth grows when it serves life</li>
        </ul>
        
        <div class="practice-box">
          <h4><i class="fas fa-hand-holding-usd"></i> Practice: Conscious Giving</h4>
          <p>Set aside a percentage of your income for giving. Choose recipients that align with your values. Notice the energy and intention behind your givingâ€”is it from scarcity or abundance?</p>
        </div>
        
        <div class="nav-container">
          <button class="nav-button" onclick="showModule('swc1')">Code 1</button>
          <button class="nav-button" onclick="showModule('swc2')">Code 2</button>
          <button class="nav-button" onclick="showModule('swc3')">Code 3</button>
          <button class="nav-button" onclick="showModule('swc4')">Code 4</button>
          <button class="nav-button" onclick="showModule('swc6')">Code 6</button>
          <button class="nav-button" onclick="showModule('swc7')">Code 7</button>
        </div>
      </article>
      
      <article id="swc6">
        <h3>Sovereign Wealth Code 6: Investment as Stewardship</h3>
        <p>Sovereign investing means allocating resources to create a world that aligns with your values and supports future generations.</p>
        
        <h4>Key Principles:</h4>
        <ul>
          <li>Your investments shape the world</li>
          <li>Consider environmental, social, and governance factors</li>
          <li>Divest from what harms; invest in what heals</li>
        </ul>
        
        <div class="practice-box">
          <h4><i class="fas fa-chart-line"></i> Practice: Portfolio Alignment</h4>
          <p>Review your investments (including retirement accounts). Research how well they align with your values. Consider shifting even a small percentage to more conscious investments as a start.</p>
        </div>
        
        <div class="nav-container">
          <button class="nav-button" onclick="showModule('swc1')">Code 1</button>
          <button class="nav-button" onclick="showModule('swc2')">Code 2</button>
          <button class="nav-button" onclick="showModule('swc3')">Code 3</button>
          <button class="nav-button" onclick="showModule('swc4')">Code 4</button>
          <button class="nav-button" onclick="showModule('swc5')">Code 5</button>
          <button class="nav-button" onclick="showModule('swc7')">Code 7</button>
        </div>
      </article>
      
      <article id="swc7">
        <h3>Sovereign Wealth Code 7: Legacy Consciousness</h3>
        <p>True wealth extends beyond your lifetime. Sovereign wealth considers the impact of your resources on future generations and the planet.</p>
        
        <h4>Key Principles:</h4>
        <ul>
          <li>We are temporary stewards of resources, not owners</li>
          <li>Consider the seven-generation impact of financial decisions</li>
          <li>Wealth is ultimately about well-being, not accumulation</li>
        </ul>
        
        <div class="practice-box">
          <h4><i class="fas fa-seedling"></i> Practice: Legacy Planning</h4>
          <p>Write a brief "legacy statement" describing what you want your resources to contribute to the world beyond your lifetime. Review your estate plans (will, trusts, etc.) to ensure they reflect this intention.</p>
        </div>
        
        <div class="nav-container">
          <button class="nav-button" onclick="showModule('swc1')">Code 1</button>
          <button class="nav-button" onclick="showModule('swc2')">Code 2</button>
          <button class="nav-button" onclick="showModule('swc3')">Code 3</button>
          <button class="nav-button" onclick="showModule('swc4')">Code 4</button>
          <button class="nav-button" onclick="showModule('swc5')">Code 5</button>
          <button class="nav-button" onclick="showModule('swc6')">Code 6</button>
        </div>
      </article>

      <section id="certificate" class="section">
        <h2 class="section-title">MINT YOUR CERTIFICATE</h2>
        <div class="section-content">
          <div class="section-text">
            <p>Unlock your onâ€‘chain Certificate of Sovereignty once you complete all 7 modules and hold the required tokens.</p>

            <div id="eligibilityChecklist" class="tokenomics-card" style="margin-top:1rem;">
              <h3 style="text-align:left;margin-bottom:1rem;">Eligibility</h3>
              <p><span class="highlight">Course:</span> <span id="courseStatus">Checkingâ€¦</span></p>
              <p><span class="highlight">KLY Balance:</span> <span id="klyStatus">â€”</span> (need â‰¥ 500)</p>
              <p><span class="highlight">SÃ³lCoin Balance:</span> <span id="solStatus">â€”</span> (need â‰¥ 1)</p>
              <div style="margin-top:1rem;display:flex;gap:.75rem;align-items:center;">
                <button id="mintCertificateBtn" class="module-button" disabled><i class="fas fa-certificate"></i> Mint Certificate NFT</button>
                <span id="certMintStatus" style="color:#b3b3b3;">â€”</span>
              </div>
            </div>
          </div>

          <div class="section-image">
            <div class="tokenomics-card" style="text-align:center;">
              <h3>Onâ€‘Chain Proof</h3>
              <p>Immutable NFT certificate issued to your wallet.</p>
              <p>Verifiable on BscScan and across the KLY ecosystem.</p>
            </div>
          </div>
        </div>
      </section>
    </div>
 
    <!-- Footer -->
    <div class="footer">
      <p>Sovereignty Mastery Program &copy; 2025 â€¢ All rights reserved</p>
      <p>Designed for awakening consciousness and reclaiming personal sovereignty</p>
    </div>
  </div>

  <div class="toast" id="toast" role="status" aria-live="polite"><i class="fas fa-check-circle"></i> Saved</div>

  <!-- Ethers v5 -->
<script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>
<script>
/* ===============================
   Small UX framework + helpers
   =============================== */
const $  = (s, r=document) => r.querySelector(s);
const $$ = (s, r=document) => Array.from(r.querySelectorAll(s));
const raf = (fn) => new Promise(r => requestAnimationFrame(() => { fn?.(); r(); }));

const toast = (m='Saved âœ”ï¸', icon='check-circle') => {
  const t = $('#toast');
  if (!t) return;
  t.innerHTML = `<i class="fas fa-${icon}"></i> ${m}`;
  t.classList.add('show');
  clearTimeout(toast.__t);
  toast.__t = setTimeout(() => t.classList.remove('show'), 1600);
};

const debounce = (fn, wait=300) => {
  let t; return (...args) => { clearTimeout(t); t = setTimeout(() => fn(...args), wait); };
};

const shortAddr = (a='') => a ? `${a.slice(0,6)}â€¦${a.slice(-4)}` : '';

/* ===============================
   Theme
   =============================== */
function initTheme() {
  const saved = localStorage.getItem('theme') || 'dark';
  document.documentElement.setAttribute('data-theme', saved);
  $('#themeToggle i').className = saved === 'dark' ? 'fas fa-sun' : 'fas fa-moon';
}
function toggleTheme() {
  const cur = document.documentElement.getAttribute('data-theme') || 'dark';
  const next = cur === 'dark' ? 'light' : 'dark';
  document.documentElement.setAttribute('data-theme', next);
  localStorage.setItem('theme', next);
  $('#themeToggle i').className = next === 'dark' ? 'fas fa-sun' : 'fas fa-moon';
}

/* ===============================
   Progress state (Awakening 1â€“7)
   =============================== */
const STORAGE_KEY = 'sovereignty-progress-v2';
const KEYS = ['awakening-1','awakening-2','awakening-3','awakening-4','awakening-5','awakening-6','awakening-7'];

const state = {
  completed: new Set(JSON.parse(localStorage.getItem(STORAGE_KEY) || '[]')),
  timeSpent: parseInt(localStorage.getItem('sovereignty-time') || '0', 10),
  achievements: JSON.parse(localStorage.getItem('sovereignty-achievements') || '[]'),
  currentModuleKey: null
};

const persist = debounce(() => {
  localStorage.setItem(STORAGE_KEY, JSON.stringify(Array.from(state.completed)));
  localStorage.setItem('sovereignty-time', String(state.timeSpent));
  localStorage.setItem('sovereignty-achievements', JSON.stringify(state.achievements));
}, 250);

function updateProgressUI() {
  const done = KEYS.filter(k => state.completed.has(k)).length;
  const pct = Math.round((done/KEYS.length)*100);
  $('#progressPct').textContent = `${pct}% Complete`;
  $('#progressFill').style.width = `${pct}%`;
  $('#progressCount').textContent = `${done} of ${KEYS.length} Modules Completed`;
  const h = Math.floor(state.timeSpent / 60), m = state.timeSpent % 60;
  $('#timeSpent').textContent = `Time spent: ${h}h ${m}m`;

  // Cards: reflect status
  $$('.modules-grid .module-card').forEach(card => {
    const key = `awakening-${card.getAttribute('data-module')}`;
    const ind = $('.status-indicator', card);
    const txt = $('.status-text', card);
    ind.classList.remove('completed', 'in-progress');
    if (state.completed.has(key)) { ind.classList.add('completed'); txt.textContent = 'Completed'; }
    else if (state.currentModuleKey === key) { ind.classList.add('in-progress'); txt.textContent = 'In Progress'; }
    else { txt.textContent = 'Not Started'; }
  });

  // Achievements (non-intrusive toasts)
  const newA = [];
  if (done >= 1 && !state.achievements.includes('first-step')) { state.achievements.push('first-step'); newA.push('First Step: Completed your first module!'); }
  if (done >= 3 && !state.achievements.includes('journey-begun')) { state.achievements.push('journey-begun'); newA.push('Journey Begun: Completed 3 modules!'); }
  if (done >= 7 && !state.achievements.includes('sovereign-master')) { state.achievements.push('sovereign-master'); newA.push('Sovereign Master: Completed all modules!'); }
  if (newA.length) { persist(); newA.forEach((msg, i) => setTimeout(() => toast(msg, 'trophy'), 500 + i*600)); }

  // Refresh cert block if visible (uses last-known balances)
  if (typeof updateCertificateEligibilityUI === 'function') {
    const courseDone = KEYS.every(k => state.completed.has(k));
    updateCertificateEligibilityUI({ courseDone });
  }
}

function saveProgress(silent=false) {
  persist();
  updateProgressUI();
  if (!silent) toast('Progress saved');
}

/* ===============================
   Detail view: content injection
   =============================== */
let timeTimer, pageVisible = true;
function startTimeTracking() {
  clearInterval(timeTimer);
  timeTimer = setInterval(() => {
    if (!pageVisible) return;
    state.timeSpent++;
    persist();
    updateProgressUI();
  }, 60000);
}
function stopTimeTracking() { clearInterval(timeTimer); }

document.addEventListener('visibilitychange', () => { pageVisible = !document.hidden; });

function injectArticle(el) {
  const title = $('h3', el)?.textContent || 'Module';
  const theme = $('h4', el)?.textContent?.replace(/^Theme:\s*/,'') || '';
  $('#detailTitle').textContent = title;
  $('#detailTheme').textContent = theme;

  const body = $('#detailBody'); body.innerHTML = '';
  Array.from(el.children).forEach(ch => body.appendChild(ch.cloneNode(true)));

  // Track which awakening module is "current" for card status
  const idMatch = /module(\d+)/.exec(el.id);
  state.currentModuleKey = idMatch ? `awakening-${idMatch[1]}` : state.currentModuleKey;

  // Wire completion checkboxes inside detail
  $$('#detailBody .module-complete input[type="checkbox"]').forEach(cb => {
    const k = cb.getAttribute('data-track');
    cb.checked = state.completed.has(k);
    cb.addEventListener('change', (e) => {
      if (e.target.checked) state.completed.add(k); else state.completed.delete(k);
      saveProgress(true);
    });
  });

  // Wire internal nav buttons (Wealth Codes)
  $$('#detailBody .nav-button').forEach(b => b.addEventListener('click', () => {
    const m = /Code\s+(\d+)/i.exec(b.textContent.trim());
    if (m) showModule('swc'+m[1]);
  }));

  startTimeTracking();
}

function showModule(id) {
  let src;
  if (/^\d$/.test(String(id))) {
    src = $(`#courseContent article#module${id}`);
  } else if (/^swc[1-7]$/.test(String(id))) {
    src = $(`#courseContent #${id}`);
  }
  if (!src) return console.warn('Module not found', id);

  injectArticle(src);
  $('#moduleDetail').style.display = 'block';
  $('#backToModules').style.display = 'inline-block';
  $('#moduleDetail').scrollIntoView({ behavior: 'smooth', block: 'start' });
  updateProgressUI();
}

function hideModule() {
  $('#moduleDetail').style.display = 'none';
  $('#backToModules').style.display = 'none';
  state.currentModuleKey = null;
  stopTimeTracking();
  updateProgressUI();
}

function restoreCheckboxes() {
  $$('#courseContent .module-complete input[type="checkbox"]').forEach(cb => {
    const k = cb.getAttribute('data-track');
    cb.checked = state.completed.has(k);
  });
}

/* =======================================
   Sovereign Self module navigation (SV)
   ======================================= */
function showSovereignModule(id) {
  $$('.sovereign-module').forEach(m => m.style.display = 'none');
  const node = $(`#${id}`);
  if (node) { node.style.display = 'block'; node.scrollIntoView({ behavior: 'smooth', block: 'start' }); }
  $$('.nav-button').forEach(b => b.classList.remove('active'));
  const btn = $(`.nav-button[onclick="showSovereignModule('${id}')"]`);
  if (btn) btn.classList.add('active');
}
// sync SV completion
function wireSovereignCheckboxes() {
  $$('.sovereign-module .completion-checkbox input').forEach(cb => {
    const k = cb.getAttribute('data-track');
    cb.checked = state.completed.has(k);
    cb.addEventListener('change', (e) => {
      if (e.target.checked) state.completed.add(k); else state.completed.delete(k);
      saveProgress(true);
    });
  });
}

/* ===============================
   Sections (nav real switching)
   =============================== */
function showSection(target) {
  // You can later add actual containers per section; for now we highlight and scroll
  $$('.main-nav .nav-item').forEach(i => i.classList.remove('active'));
  $(`.main-nav .nav-item[data-target="${target}"]`)?.classList.add('active');
  // Optionally route to anchors or focus key blocks:
  if (target === 'progress') $('.progress-container')?.scrollIntoView({ behavior: 'smooth' });
  if (target === 'modules') $('#modulesGrid')?.scrollIntoView({ behavior: 'smooth' });
}

/* ===============================
   Wallet / Gate (BNB + dual tokens)
   =============================== */
const EXPECTED_CHAIN = '0x38'; // BNB Smart Chain

const CHAIN_NAMES = {
  '0x1': 'Ethereum','0xaa36a7': 'Sepolia','0x89': 'Polygon','0xa4b1': 'Arbitrum','0xa': 'Optimism','0x38': 'BNB'
};
const NATIVE_SYMBOL = { '0x1':'ETH','0xaa36a7':'ETH','0x89':'MATIC','0xa4b1':'ETH','0xa':'ETH','0x38':'BNB' };

const CONFIG = {
  ENABLE_GATE: true,
  TOKENS: {
    KLY: { address: '0x2e4fEB2Fe668c8Ebe84f19e6c8fE8Cf8131B4E52', min: 500 },
    SOL: { address: '0x7a732Ae6b2Db2ceACc3Ffe6F63F3B9B0Ce94A026', min: 1 } // SÃ³lCoin
  },
  ERC20_ABI: [
    "function balanceOf(address) view returns (uint256)",
    "function decimals() view returns (uint8)",
    "function symbol() view returns (string)"
  ]
};

let provider, signer, account, chainId, listenersWired=false;

const connectBtn = $('#connectBtn'),
      provChip = $('#provChip'),
      addrChip = $('#addrChip'),
      chainChip = $('#chainChip'),
      balChip  = $('#balChip'),
      gateChip = $('#gateChip');

function paintWallet() {
  const hasEth = !!window.ethereum;
  provChip.style.display = hasEth ? 'none' : 'inline-flex';
  if (account) {
    $('#addrShort').textContent = shortAddr(account);
    $('#chainName').textContent = CHAIN_NAMES[chainId] || `Chain ${chainId}`;
    addrChip.style.display = 'inline-flex'; addrChip.classList.add('ok');
    chainChip.style.display = 'inline-flex';
    balChip.style.display = 'inline-flex';
    connectBtn.innerHTML = '<i class="fas fa-check"></i> Connected';
    connectBtn.disabled = true;
  } else {
    addrChip.style.display = 'none'; chainChip.style.display = 'none'; balChip.style.display = 'none';
    gateChip.style.display = 'none';
    connectBtn.innerHTML = '<i class="fa-solid fa-wallet"></i> Connect Wallet';
    connectBtn.disabled = false;
  }
}

async function ensureExpectedChain() {
  if (!window.ethereum) return false;
  if (chainId === EXPECTED_CHAIN) return true;
  try {
    await ethereum.request({ method:'wallet_switchEthereumChain', params:[{ chainId: EXPECTED_CHAIN }] });
    return true;
  } catch (err) {
    if (err?.code === 4902) {
      try {
        await ethereum.request({
          method:'wallet_addEthereumChain',
          params:[{
            chainId: EXPECTED_CHAIN,
            chainName: 'BNB Smart Chain',
            nativeCurrency: { name:'BNB', symbol:'BNB', decimals:18 },
            rpcUrls: ['https://bsc-dataseed.binance.org'],
            blockExplorerUrls: ['https://bscscan.com']
          }]
        });
        return true;
      } catch (e) {}
    }
    toast('Please switch to BNB Smart Chain', 'triangle-exclamation');
    return false;
  }
}

async function connectWallet() {
  if (!window.ethereum) {
    toast('Install MetaMask', 'exclamation-triangle');
    window.open('https://metamask.io/download','_blank');
    return;
  }
  try {
    connectBtn.innerHTML = '<span class="loader"></span> Connectingâ€¦';
    const accs = await ethereum.request({ method: 'eth_requestAccounts' });
    provider = new ethers.providers.Web3Provider(window.ethereum);
    signer = provider.getSigner();
    account = accs?.[0] || null;
    chainId = await ethereum.request({ method: 'eth_chainId' });

    await ensureExpectedChain();
    chainId = await ethereum.request({ method: 'eth_chainId' });

    paintWallet();
    await refreshNative();
    if (CONFIG.ENABLE_GATE) await checkGate();

    if (!listenersWired) {
      ethereum.on('accountsChanged', async (a) => {
        account = a?.[0] || null;
        paintWallet();
        await refreshNative();
        if (CONFIG.ENABLE_GATE) await checkGate();
      });
      ethereum.on('chainChanged', async (cid) => {
        chainId = cid;
        await ensureExpectedChain();
        chainId = await ethereum.request({ method:'eth_chainId' });
        paintWallet();
        await refreshNative();
        if (CONFIG.ENABLE_GATE) await checkGate();
      });
      listenersWired = true;
    }
    connectBtn.innerHTML = '<i class="fas fa-check"></i> Connected';
  } catch (e) {
    console.error(e);
    connectBtn.innerHTML = '<i class="fa-solid fa-wallet"></i> Connect Wallet';
    toast('Wallet connection failed', 'exclamation-triangle');
  }
}

async function refreshNative() {
  if (!provider || !account) return;
  try {
    $('#refreshBal').innerHTML = '<span class="loader"></span>';
    const wei = await provider.getBalance(account);
    const native = Number(ethers.utils.formatEther(wei));
    const sym = NATIVE_SYMBOL[chainId] || 'ETH';
    $('#nativeBal').textContent = `${native.toLocaleString(undefined,{ maximumFractionDigits:6 })} ${sym}`;
    $('#refreshBal').innerHTML = '<i class="fa-solid fa-rotate"></i>';
  } catch (e) {
    console.error(e);
    $('#refreshBal').innerHTML = '<i class="fa-solid fa-rotate"></i>';
    toast('Balance update failed', 'exclamation-triangle');
  }
}

async function getErc20Balance(addr) {
  const c = new ethers.Contract(addr, CONFIG.ERC20_ABI, provider);
  const [raw, dec, sym] = await Promise.all([
    c.balanceOf(account),
    c.decimals(),
    c.symbol().catch(()=> 'TOKEN')
  ]);
  const num = Number(ethers.utils.formatUnits(raw, dec));
  return { num, sym };
}

async function checkGate() {
  try {
    if (!provider || !account) { gateChip.style.display = 'none'; return; }
    gateChip.style.display = 'inline-flex';
    $('#gateText').innerHTML = '<span class="loader"></span> Checking accessâ€¦';

    const [{ num:kly, sym:klySym }, { num:sol, sym:solSym }] = await Promise.all([
      getErc20Balance(CONFIG.TOKENS.KLY.address),
      getErc20Balance(CONFIG.TOKENS.SOL.address)
    ]);

    const klyOk = kly >= CONFIG.TOKENS.KLY.min;
    const solOk = sol >= CONFIG.TOKENS.SOL.min;
    const pretty = (n) => n < 1000 ? n.toFixed(2) : Math.round(n).toString();

    if (klyOk && solOk) {
      $('#gateText').innerHTML = `âœ… ${pretty(kly)} ${klySym} & ${pretty(sol)} ${solSym} â€” Access Granted`;
      gateChip.classList.add('ok');
    } else {
      const need = [
        klyOk ? '' : `Need ${CONFIG.TOKENS.KLY.min}+ ${klySym}`,
        solOk ? '' : `Need ${CONFIG.TOKENS.SOL.min}+ ${solSym}`
      ].filter(Boolean).join(' â€¢ ');
      $('#gateText').innerHTML = `âŒ ${pretty(kly)} ${klySym} â€¢ ${pretty(sol)} ${solSym} â€” ${need}`;
      gateChip.classList.remove('ok');
    }

    // Certificate panel sync
    if (typeof updateCertificateEligibilityUI === 'function') {
      const courseDone = KEYS.every(k => state.completed.has(k));
      updateCertificateEligibilityUI({ kly, sol, klySym, solSym, courseDone });
    }
  } catch (e) {
    console.error(e);
    $('#gateText').innerHTML = 'Error checking tokens';
    gateChip.classList.remove('ok');
  }
}

/* ===============================
   Certificate eligibility block
   =============================== */
function updateCertificateEligibilityUI({ kly, sol, klySym='KLY', solSym='SOL', courseDone }) {
  if ($('#courseStatus')) $('#courseStatus').textContent = courseDone ? 'âœ… Completed' : 'âŒ Incomplete';
  if (typeof kly === 'number') $('#klyStatus').textContent = `${kly.toFixed(2)} ${klySym}`;
  if (typeof sol === 'number') $('#solStatus').textContent = `${sol.toFixed(2)} ${solSym}`;
  const eligible = courseDone &&
    (typeof kly === 'number' ? kly >= CONFIG.TOKENS.KLY.min : true) &&
    (typeof sol === 'number' ? sol >= CONFIG.TOKENS.SOL.min : true);
  if ($('#mintCertificateBtn')) $('#mintCertificateBtn').disabled = !eligible;
  if ($('#certMintStatus')) $('#certMintStatus').textContent = eligible ? 'Eligible' : 'Not eligible yet';
}

/* ===============================
   Init
   =============================== */
document.addEventListener('DOMContentLoaded', async () => {
  initTheme();
  restoreCheckboxes();
  wireSovereignCheckboxes();
  updateProgressUI();

  document.addEventListener('keydown', e => { if (e.key === 'Escape') hideModule(); });
  $('#themeToggle').addEventListener('click', toggleTheme);
  $('#refreshBal').addEventListener('click', refreshNative);
  $('#copyAddr').addEventListener('click', async () => {
    try { await navigator.clipboard.writeText(account || ''); toast('Address copied', 'copy'); }
    catch { toast('Copy failed', 'exclamation-triangle'); }
  });
  connectBtn.addEventListener('click', connectWallet);

  // Real section switching (no more fake toasts)
  $$('.nav-item').forEach(item => item.addEventListener('click', () => showSection(item.dataset.target)));

  // Auto-open Module 1 once for a guided start
  if (!localStorage.getItem('__opened_once__')) {
    await raf(() => showModule(1));
    localStorage.setItem('__opened_once__', '1');
  }

  // Paint wallet chips at rest
  paintWallet();
});

// Expose minimal globals used by markup
window.showModule = showModule;
window.hideModule = hideModule;
window.showSovereignModule = showSovereignModule;
</script>
</body>
</html>
