<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Join the Tribe | KLY Legacy</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Claim your legacy and join the KLY Tribe through sacred pathways of ascension.">
  <meta name="keywords" content="KLY, Legacy, NFT, Ascension, Spiritual, Tribe, Awakening">
  <meta property="og:title" content="Join the KLY Legacy Tribe">
  <meta property="og:description" content="Claim your legacy and join the KLY Tribe through sacred pathways of ascension.">
  <meta property="og:image" content="https://yourdomain.com/images/social-preview.jpg">
  <meta property="og:url" content="https://yourdomain.com">
  <meta name="twitter:card" content="summary_large_image">
  
  <!-- Preload critical resources -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="preload" as="image" href="tribal-background.jpg">
  <link rel="preload" as="script" href="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.min.js">
  
  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Cinzel+Decorative:wght@400;700;900&family=Cinzel:wght@400;700&display=swap" rel="stylesheet">
  
  <!-- Icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  
  <!-- Favicon -->
  <link rel="icon" type="image/png" href="favicon.png">
  
  <style>
    :root {
      --primary: #ffd700;
      --primary-dark: #d4af37;
      --dark: #0b0b0b;
      --darker: #050505;
      --light: #f5f5f5;
      --accent: #8a2be2;
      --transition: all 0.4s cubic-bezier(0.165, 0.84, 0.44, 1);
    }
    
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    
    html {
      scroll-behavior: smooth;
    }
    
    body {
      background: var(--dark);
      color: var(--light);
      font-family: 'Cinzel', serif;
      line-height: 1.6;
      text-align: center;
      overflow-x: hidden;
      position: relative;
    }
    
    /* Loading animation */
    .loader {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: var(--darker);
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      z-index: 9999;
      transition: opacity 0.8s ease-out;
    }
    
    .loader-spinner {
      width: 50px;
      height: 50px;
      border: 5px solid rgba(255, 215, 0, 0.3);
      border-radius: 50%;
      border-top-color: var(--primary);
      animation: spin 1s ease-in-out infinite;
      margin-bottom: 20px;
    }
    
    .loader-text {
      color: var(--primary);
      font-family: 'Cinzel Decorative', serif;
      letter-spacing: 2px;
      text-transform: uppercase;
    }
    
    .hero {
      padding: 120px 20px;
      background: linear-gradient(rgba(11, 11, 11, 0.7), rgba(11, 11, 11, 0.9)), 
                  url('tribal-background.jpg') no-repeat center center/cover;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      position: relative;
      opacity: 0;
      transform: translateY(20px);
      transition: var(--transition);
    }
    
    .hero.loaded {
      opacity: 1;
      transform: translateY(0);
    }
    
    .hero::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 0;
      width: 100%;
      height: 100px;
      background: linear-gradient(transparent, var(--dark));
      z-index: 1;
    }
    
    h1, h2, h3 {
      font-family: 'Cinzel Decorative', serif;
      font-weight: 700;
      letter-spacing: 1px;
    }
    
    .hero h1 {
      font-size: clamp(2.5rem, 5vw, 4.5rem);
      margin-bottom: 0.5em;
      text-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
      animation: pulse 3s infinite;
      position: relative;
      z-index: 2;
    }
    
    .hero p {
      font-size: clamp(1.2rem, 2vw, 1.4rem);
      margin-bottom: 1.5em;
      max-width: 800px;
      position: relative;
      z-index: 2;
    }
    
    .cta-button {
      background: var(--primary);
      color: var(--dark);
      border: none;
      padding: 18px 36px;
      font-size: 1.2rem;
      font-family: 'Cinzel', serif;
      font-weight: bold;
      cursor: pointer;
      border-radius: 50px;
      transition: var(--transition);
      box-shadow: 0 4px 15px rgba(255, 215, 0, 0.3);
      position: relative;
      overflow: hidden;
      z-index: 1;
    }
    
    .cta-button::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 0;
      height: 100%;
      background: var(--light);
      transition: width 0.4s ease;
      z-index: -1;
    }
    
    .cta-button:hover::before {
      width: 100%;
    }
    
    .cta-button:hover {
      transform: translateY(-3px);
      box-shadow: 0 6px 20px rgba(255, 215, 0, 0.5);
    }
    
    .cta-button:active {
      transform: translateY(1px);
    }
    
    .status-message {
      position: fixed;
      bottom: 24px;
      left: 50%;
      transform: translateX(-50%);
      background: #111;
      color: #FFD700;
      padding: 12px 24px;
      border-radius: 8px;
      font-family: 'Cinzel', serif;
      font-size: 14px;
      border: 1px solid gold;
      box-shadow: 0 0 20px rgba(255, 215, 0, 0.4);
      z-index: 9999;
      opacity: 0;
      transition: all 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
      display: flex;
      align-items: center;
      gap: 10px;
      max-width: 90%;
    }
    
    .status-message.visible {
      opacity: 1;
      transform: translateX(-50%) translateY(0);
    }
    
    .status-message.hidden {
      opacity: 0;
      transform: translateX(-50%) translateY(20px);
    }
    
    .status-icon {
      font-size: 1.2em;
    }
    
    .section {
      padding: 100px 20px;
      position: relative;
      opacity: 0;
      transform: translateY(30px);
      transition: var(--transition);
    }
    
    .section.visible {
      opacity: 1;
      transform: translateY(0);
    }
    
    .section:nth-child(even) {
      background: var(--darker);
    }
    
    .section-title {
      font-size: clamp(2rem, 4vw, 2.5rem);
      margin-bottom: 60px;
      position: relative;
      display: inline-block;
    }
    
    .section-title::after {
      content: '';
      position: absolute;
      bottom: -15px;
      left: 50%;
      transform: translateX(-50%);
      width: 100px;
      height: 3px;
      background: var(--primary);
    }
    
    .pathways-container {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 30px;
      max-width: 1200px;
      margin: 0 auto;
    }
    
    .pathway {
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid rgba(255, 215, 0, 0.2);
      border-radius: 10px;
      padding: 40px 30px;
      width: 100%;
      max-width: 350px;
      transition: var(--transition);
      position: relative;
      overflow: hidden;
      opacity: 0;
      transform: translateY(20px);
    }
    
    .pathway.visible {
      opacity: 1;
      transform: translateY(0);
    }
    
    .pathway::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 5px;
      background: var(--primary);
    }
    
    .pathway:hover {
      transform: translateY(-10px);
      box-shadow: 0 10px 30px rgba(255, 215, 0, 0.2);
      background: rgba(255, 255, 255, 0.08);
    }
    
    .pathway-icon {
      font-size: 2.5rem;
      margin-bottom: 20px;
      color: var(--primary);
      transition: var(--transition);
    }
    
    .pathway:hover .pathway-icon {
      transform: scale(1.1);
    }
    
    .pathway h3 {
      font-size: 1.5rem;
      margin-bottom: 15px;
    }
    
    .pathway p {
      margin-bottom: 25px;
      color: rgba(245, 245, 245, 0.8);
    }
    
    a {
      color: var(--primary);
      text-decoration: none;
      transition: color 0.3s ease;
      display: inline-flex;
      align-items: center;
      gap: 8px;
    }
    
    a:hover {
      color: var(--light);
    }
    
    .arrow-icon {
      transition: transform 0.3s ease;
    }
    
    a:hover .arrow-icon {
      transform: translateX(5px);
    }
    
    .testimonials {
      max-width: 800px;
      margin: 0 auto;
      padding: 40px;
      background: rgba(255, 215, 0, 0.05);
      border-radius: 10px;
      border-left: 3px solid var(--primary);
      position: relative;
      opacity: 0;
      transform: scale(0.95);
      transition: var(--transition);
    }
    
    .testimonials.visible {
      opacity: 1;
      transform: scale(1);
    }
    
    .testimonial-text {
      font-style: italic;
      margin-bottom: 20px;
      position: relative;
      font-size: 1.1rem;
      line-height: 1.8;
    }
    
    .testimonial-text::before,
    .testimonial-text::after {
      content: '"';
      color: var(--primary);
      font-size: 1.5rem;
      font-family: serif;
    }
    
    .testimonial-author {
      font-weight: bold;
      color: var(--primary);
      display: block;
      margin-top: 15px;
    }
    
    footer {
      padding: 60px 20px;
      background: var(--darker);
      border-top: 1px solid rgba(255, 215, 0, 0.1);
    }
    
    .social-links {
      display: flex;
      justify-content: center;
      gap: 25px;
      margin: 30px 0;
    }
    
    .social-links a {
      font-size: 1.5rem;
      color: var(--light);
      transition: var(--transition);
      width: 50px;
      height: 50px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      background: rgba(255, 255, 255, 0.05);
    }
    
    .social-links a:hover {
      color: var(--primary);
      transform: translateY(-5px) scale(1.1);
      box-shadow: 0 5px 15px rgba(255, 215, 0, 0.2);
    }
    
    .copyright {
      color: rgba(245, 245, 245, 0.6);
      font-size: 0.9rem;
      margin-top: 20px;
    }
    
    /* Animations */
    @keyframes pulse {
      0% { text-shadow: 0 0 10px rgba(255, 215, 0, 0.5); }
      50% { text-shadow: 0 0 20px rgba(255, 215, 0, 0.8); }
      100% { text-shadow: 0 0 10px rgba(255, 215, 0, 0.5); }
    }
    
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
    
    /* Scroll indicator */
    .scroll-down {
      position: absolute;
      bottom: 30px;
      left: 50%;
      transform: translateX(-50%);
      color: var(--primary);
      font-size: 2rem;
      animation: bounce 2s infinite;
      cursor: pointer;
      z-index: 2;
      transition: var(--transition);
    }
    
    .scroll-down:hover {
      color: var(--light);
      animation: none;
      transform: translateX(-50%) translateY(5px);
    }
    
    @keyframes bounce {
      0%, 20%, 50%, 80%, 100% { transform: translateY(0) translateX(-50%); }
      40% { transform: translateY(-20px) translateX(-50%); }
      60% { transform: translateY(-10px) translateX(-50%); }
    }
    
    /* Floating particles */
    .particles {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: 1;
      pointer-events: none;
    }
    
    .particle {
      position: absolute;
      background: var(--primary);
      border-radius: 50%;
      opacity: 0.3;
      animation: float linear infinite;
    }
    
    @keyframes float {
      0% { transform: translateY(0) rotate(0deg); }
      100% { transform: translateY(-100vh) rotate(360deg); }
    }
    
    /* Responsive adjustments */
    @media (max-width: 768px) {
      .hero {
        padding: 80px 20px;
      }
      
      .pathways-container {
        flex-direction: column;
        align-items: center;
      }
      
      .pathway {
        max-width: 100%;
      }
      
      .status-message {
        width: 90%;
        text-align: center;
        padding: 10px 15px;
      }
    }
    
    /* Wallet connection button */
    .wallet-btn {
      position: fixed;
      top: 20px;
      right: 20px;
      background: rgba(255, 215, 0, 0.1);
      color: var(--primary);
      border: 1px solid var(--primary);
      padding: 8px 16px;
      border-radius: 20px;
      font-family: 'Cinzel', serif;
      cursor: pointer;
      transition: var(--transition);
      z-index: 100;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .wallet-btn:hover {
      background: rgba(255, 215, 0, 0.2);
      transform: translateY(-2px);
    }
    
    .wallet-btn.connected {
      background: rgba(255, 215, 0, 0.2);
      border-color: var(--light);
    }
    
    /* Tooltip */
    .tooltip {
      position: relative;
      display: inline-block;
    }
    
    .tooltip .tooltiptext {
      visibility: hidden;
      width: 200px;
      background-color: #111;
      color: var(--light);
      text-align: center;
      border-radius: 6px;
      padding: 10px;
      position: absolute;
      z-index: 1;
      bottom: 125%;
      left: 50%;
      transform: translateX(-50%);
      opacity: 0;
      transition: opacity 0.3s;
      font-size: 0.9rem;
      border: 1px solid var(--primary);
    }
    
    .tooltip:hover .tooltiptext {
      visibility: visible;
      opacity: 1;
    }
  </style>
</head>
<body>
  <!-- Loading screen -->
  <div class="loader" id="page-loader">
    <div class="loader-spinner"></div>
    <div class="loader-text">Entering Sacred Space...</div>
  </div>

  <!-- Wallet connection button -->
  <button class="wallet-btn" id="walletButton">
    <i class="fas fa-wallet"></i>
    <span>Connect Wallet</span>
  </button>

  <!-- Hero Section -->
  <div class="hero" id="hero">
    <!-- Floating particles -->
    <div class="particles" id="particles"></div>
    
    <h1>You Were Called Here For A Reason</h1>
    <p>Claim Your Legacy. Join The Tribe. Begin Your Ascension.</p>
    <button class="cta-button" onclick="scrollToSection()">Start Your Journey</button>
    <div class="scroll-down" onclick="scrollToSection()">
      <i class="fas fa-chevron-down"></i>
    </div>
  </div>

  <!-- Pathways Section -->
  <div class="section" id="join-section">
    <h2 class="section-title">3 Sacred Pathways to Ascension</h2>
    <div class="pathways-container">
      <div class="pathway">
        <div class="pathway-icon"><i class="fas fa-key"></i></div>
        <h3>Claim Your NFT</h3>
        <p>Own your proof of ascension and unlock sacred access to the KLY Legacy. Each NFT is a key to higher consciousness.</p>
        <a href="/nft-drop.html">Go to Minting Page <span class="arrow-icon">‚Üí</span></a>
      </div>
      <div class="pathway">
        <div class="pathway-icon"><i class="fas fa-book-open"></i></div>
        <h3>Begin Your Awakening</h3>
        <p>Access our private course: <em>The Path of Awakening</em> - ancient wisdom for modern seekers.</p>
        <button class="cta-button" onclick="checkKLYAccess()">Begin Your Path <span class="arrow-icon">‚Üí</span></button>
      </div>
      <div class="pathway">
        <div class="pathway-icon"><i class="fas fa-lock-open"></i></div>
        <h3>Unlock the Vault</h3>
        <p>Stake KLY, claim sacred relics, and enter the Chamber of Secrets where true transformation begins.</p>
        <a href="/KLY-vault.html">Enter the Vault <span class="arrow-icon">‚Üí</span></a>
      </div>
    </div>
  </div>

  <!-- Testimonials -->
  <div class="section">
    <h2 class="section-title">Testimonials</h2>
    <div class="testimonials">
      <p class="testimonial-text">Joining the KLY Tribe was the turning point in my spiritual journey. The wisdom and community have transformed my life in ways I couldn't imagine.</p>
      <p class="testimonial-author">- Marcus A., Initiate since 2025</p>
    </div>
  </div>

  <!-- Final CTA -->
  <div class="section">
    <h2 class="section-title">Ready to Join the Tribe?</h2>
    <p>Step into your divine role. This isn't just a movement ‚Äî it's a Return to your true essence.</p>
    <button class="cta-button" onclick="checkNFTAccess()">Begin Your Initiation</button>
  </div>

  <!-- Footer -->
  <footer>
    <div class="social-links">
      <a href="https://discord.gg/QZ6tecpF" target="_blank" aria-label="Discord"><i class="fab fa-discord"></i></a>
      <a href="https://www.instagram.com/kly_official1?igsh=MXRnOGU4NzI4b3lleQ%3D%3D&utm_source=qr" target="_blank" aria-label="Instagram"><i class="fab fa-instagram"></i></a>
      <a href="https://twitter.com/klyofficial" target="_blank" aria-label="Twitter"><i class="fab fa-twitter"></i></a>
    </div>
    <p class="copyright">¬© 2025 KLY Legacy. All rights reserved.</p>
  </footer>

  <!-- Status message element -->
  <div id="status-message" class="status-message hidden">
    <span class="status-icon" id="status-icon">‚ÑπÔ∏è</span>
    <span id="status-text"></span>
  </div>

  <!-- Scripts -->
  <script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.min.js"></script>
  <script>
    // Constants
    const KLY_TOKEN_ADDRESS = '0x2e4fEB2Fe668c8Ebe84f19e6c8fE8Cf8131B4E52';
    const NFT_CONTRACT_ADDRESS = '0xDA76d35742190283E340dbeE2038ecc978a56950';
    const NFT_TOKEN_ID = 2;
    const KLY_MIN_REQUIRED = 100;
    const BNB_CHAIN_ID = '0x38';
    
    // DOM elements
    const walletButton = document.getElementById('walletButton');
    const statusMessage = document.getElementById('status-message');
    const statusIcon = document.getElementById('status-icon');
    const statusText = document.getElementById('status-text');
    const pageLoader = document.getElementById('page-loader');
    const heroSection = document.getElementById('hero');
    const particlesContainer = document.getElementById('particles');

    // Initialize page
    document.addEventListener('DOMContentLoaded', () => {
      // Simulate loading (remove this in production)
      setTimeout(() => {
        pageLoader.style.opacity = '0';
        setTimeout(() => {
          pageLoader.style.display = 'none';
          heroSection.classList.add('loaded');
          initScrollAnimation();
          createParticles();
        }, 800);
      }, 1500);
      
      // Check if wallet is already connected
      if (window.ethereum && window.ethereum.selectedAddress) {
        updateWalletButton(true, shortenAddress(window.ethereum.selectedAddress));
      }
      
      // Add wallet connection handler
      if (walletButton) {
        walletButton.addEventListener('click', connectWallet);
      }
    });

    // Create floating particles
    function createParticles() {
      const particleCount = window.innerWidth < 768 ? 15 : 30;
      
      for (let i = 0; i < particleCount; i++) {
        const particle = document.createElement('div');
        particle.classList.add('particle');
        
        // Random properties
        const size = Math.random() * 5 + 2;
        const posX = Math.random() * 100;
        const duration = Math.random() * 20 + 10;
        const delay = Math.random() * 10;
        
        particle.style.width = `${size}px`;
        particle.style.height = `${size}px`;
        particle.style.left = `${posX}%`;
        particle.style.animationDuration = `${duration}s`;
        particle.style.animationDelay = `-${delay}s`;
        particle.style.opacity = Math.random() * 0.5 + 0.1;
        
        particlesContainer.appendChild(particle);
      }
    }

    // Initialize scroll animations
    function initScrollAnimation() {
      const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
          if (entry.isIntersecting) {
            entry.target.classList.add('visible');
          }
        });
      }, { threshold: 0.1 });

      document.querySelectorAll('.section, .pathway, .testimonials').forEach(el => {
        observer.observe(el);
      });
    }

    // Wallet connection functions
    async function connectWallet() {
      try {
        if (typeof window.ethereum === 'undefined') {
          showStatus('ü¶ä MetaMask not found. Please install it.', 'error');
          setTimeout(() => {
            window.open('https://metamask.io/download.html', '_blank');
          }, 2000);
          return;
        }

        const accounts = await window.ethereum.request({ method: 'eth_requestAccounts' });
        updateWalletButton(true, shortenAddress(accounts[0]));
        showStatus('‚úÖ Wallet connected successfully!', 'success');
        
        // Listen for account changes
        window.ethereum.on('accountsChanged', (accounts) => {
          if (accounts.length === 0) {
            updateWalletButton(false);
            showStatus('‚ö†Ô∏è Wallet disconnected', 'warning');
          } else {
            updateWalletButton(true, shortenAddress(accounts[0]));
          }
        });
        
        // Listen for chain changes
        window.ethereum.on('chainChanged', () => {
          window.location.reload();
        });
        
      } catch (error) {
        console.error('Wallet connection error:', error);
        showStatus('‚ö†Ô∏è Could not connect wallet', 'error');
      }
    }

    function updateWalletButton(connected, address = '') {
      if (connected) {
        walletButton.innerHTML = `<i class="fas fa-check-circle"></i><span>${address}</span>`;
        walletButton.classList.add('connected');
      } else {
        walletButton.innerHTML = '<i class="fas fa-wallet"></i><span>Connect Wallet</span>';
        walletButton.classList.remove('connected');
      }
    }

    function shortenAddress(address) {
      return `${address.substring(0, 6)}...${address.substring(address.length - 4)}`;
    }

    // Status message functions
    function showStatus(msg, type = 'info') {
      // Set icon based on type
      let icon;
      switch(type) {
        case 'success':
          icon = '‚úÖ';
          break;
        case 'error':
          icon = '‚ùå';
          break;
        case 'warning':
          icon = '‚ö†Ô∏è';
          break;
        default:
          icon = '‚ÑπÔ∏è';
      }
      
      statusIcon.textContent = icon;
      statusText.textContent = msg;
      
      // Show message
      statusMessage.classList.remove('hidden');
      statusMessage.classList.add('visible');
      
      // Hide after delay
      setTimeout(() => {
        statusMessage.classList.remove('visible');
        statusMessage.classList.add('hidden');
      }, 5000);
    }

    // Verification functions
    async function connectWalletAndVerifyNetwork() {
      if (typeof window.ethereum === 'undefined') {
        showStatus('ü¶ä MetaMask not found. Redirecting...', 'error');
        setTimeout(() => {
          window.location.href = 'https://metamask.app.link/dapp/kellylegacyestates.com';
        }, 2000);
        throw new Error('Wallet not found');
      }

      // Connect wallet if not already connected
      if (!window.ethereum.selectedAddress) {
        await connectWallet();
      }

      const currentChainId = await window.ethereum.request({ method: 'eth_chainId' });
      if (currentChainId !== BNB_CHAIN_ID) {
        try {
          await window.ethereum.request({
            method: 'wallet_switchEthereumChain',
            params: [{ chainId: BNB_CHAIN_ID }],
          });
        } catch (err) {
          if (err.code === 4902) {
            try {
              await window.ethereum.request({
                method: 'wallet_addEthereumChain',
                params: [{
                  chainId: BNB_CHAIN_ID,
                  chainName: 'Binance Smart Chain',
                  nativeCurrency: {
                    name: 'BNB',
                    symbol: 'BNB',
                    decimals: 18
                  },
                  rpcUrls: ['https://bsc-dataseed.binance.org/'],
                  blockExplorerUrls: ['https://bscscan.com']
                }]
              });
            } catch (addError) {
              showStatus('‚ö†Ô∏è Please switch to BNB Smart Chain.', 'error');
              throw addError;
            }
          } else {
            showStatus('‚ö†Ô∏è Please switch to BNB Smart Chain.', 'error');
            throw err;
          }
        }
      }

      return new ethers.providers.Web3Provider(window.ethereum);
    }

    async function checkKLYAccess() {
      try {
        showStatus('üîç Checking KLY balance...', 'info');
        const provider = await connectWalletAndVerifyNetwork();
        const signer = provider.getSigner();
        const userAddress = await signer.getAddress();

        const tokenAbi = ["function balanceOf(address) view returns (uint256)"];
        const tokenContract = new ethers.Contract(KLY_TOKEN_ADDRESS, tokenAbi, provider);
        const balance = await tokenContract.balanceOf(userAddress);
        const formattedBalance = parseFloat(ethers.utils.formatUnits(balance, 18));

        if (formattedBalance >= KLY_MIN_REQUIRED) {
          showStatus("‚úÖ Access granted. Redirecting...", 'success');
          setTimeout(() => {
            window.location.href = "/kly-course.html";
          }, 1000);
        } else {
          showStatus(`‚ö†Ô∏è You need at least ${KLY_MIN_REQUIRED} KLY. You have ${formattedBalance.toFixed(2)} KLY.`, 'warning');
        }
      } catch (err) {
        console.error(err);
        showStatus("‚ö†Ô∏è Could not verify token balance.", 'error');
      }
    }

    async function checkNFTAccess() {
      try {
        showStatus('üîç Verifying NFT ownership...', 'info');
        const provider = await connectWalletAndVerifyNetwork();
        const signer = provider.getSigner();
        const userAddress = await signer.getAddress();

        const nftAbi = ["function balanceOf(address account, uint256 id) view returns (uint256)"];
        const nftContract = new ethers.Contract(NFT_CONTRACT_ADDRESS, nftAbi, signer);
        const balance = await nftContract.balanceOf(userAddress, NFT_TOKEN_ID);

        if (balance > 0) {
          showStatus("üîì NFT verified. Unlocking Portal...", 'success');
          setTimeout(() => {
            window.location.href = "/portal.html";
          }, 1000);
        } else {
          showStatus("‚õî You must hold the 'Key of Ascension' NFT.", 'warning');
        }
      } catch (err) {
        console.error(err);
        showStatus("‚ö†Ô∏è NFT verification failed.", 'error');
      }
    }

    // Utility functions
    function scrollToSection() {
      document.getElementById('join-section').scrollIntoView({ behavior: 'smooth' });
    }
  </script>
</body>
</html>
