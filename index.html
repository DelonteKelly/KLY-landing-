<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>KLY Token — Build Wealth. Own Legacy.</title>
  <meta name="description" content="KLY tokenized education + DeFi + DAO on BNB Chain. Enter the Vault. Enter the Academy. Build wealth and own legacy." />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=Unna:wght@400;700&display=swap" rel="stylesheet" />

  <!-- Design Tokens JSON (source of truth) -->
  <script type="application/json" id="design-tokens">
  {
    "brand": {
      "name": "KLY",
      "chain": "BNB Smart Chain",
      "contract": "0x2e4fEB2Fe668c8Ebe84f19e6c8fE8Cf8131B4E52"
    },
    "color": {
      "bg": "#0B0C0E",
      "bgElev": "#0F1115",
      "panel": "#121418",
      "panelHigh": "#171A1F",
      "text": "#EDEFF5",
      "textDim": "#B8BFCC",
      "muted": "#8791A1",
      "gold": "#D4AF37",
      "goldSoft": "#C9A33A",
      "goldLine": "rgba(212,175,55,0.5)",
      "teal": "#1EE8C2",
      "tealDim": "rgba(30,232,194,0.22)",
      "green": "#31D0AA",
      "red": "#FF5C70",
      "focus": "#5EEAD4"
    },
    "fx": {
      "halo": "0 0 0 2px rgba(30,232,194,0.10), 0 0 24px rgba(212,175,55,0.12)",
      "glow": "0 8px 28px rgba(0,0,0,0.45), inset 0 1px 0 rgba(255,255,255,0.04)"
    },
    "radius": {
      "xs": "6px",
      "sm": "10px",
      "md": "14px",
      "lg": "20px",
      "xl": "28px",
      "pill": "999px"
    },
    "space": {
      "2": "8px",
      "3": "12px",
      "4": "16px",
      "5": "20px",
      "6": "24px",
      "7": "28px",
      "8": "32px",
      "10": "40px",
      "12": "48px",
      "16": "64px",
      "20": "80px",
      "24": "96px",
      "28": "112px",
      "32": "128px"
    },
    "type": {
      "base": "Inter, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Helvetica Neue, Arial, sans-serif",
      "display": "Unna, Georgia, 'Times New Roman', serif",
      "size": {
        "xs": "12px",
        "sm": "14px",
        "base": "18px",
        "md": "20px",
        "lg": "24px",
        "xl": "28px",
        "2xl": "36px",
        "3xl": "44px",
        "4xl": "56px",
        "5xl": "72px"
      },
      "leading": {
        "tight": 1.1,
        "snug": 1.2,
        "normal": 1.4
      }
    },
    "shadow": {
      "sm": "0 1px 2px rgba(0,0,0,0.35)",
      "md": "0 6px 18px rgba(0,0,0,0.35)",
      "lg": "0 14px 44px rgba(0,0,0,0.45)"
    },
    "breakpoints": {
      "mobile": 390,
      "tablet": 1024,
      "desktop": 1440
    },
    "motion": {
      "fast": "150ms",
      "base": "220ms",
      "snappy": "300ms",
      "easing": "cubic-bezier(.2,.8,.2,1)"
    }
  }
  </script>

  <style>
    /* ============= CSS VARIABLES ============= */
    :root{
      --bg:#0B0C0E;--bgElev:#0F1115;--panel:#121418;--panelHigh:#171A1F;
      --text:#EDEFF5;--text-dim:#B8BFCC;--muted:#8791A1;
      --gold:#D4AF37;--gold-soft:#C9A33A;--gold-line:rgba(212,175,55,0.5);
      --teal:#1EE8C2;--teal-dim:rgba(30,232,194,0.22);
      --green:#31D0AA;--red:#FF5C70;--focus:#5EEAD4;

      --r-xs:6px;--r-sm:10px;--r-md:14px;--r-lg:20px;--r-xl:28px;--r-pill:999px;

      --s-2:8px;--s-3:12px;--s-4:16px;--s-5:20px;--s-6:24px;--s-7:28px;--s-8:32px;--s-10:40px;--s-12:48px;--s-16:64px;--s-20:80px;--s-24:96px;--s-28:112px;--s-32:128px;

      --fs-xs:12px;--fs-sm:14px;--fs-base:18px;--fs-md:20px;--fs-lg:24px;--fs-xl:28px;--fs-2xl:36px;--fs-3xl:44px;--fs-4xl:56px;--fs-5xl:72px;
      --lh-tight:1.1;--lh-snug:1.2;--lh-normal:1.4;

      --shadow-sm:0 1px 2px rgba(0,0,0,0.35);
      --shadow-md:0 6px 18px rgba(0,0,0,0.35);
      --shadow-lg:0 14px 44px rgba(0,0,0,0.45);

      --anim-fast:150ms;--anim-base:220ms;--anim-snappy:300ms;
      --anim-ease:cubic-bezier(.2,.8,.2,1);

      --halo:0 0 0 2px rgba(30,232,194,0.10),0 0 24px rgba(212,175,55,0.12);
      --glow:0 8px 28px rgba(0,0,0,0.45), inset 0 1px 0 rgba(255,255,255,0.04);
    }

    /* ============= BASE ============= */
    html,body{height:100%;}
    html{scroll-behavior:smooth;}
    body{
      margin:0;background:radial-gradient(1000px 600px at 70% -10%, rgba(30,232,194,0.04),transparent 60%), radial-gradient(800px 520px at 0% 0%, rgba(212,175,55,0.06),transparent 55%), var(--bg);
      color:var(--text); font-family:var(--type-base, Inter, system-ui); font-size:var(--fs-base); line-height:var(--lh-normal);
      overflow-x:hidden;
    }
    *,*::before,*::after{box-sizing:border-box;}
    img{max-width:100%; display:block;}
    a{color:inherit; text-decoration:none;}
    .container{max-width:1200px; margin:0 auto; padding:0 var(--s-6);}
    .visually-hidden{position:absolute!important; height:1px;width:1px; overflow:hidden; clip:rect(1px,1px,1px,1px); white-space:nowrap;}

    /* Focus styles */
    :focus-visible{outline:2px solid var(--focus); outline-offset:2px; border-radius:6px;}

    /* Sticky Topbar */
    .topbar{
      position:sticky; top:0; z-index:50; backdrop-filter: blur(8px);
      background:linear-gradient(to bottom, rgba(11,12,14,0.85), rgba(11,12,14,0.55));
      border-bottom:1px solid rgba(255,255,255,0.06);
    }
    .topbar-inner{display:flex; align-items:center; justify-content:space-between; height:64px;}
    .brand{display:flex; align-items:center; gap:12px; font-weight:700; letter-spacing:0.06em;}
    .brand .wordmark{font-family:var(--type-display, Unna); font-size:20px;}
    .chip{
      display:inline-flex; align-items:center; gap:8px; padding:10px 14px; border-radius:var(--r-pill);
      background:linear-gradient(180deg, rgba(255,255,255,0.04), rgba(0,0,0,0.2));
      border:1px solid rgba(255,255,255,0.08);
      box-shadow:var(--shadow-sm);
      min-height:44px;
    }
    .wallet-wrap{display:flex; align-items:center; gap:12px;}
    .btn{
      --bg:var(--panelHigh); --bd:rgba(255,255,255,0.08); --fg:var(--text);
      display:inline-grid; place-items:center; gap:8px; grid-auto-flow:column;
      padding:12px 18px; border-radius:var(--r-pill); border:1px solid var(--bd);
      background:linear-gradient(180deg, rgba(255,255,255,0.06), rgba(0,0,0,0.18)), var(--bg);
      color:var(--fg); box-shadow:var(--shadow-sm);
      min-height:44px; font-weight:600; transition:transform var(--anim-base) var(--anim-ease), box-shadow var(--anim-base) var(--anim-ease), border-color var(--anim-base) var(--anim-ease), background var(--anim-base) var(--anim-ease);
      cursor:pointer;
    }
    .btn:hover{transform:translateY(-2px); box-shadow:var(--shadow-md);}
    .btn:active{transform:translateY(0);}
    .btn[disabled], .btn.is-disabled{opacity:.5; cursor:not-allowed;}
    .btn-primary{
      --bg:linear-gradient(180deg, rgba(212,175,55,0.35), rgba(212,175,55,0.10)), #1A1E24;
      --bd:var(--gold-line);
      --fg:#FFF;
      box-shadow:var(--glow);
      position:relative;
    }
    .btn-primary::after{
      content:""; position:absolute; inset:-2px; border-radius:inherit; pointer-events:none;
      background:radial-gradient(600px 80px at 50% 50%, rgba(212,175,55,0.16), transparent 70%);
      opacity:0; transition:opacity var(--anim-snappy) var(--anim-ease);
    }
    .btn-primary:hover::after{opacity:1;}
    .btn-secondary{
      --bg:rgba(30,232,194,0.08); --bd:rgba(30,232,194,0.28);
    }
    .btn-ghost{
      --bg:transparent; --bd:rgba(255,255,255,0.12); color:var(--text-dim);
    }
    .btn .spinner{
      width:18px; height:18px; border-radius:50%; border:2px solid rgba(255,255,255,0.25); border-top-color:#fff; animation:spin 800ms linear infinite;
    }
    @keyframes spin{to{transform:rotate(360deg);}}

    /* Hero */
    .hero{position:relative; isolation:isolate; padding:var(--s-24) 0 var(--s-20);}
    .hero .frame{
      display:grid; grid-template-columns:1.2fr 0.8fr; gap:var(--s-16); align-items:center;
    }
    .h1{
      font-family:var(--type-display, Unna); font-size:clamp(var(--fs-3xl), 6vw, var(--fs-5xl)); line-height:var(--lh-tight);
      letter-spacing:0.01em; margin:0 0 var(--s-6); font-weight:700;
      background:linear-gradient(180deg, #FFF, #E0E0E0 40%, #C1A23A 100%);
      -webkit-background-clip:text; background-clip:text; color:transparent;
    }
    .sub{
      font-size:var(--fs-lg); color:var(--text-dim); max-width:52ch; margin:0 0 var(--s-8);
    }
    .cta-row{display:flex; flex-wrap:wrap; gap:12px;}
    .fine-print{
      margin-top:var(--s-6); color:var(--muted); font-size:var(--fs-sm);
      display:flex; align-items:center; gap:10px;
    }
    .fine-pill{border:1px solid var(--gold-line); border-radius:var(--r-pill); padding:6px 10px; background:rgba(212,175,55,0.06);}
    .contract-bar{
      margin-top:var(--s-8); display:flex; align-items:center; gap:12px; flex-wrap:wrap;
      border:1px solid rgba(255,255,255,0.08); background:linear-gradient(180deg, rgba(255,255,255,0.04), rgba(0,0,0,0.2)); border-radius:var(--r-md);
      padding:10px 12px; box-shadow:var(--shadow-sm);
    }
    .addr{
      font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;
      background:rgba(255,255,255,0.04); border:1px dashed rgba(255,255,255,0.12); padding:8px 10px; border-radius:var(--r-sm);
      color:#fff;
    }
    .addr small{color:var(--text-dim);}
    .contract-actions{display:flex; gap:8px; align-items:center;}

    /* Right visual (glyph coin + portal) */
    .hero-art{
      position:relative; min-height:360px; display:grid; place-items:center;
    }
    .portal{
      width:min(440px, 90%); aspect-ratio:1; border-radius:50%;
      background:radial-gradient(closest-side, rgba(30,232,194,0.12), transparent 70%), radial-gradient(circle at 50% 50%, rgba(212,175,55,0.15), transparent 60%);
      border:1px solid rgba(255,255,255,0.08); box-shadow:0 0 0 2px rgba(30,232,194,0.08), inset 0 0 80px rgba(212,175,55,0.12), var(--shadow-md);
      display:grid; place-items:center; position:relative; overflow:hidden;
    }
    .portal .ring{position:absolute; inset:8%; border-radius:50%; border:1px solid rgba(212,175,55,0.25); mix-blend:screen; animation:spin-slow 30s linear infinite;}
    @keyframes spin-slow{to{transform:rotate(360deg);}}
    @media (prefers-reduced-motion: reduce){
      .btn:hover{transform:none;}
      .portal .ring{animation:none;}
    }
    .glyph-coin{width:58%; filter:drop-shadow(0 6px 24px rgba(0,0,0,0.5));}

    /* Particles optional holder */
    #particles-js{position:absolute; inset:0; opacity:0.35; pointer-events:none;}

    /* Badges */
    .badges{display:grid; grid-template-columns:repeat(4,1fr); gap:var(--s-6); margin:var(--s-16) 0 var(--s-12);}
    .badge{
      display:flex; align-items:center; gap:10px; padding:12px 14px; border-radius:var(--r-md);
      background:linear-gradient(180deg, rgba(255,255,255,0.03), rgba(0,0,0,0.2));
      border:1px solid rgba(255,255,255,0.08); box-shadow:var(--shadow-sm);
      position:relative; overflow:hidden;
    }
    .badge::after{
      content:""; position:absolute; inset:0; background:linear-gradient(90deg, transparent, rgba(255,255,255,0.06), transparent);
      transform:translateX(-120%); animation:badge-shimmer 1.8s var(--anim-ease) 1 both;
    }
    @keyframes badge-shimmer{to{transform:translateX(120%);}}
    .badge svg{flex:0 0 24px;}

    /* Feature Grid */
    .grid4{display:grid; grid-template-columns:repeat(4,1fr); gap:var(--s-8);}
    .card{
      background:var(--panel); border:1px solid rgba(255,255,255,0.08); border-radius:var(--r-lg);
      padding:var(--s-10); box-shadow:var(--shadow-sm); transition:transform var(--anim-base) var(--anim-ease), box-shadow var(--anim-base) var(--anim-ease);
    }
    .card:hover{transform:translateY(-3px); box-shadow:var(--shadow-md);}
    .card h3{margin:0 0 var(--s-4); font-size:var(--fs-xl); line-height:var(--lh-snug);}
    .card p{margin:0 0 var(--s-5); color:var(--text-dim);}
    .card .link{color:var(--teal); font-weight:600; text-decoration:underline dotted rgba(30,232,194,0.3); text-underline-offset:3px;}

    /* Conversion band */
    .band{margin:var(--s-20) 0; padding:var(--s-16); border-radius:var(--r-xl); background:linear-gradient(180deg, rgba(255,255,255,0.03), rgba(0,0,0,0.25)); border:1px solid rgba(255,255,255,0.08); box-shadow:var(--shadow-md);}
    .vault-grid{display:grid; grid-template-columns:1fr 1fr; gap:var(--s-10); align-items:start;}
    .steps{display:grid; gap:12px;}
    .step{display:grid; grid-template-columns:28px 1fr; gap:12px; align-items:start;}
    .step .dot{width:28px;height:28px;border-radius:50%; display:grid;place-items:center; background:rgba(30,232,194,0.08); border:1px solid rgba(30,232,194,0.35); color:#fff; font-weight:700;}
    .status-card{background:var(--panelHigh); border:1px solid rgba(255,255,255,0.10); border-radius:var(--r-lg); padding:var(--s-8); box-shadow:var(--shadow-sm);}
    .status-card .row{display:flex; align-items:center; justify-content:space-between; padding:10px 0; border-bottom:1px dashed rgba(255,255,255,0.07);}
    .status-card .row:last-child{border-bottom:0;}
    .status-card code{font-family:ui-monospace, Menlo, monospace; font-size:14px; color:var(--text-dim);}
    .band .cta{margin-top:var(--s-6);}

    /* Academy Band */
    .academy{display:grid; grid-template-columns:1.2fr 0.8fr; gap:var(--s-12); align-items:center;}
    .academy h2{font-family:var(--type-display, Unna); font-size:var(--fs-3xl); line-height:var(--lh-tight); margin:0 0 var(--s-4);}
    .note{color:var(--muted);}

    /* Quest/Achievements */
    .section-title{display:flex; align-items:center; gap:12px; margin:var(--s-20) 0 var(--s-8);}
    .divider-glyph{width:32px;height:32px; opacity:.9;}
    .quests{display:grid; grid-template-columns:repeat(3,1fr); gap:var(--s-8);}
    .quest{padding:var(--s-8); border:1px solid rgba(255,255,255,0.08); border-radius:var(--r-lg); background:var(--panel); box-shadow:var(--shadow-sm);}
    .quest .top{display:flex; align-items:center; justify-content:space-between; margin-bottom:10px;}
    .state{font-size:12px; padding:6px 8px; border-radius:var(--r-pill);}
    .state.done{background:rgba(49,208,170,0.12); color:var(--green); border:1px solid rgba(49,208,170,0.45);}
    .state.lock{background:rgba(255,92,112,0.08); color:var(--red); border:1px solid rgba(255,92,112,0.35);}

    /* Why + Tokenomics */
    .split{display:grid; grid-template-columns:1.2fr 0.8fr; gap:var(--s-12); align-items:start;}
    .tokenomics{background:var(--panelHigh); border:1px solid rgba(255,255,255,0.1); border-radius:var(--r-lg); padding:var(--s-10);}
    .progress{height:10px; background:rgba(255,255,255,0.06); border-radius:var(--r-pill); overflow:hidden;}
    .progress > span{display:block; height:100%; background:linear-gradient(90deg, var(--gold), var(--teal));}

    /* Roadmap */
    .roadmap{position:relative; padding:var(--s-20) 0;}
    .spine{position:absolute; left:50%; top:0; bottom:0; width:2px; background:linear-gradient(180deg, rgba(212,175,55,0.35), rgba(30,232,194,0.35)); transform:translateX(-50%);}
    .rm-grid{display:grid; grid-template-columns:1fr 1fr; gap:var(--s-12); position:relative;}
    .rm-item{background:var(--panel); border:1px solid rgba(255,255,255,0.08); border-radius:var(--r-lg); padding:var(--s-8); box-shadow:var(--shadow-sm); position:relative;}
    .rm-item.current{border-color:rgba(30,232,194,0.45); box-shadow:0 0 0 2px rgba(30,232,194,0.18);}
    .rm-item::before{
      content:""; position:absolute; top:50%; width:12px; height:12px; border-radius:50%; background:var(--gold); box-shadow:0 0 24px var(--gold); 
    }
    .rm-left::before{right:-6px;}
    .rm-right::before{left:-6px;}
    .rm-time{color:var(--text-dim); font-size:14px; margin-bottom:6px;}

    /* Ancestral Call (Portal CTA) */
    .call{display:grid; place-items:center; text-align:center; padding:var(--s-24) 0;}
    .call .portal{width:min(360px, 80%);}
    .call h3{font-family:var(--type-display, Unna); font-size:var(--fs-2xl); margin:var(--s-6) 0 var(--s-4);}
    .call p{color:var(--text-dim); max-width:60ch; margin:0 auto var(--s-6);}

    /* FAQ */
    .faq{margin:var(--s-20) 0;}
    .accordion{border:1px solid rgba(255,255,255,0.08); border-radius:var(--r-lg); overflow:hidden;}
    .acc-item + .acc-item{border-top:1px solid rgba(255,255,255,0.08);}
    .acc-btn{
      width:100%; text-align:left; background:var(--panel); color:var(--text);
      padding:16px 18px; border:0; display:flex; align-items:center; justify-content:space-between; cursor:pointer; font-weight:600;
    }
    .acc-btn .pm{width:22px;height:22px; display:grid; place-items:center; border-radius:6px; border:1px solid rgba(255,255,255,0.12);}
    .acc-panel{max-height:0; overflow:hidden; background:var(--panelHigh); transition:max-height var(--anim-snappy) var(--anim-ease);}
    .acc-panel .content{padding:0 18px 16px; color:var(--text-dim);}
    .acc-item.open .acc-panel{max-height:280px;}

    /* Footer */
    footer{margin-top:var(--s-24); border-top:1px solid rgba(255,255,255,0.08); background:linear-gradient(180deg, rgba(0,0,0,0.2), rgba(0,0,0,0.4));}
    .foot{display:grid; grid-template-columns:1fr auto 1fr; align-items:center; gap:var(--s-8); padding:var(--s-12) 0;}
    .links{display:flex; gap:18px; flex-wrap:wrap;}
    .links a{position:relative;}
    .links a::after{
      content:""; position:absolute; left:0; right:0; bottom:-3px; height:2px; background:radial-gradient(40px 6px at 50% 50%, var(--teal), transparent 70%); opacity:0; transition:opacity var(--anim-base) var(--anim-ease);
    }
    .links a:hover::after{opacity:1;}
    .foot .sigil{justify-self:center; opacity:.9;}

    /* Toasts */
    .toasts{position:fixed; top:16px; right:16px; display:grid; gap:10px; z-index:100;}
    .toast{
      min-width:260px; padding:12px 14px; border-radius:12px; border-left:3px solid var(--gold);
      background:linear-gradient(180deg, rgba(255,255,255,0.05), rgba(0,0,0,0.35)); box-shadow:var(--shadow-md);
      display:grid; grid-template-columns:auto 1fr auto; gap:10px; align-items:center;
    }
    .toast.success{border-left-color:var(--green);}
    .toast.error{border-left-color:var(--red);}
    .toast .close{background:none; border:0; color:var(--text-dim); cursor:pointer;}

    /* Responsiveness */
    @media (max-width: 1024px){
      .hero .frame{grid-template-columns:1fr; gap:var(--s-12);}
      .academy{grid-template-columns:1fr; text-align:left;}
      .vault-grid{grid-template-columns:1fr;}
      .grid4{grid-template-columns:repeat(2,1fr);}
      .quests{grid-template-columns:repeat(2,1fr);}
      .split{grid-template-columns:1fr;}
      .foot{grid-template-columns:1fr; gap:var(--s-6);}
    }
    @media (max-width: 520px){
      body{font-size:17px;}
      .badges{grid-template-columns:1fr 1fr;}
      .grid4{grid-template-columns:1fr;}
      .quests{grid-template-columns:1fr;}
      .contract-actions{width:100%; justify-content:flex-start;}
      .cta-row{gap:10px;}
    }
  </style>
</head>
<body>
  <!-- Sticky Topbar -->
  <header class="topbar" role="banner">
    <div class="container topbar-inner">
      <a href="#" class="brand" aria-label="KLY home">
        <!-- Glyph coin (inline SVG) -->
        <svg class="glyph-24" width="28" height="28" viewBox="0 0 64 64" aria-hidden="true">
          <defs>
            <radialGradient id="g0" cx="50%" cy="50%" r="60%">
              <stop offset="0%" stop-color="#D4AF37"/><stop offset="60%" stop-color="#8A6B1E"/><stop offset="100%" stop-color="#2B2207"/>
            </radialGradient>
          </defs>
          <circle cx="32" cy="32" r="30" fill="url(#g0)" stroke="rgba(255,255,255,0.25)" stroke-width="1"/>
          <path d="M32 14 L42 24 L32 34 L22 24 Z M22 40 L32 50 L42 40" fill="none" stroke="#1EE8C2" stroke-opacity="0.9" stroke-width="2"/>
        </svg>
        <span class="wordmark">KLY TOKEN</span>
      </a>

      <div class="wallet-wrap">
        <div id="walletChip" class="chip" aria-live="polite">
          <span id="walletLabel">Not connected</span>
        </div>
        <button id="connectBtn" class="btn btn-primary" aria-haspopup="dialog">
          <span>Connect Wallet</span>
        </button>
      </div>
    </div>
  </header>

  <!-- HERO -->
  <section class="hero" aria-labelledby="hero-title">
    <div id="particles-js" aria-hidden="true"></div>
    <div class="container frame">
      <div>
        <h1 id="hero-title" class="h1">Build Wealth. Own Legacy.</h1>
        <p class="sub">KLY unites tokenized education, DeFi yield, and DAO governance on BNB Smart Chain. Staking vaults. Gated academy. On-chain credentials.</p>

        <div class="cta-row" role="group" aria-label="Primary actions">
          <a href="#vault" class="btn btn-primary" id="enterVaultTop">
            <span>Enter the Vault</span>
          </a>
          <a href="#academy" class="btn btn-secondary" id="enterAcademyTop">
            <span>Enter Academy</span>
          </a>
        </div>

        <div class="fine-print" aria-label="requirements">
          <span class="fine-pill">Academy requires <strong>500+ KLY</strong></span>
          <span class="fine-pill">BNB Smart Chain</span>
        </div>

        <!-- Contract micro-bar (above the fold and persistent) -->
        <div class="contract-bar" role="group" aria-label="Contract">
          <div class="addr" title="KLY Contract Address">
            <small>Contract</small> • <span id="contractShort">0x2e4f...4E52</span>
          </div>
          <div class="contract-actions">
            <a class="btn btn-ghost" rel="noopener" target="_blank" href="https://bscscan.com/token/0x2e4fEB2Fe668c8Ebe84f19e6c8fE8Cf8131B4E52" aria-label="View KLY contract on BscScan">View on BscScan</a>
            <button id="copyContract" class="btn btn-ghost" aria-label="Copy contract address" data-copy="0x2e4fEB2Fe668c8Ebe84f19e6c8fE8Cf8131B4E52">Copy Contract</button>
          </div>
        </div>
      </div>

      <div class="hero-art" aria-hidden="true">
        <div class="portal">
          <div class="ring"></div><div class="ring" style="inset:14%; animation-duration:40s; opacity:.6;"></div><div class="ring" style="inset:20%; animation-duration:50s; opacity:.4;"></div>
          <!-- Central coin -->
          <svg class="glyph-coin" viewBox="0 0 200 200">
            <defs>
              <radialGradient id="coinG" cx="50%" cy="50%" r="60%">
                <stop offset="0%" stop-color="#FFF"/><stop offset="55%" stop-color="#E2C86C"/><stop offset="100%" stop-color="#6B5520"/>
              </radialGradient>
            </defs>
            <circle cx="100" cy="100" r="86" fill="url(#coinG)" stroke="rgba(0,0,0,0.35)" stroke-width="2"/>
            <circle cx="100" cy="100" r="72" fill="none" stroke="rgba(30,232,194,0.45)" stroke-width="2" stroke-dasharray="6 10"/>
            <path d="M100 50 L135 85 L100 120 L65 85 Z M65 140 L100 175 L135 140" fill="none" stroke="#0D1117" stroke-width="6" opacity=".8"/>
            <path d="M100 50 L135 85 L100 120 L65 85 Z M65 140 L100 175 L135 140" fill="none" stroke="#1EE8C2" stroke-width="2"/>
          </svg>
        </div>
      </div>
    </div>

    <!-- Badges -->
    <div class="container badges" aria-label="Highlights">
      <div class="badge">
        <svg viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M4 12h16M4 17h10M4 7h16" stroke="currentColor" opacity=".9"/></svg>
        <span>Low fees on BNB</span>
      </div>
      <div class="badge">
        <svg viewBox="0 0 24 24" fill="none"><path d="M12 3l8 4v6c0 4-3 7-8 8-5-1-8-4-8-8V7l8-4z" stroke="currentColor"/></svg>
        <span>Self-custody</span>
      </div>
      <div class="badge">
        <svg viewBox="0 0 24 24" fill="none"><path d="M6 6h12v7H6z"/><path d="M8 19h8" stroke="currentColor"/></svg>
        <span>Token-gated Academy</span>
      </div>
      <div class="badge">
        <svg viewBox="0 0 24 24" fill="none"><path d="M12 2l4 7-6 6 7-4 5 11" stroke="currentColor"/></svg>
        <span>NFT Certificates</span>
      </div>
    </div>
  </section>

  <!-- Feature Grid -->
  <section class="container" aria-labelledby="features">
    <div class="section-title">
      <!-- Sacred divider glyph -->
      <svg class="divider-glyph" viewBox="0 0 24 24" aria-hidden="true"><circle cx="12" cy="12" r="10" stroke="var(--gold)" fill="none"/><path d="M12 4v16M4 12h16" stroke="var(--teal)"/></svg>
      <h2 id="features">What You Unlock</h2>
    </div>
    <div class="grid4">
      <article class="card">
        <h3>Tokenized Education</h3>
        <p>Master DeFi and on-chain ops with structured, token-gated paths.</p>
        <a class="link" href="#academy">Explore Academy</a>
      </article>
      <article class="card">
        <h3>DeFi Ecosystem</h3>
        <p>Stake, mint, and claim inside the Vault. Designed for clarity and control.</p>
        <a class="link" href="#vault">Enter Vault</a>
      </article>
      <article class="card">
        <h3>DAO Governance</h3>
        <p>Put KLY to work. Vote on upgrades, grants, and launch priorities.</p>
        <a class="link" href="#dao">View DAO</a>
      </article>
      <article class="card">
        <h3>Launchpad</h3>
        <p>Participate in vetted drops and cohort projects with on-chain checks.</p>
        <a class="link" href="#launchpad">See Launchpad</a>
      </article>
    </div>
  </section>

  <!-- Vault Preview -->
  <section id="vault" class="container band" aria-labelledby="vault-title">
    <h2 id="vault-title" class="section-title" style="gap:10px;">
      <svg class="divider-glyph" viewBox="0 0 24 24" aria-hidden="true"><circle cx="12" cy="12" r="10" stroke="var(--gold)" fill="none"/><path d="M12 4v16M4 12h16" stroke="var(--teal)"/></svg>
      <span>Vault — Stake. Mint. Claim.</span>
    </h2>
    <div class="vault-grid">
      <div class="steps" role="list">
        <div class="step" role="listitem">
          <div class="dot">1</div>
          <div>
            <strong>Connect</strong>
            <p class="note">Link your wallet on BNB Smart Chain.</p>
          </div>
        </div>
        <div class="step" role="listitem">
          <div class="dot">2</div>
          <div>
            <strong>Verify balance</strong>
            <p class="note">We check your KLY holdings securely.</p>
          </div>
        </div>
        <div class="step" role="listitem">
          <div class="dot">3</div>
          <div>
            <strong>Unlock</strong>
            <p class="note">Academy opens at <b>500+ KLY</b>. Vault is always available.</p>
          </div>
        </div>
        <div class="step" role="listitem">
          <div class="dot">4</div>
          <div>
            <strong>Mint / Stake / Claim</strong>
            <p class="note">One clean flow. Low fees. Clear states.</p>
          </div>
        </div>

        <div class="cta">
          <a href="#vault-app" class="btn btn-primary"><span>Enter the Vault</span></a>
        </div>
      </div>

      <aside class="status-card" aria-live="polite">
        <div class="row"><span>Network</span><strong>BNB Smart Chain</strong></div>
        <div class="row"><span>Wallet</span><code id="statusWallet">Not connected</code></div>
        <div class="row"><span>Eligibility</span><code id="statusEligibility">Academy: 500+ KLY</code></div>
        <div class="row"><span>Message</span><code id="statusMsg">Connect wallet to continue.</code></div>
      </aside>
    </div>
  </section>

  <!-- Academy -->
  <section id="academy" class="container band" aria-labelledby="academy-title">
    <div class="academy">
      <div>
        <h2 id="academy-title">The Academy</h2>
        <p class="note">Enter a focused learning vault. Complete tracks, earn <b>NFT certificates</b>, and level up your DeFi execution. Access requires <b>500+ KLY</b>.</p>
        <div class="cta-row">
          <a href="#academy-app" class="btn btn-secondary"><span>Enter Academy</span></a>
        </div>
      </div>
      <div class="portal" aria-hidden="true">
        <div class="ring"></div><div class="ring" style="inset:16%; animation-duration:36s;"></div>
        <svg class="glyph-coin" viewBox="0 0 200 200"><circle cx="100" cy="100" r="76" fill="rgba(30,232,194,0.08)" stroke="rgba(30,232,194,0.35)"/><path d="M100 56 L128 84 L100 112 L72 84 Z" stroke="#1EE8C2" fill="none"/></svg>
      </div>
    </div>
  </section>

  <!-- Quests / Achievements -->
  <section class="container" aria-labelledby="quest-title">
    <div class="section-title">
      <svg class="divider-glyph" viewBox="0 0 24 24" aria-hidden="true"><circle cx="12" cy="12" r="10" stroke="var(--gold)" fill="none"/><path d="M12 4v16M4 12h16" stroke="var(--teal)"/></svg>
      <h2 id="quest-title">Quests & Leaderboard</h2>
    </div>
    <div class="quests">
      <div class="quest">
        <div class="top"><strong>Connect on BNB</strong><span class="state done">Completed</span></div>
        <p class="note">You connected your wallet on BNB Smart Chain.</p>
      </div>
      <div class="quest">
        <div class="top"><strong>Stake KLY</strong><span class="state lock">Locked</span></div>
        <p class="note">Stake any amount to unlock the streak bonus.</p>
      </div>
      <div class="quest">
        <div class="top"><strong>Reach 500+ KLY</strong><span class="state lock">Locked</span></div>
        <p class="note">Required to enter the Academy.</p>
      </div>
    </div>
  </section>

  <!-- Why + Tokenomics -->
  <section class="container" aria-labelledby="why-title">
    <div class="section-title">
      <svg class="divider-glyph" viewBox="0 0 24 24" aria-hidden="true"><circle cx="12" cy="12" r="10" stroke="var(--gold)" fill="none"/><path d="M12 4v16M4 12h16" stroke="var(--teal)"/></svg>
      <h2 id="why-title">Why KLY</h2>
    </div>
    <div class="split">
      <div>
        <p>KLY is a focused path to on-chain mastery. We pair <b>clean DeFi flows</b> with <b>tokenized curriculum</b> and <b>DAO ownership</b>. You learn. You earn. You decide.</p>
        <p>Every component honors clarity: crisp states, no hidden steps, and fees you can see.</p>
        <a class="btn btn-primary" href="#vault"><span>Start in the Vault</span></a>
      </div>
      <aside class="tokenomics" aria-label="Tokenomics">
        <h3 style="margin-top:0;">Tokenomics</h3>
        <p class="note">Transparent, programmatic distribution.</p>
        <div style="display:grid; gap:12px;">
          <div>
            <div style="display:flex; justify-content:space-between;"><span>Community</span><span>40%</span></div>
            <div class="progress"><span style="width:40%;"></span></div>
          </div>
          <div>
            <div style="display:flex; justify-content:space-between;"><span>Treasury & DAO</span><span>25%</span></div>
            <div class="progress"><span style="width:25%;"></span></div>
          </div>
          <div>
            <div style="display:flex; justify-content:space-between;"><span>Team & Advisors</span><span>20%</span></div>
            <div class="progress"><span style="width:20%;"></span></div>
          </div>
          <div>
            <div style="display:flex; justify-content:space-between;"><span>Launchpad / Partners</span><span>15%</span></div>
            <div class="progress"><span style="width:15%;"></span></div>
          </div>
        </div>
      </aside>
    </div>
  </section>

  <!-- Roadmap -->
  <section class="container roadmap" aria-labelledby="roadmap-title">
    <span class="spine" aria-hidden="true"></span>
    <div class="section-title">
      <svg class="divider-glyph" viewBox="0 0 24 24" aria-hidden="true"><circle cx="12" cy="12" r="10" stroke="var(--gold)" fill="none"/><path d="M12 4v16M4 12h16" stroke="var(--teal)"/></svg>
      <h2 id="roadmap-title">Roadmap</h2>
    </div>
    <div class="rm-grid">
      <div class="rm-item rm-left current">
        <div class="rm-time">Now</div>
        <strong>Vault v1</strong>
        <p class="note">Stake, mint, claim with audit-ready flows.</p>
      </div>
      <div class="rm-item rm-right">
        <div class="rm-time">Q4</div>
        <strong>Academy v1</strong>
        <p class="note">Curriculum tracks + NFT certificates.</p>
      </div>
      <div class="rm-item rm-left">
        <div class="rm-time">Q1</div>
        <strong>DAO Onboarding</strong>
        <p class="note">Snapshot + proposals + weighted voting.</p>
      </div>
      <div class="rm-item rm-right">
        <div class="rm-time">Q2</div>
        <strong>Launchpad</strong>
        <p class="note">Cohort projects & grants.</p>
      </div>
    </div>
  </section>

  <!-- Ancestral Call -->
  <section class="container call" aria-labelledby="call-title">
    <div class="portal" aria-hidden="true"><div class="ring"></div></div>
    <h3 id="call-title">Answer the Call</h3>
    <p>Step through the gate. Build wealth. Own legacy.</p>
    <a href="#vault" class="btn btn-primary" style="margin-top:10px;"><span>Enter the Vault</span></a>
  </section>

  <!-- FAQ -->
  <section class="container faq" aria-labelledby="faq-title">
    <div class="section-title">
      <svg class="divider-glyph" viewBox="0 0 24 24" aria-hidden="true"><circle cx="12" cy="12" r="10" stroke="var(--gold)" fill="none"/><path d="M12 4v16M4 12h16" stroke="var(--teal)"/></svg>
      <h2 id="faq-title">FAQ</h2>
    </div>
    <div class="accordion" role="region" aria-labelledby="faq-title">
      <div class="acc-item">
        <button class="acc-btn" aria-expanded="false">
          <span>What chain does KLY use?</span>
          <span class="pm" aria-hidden="true">+</span>
        </button>
        <div class="acc-panel"><div class="content">BNB Smart Chain. Low fees, fast finality.</div></div>
      </div>
      <div class="acc-item">
        <button class="acc-btn" aria-expanded="false">
          <span>How do I access the Academy?</span>
          <span class="pm" aria-hidden="true">+</span>
        </button>
        <div class="acc-panel"><div class="content">Hold <b>500+ KLY</b> in your connected wallet, then select “Enter Academy”.</div></div>
      </div>
      <div class="acc-item">
        <button class="acc-btn" aria-expanded="false">
          <span>Where can I verify the contract?</span>
          <span class="pm" aria-hidden="true">+</span>
        </button>
        <div class="acc-panel"><div class="content">Use the “View on BscScan” button above the fold or in the footer.</div></div>
      </div>
    </div>
  </section>

  <!-- Footer -->
  <footer role="contentinfo">
    <div class="container foot">
      <nav class="links" aria-label="Footer">
        <a href="#vault">Vault</a>
        <a href="#academy">Academy</a>
        <a href="https://bscscan.com/token/0x2e4fEB2Fe668c8Ebe84f19e6c8fE8Cf8131B4E52" target="_blank" rel="noopener">BscScan</a>
        <a href="#dao">DAO</a>
        <a href="#launchpad">Launchpad</a>
      </nav>
      <!-- cosmic glyph divider -->
      <svg class="sigil" width="40" height="40" viewBox="0 0 40 40" aria-hidden="true">
        <circle cx="20" cy="20" r="18" fill="none" stroke="var(--gold)" />
        <path d="M20 4 L32 20 L20 36 L8 20 Z" fill="none" stroke="var(--teal)"/>
      </svg>
      <div class="links" style="justify-self:end;">
        <a href="#" aria-label="X / Twitter">X</a>
        <a href="#" aria-label="Discord">Discord</a>
        <a href="#" aria-label="Docs">Docs</a>
      </div>
    </div>
  </footer>

  <!-- Toasts -->
  <div class="toasts" id="toasts" aria-live="polite" aria-atomic="true"></div>

<!-- Ethers v6 -->
<script src="https://cdn.jsdelivr.net/npm/ethers@6.12.1/dist/ethers.min.js" crossorigin="anonymous"></script>

<script>
(function(){
  // =========================
  // CONFIG / CONSTANTS
  // =========================
  const CONTRACT = "0x2e4fEB2Fe668c8Ebe84f19e6c8fE8Cf8131B4E52";
  const BSC = {
    chainId: "0x38", // 56
    chainName: "BNB Smart Chain",
    nativeCurrency: { name: "BNB", symbol: "BNB", decimals: 18 },
    rpcUrls: ["https://bsc-dataseed.binance.org/"],
    blockExplorerUrls: ["https://bscscan.com"]
  };
  const ERC20_ABI = [
    "function balanceOf(address) view returns (uint256)",
    "function decimals() view returns (uint8)",
    "function symbol() view returns (string)"
  ];
  const ACADEMY_THRESHOLD = 500;

  // =========================
  // DOM HOOKS (from your page)
  // =========================
  const connectBtn       = document.getElementById('connectBtn');
  const walletChip       = document.getElementById('walletChip');
  const walletLabel      = document.getElementById('walletLabel');
  const copyContractBtn  = document.getElementById('copyContract');
  const contractShortEl  = document.getElementById('contractShort');
  const toasts           = document.getElementById('toasts');

  // Status card (optional but present in provided layout)
  const statusMsg        = document.getElementById('statusMsg');
  const statusWallet     = document.getElementById('statusWallet');
  const statusEligibility= document.getElementById('statusEligibility');

  // Academy CTAs in hero + academy band
  const academyButtons = [
    document.getElementById('enterAcademyTop'),
    ...document.querySelectorAll('a[href="#academy-app"]')
  ].filter(Boolean);

  // =========================
  // TOASTS
  // =========================
  function toast(msg, type = "neutral", timeout = 3000){
    const el = document.createElement('div');
    el.className = `toast ${type==='success'?'success':type==='error'?'error':''}`;
    el.innerHTML = `<span>${type==='success'?'✅':type==='error'?'⚠️':'✨'}</span>
                    <div>${msg}</div>
                    <button class="close" aria-label="Close">&times;</button>`;
    toasts.appendChild(el);
    const remove = ()=> el.remove();
    el.querySelector('.close').addEventListener('click', remove);
    setTimeout(remove, timeout);
  }

  // =========================
  // STATE
  // =========================
  let provider;      // ethers BrowserProvider
  let signer;        // ethers Signer
  let userAddress;   // checksummed
  let klyDecimals;   // cache
  let klySymbol = "KLY";
  let currentBalance = 0; // human number

  // =========================
  // ACCESSIBLE ACADEMY GATE
  // =========================
  function lockAcademy(){
    academyButtons.forEach(btn=>{
      btn.classList.add('is-disabled');
      btn.setAttribute('aria-disabled','true');
      btn.setAttribute('data-locked','true');
      btn.title = `Requires ${ACADEMY_THRESHOLD}+ KLY`;
      // Intercept click & keyboard
      btn.addEventListener('click', onLockedClick);
      btn.addEventListener('keydown', onLockedKey);
    });
    if(statusEligibility) statusEligibility.textContent = `Academy: ${ACADEMY_THRESHOLD}+ KLY required`;
  }

  function unlockAcademy(){
    academyButtons.forEach(btn=>{
      btn.classList.remove('is-disabled');
      btn.removeAttribute('aria-disabled');
      btn.removeAttribute('data-locked');
      btn.title = '';
      btn.removeEventListener('click', onLockedClick);
      btn.removeEventListener('keydown', onLockedKey);
    });
    if(statusEligibility) statusEligibility.textContent = "Academy: Unlocked";
  }

  function onLockedClick(e){
    // Prevent navigation when locked
    if(e.currentTarget.getAttribute('data-locked') === 'true'){
      e.preventDefault();
      toast(`Insufficient KLY — you need ${ACADEMY_THRESHOLD}+ to unlock this module.`, 'error');
    }
  }
  function onLockedKey(e){
    if((e.key === ' ' || e.key === 'Enter') && e.currentTarget.getAttribute('data-locked') === 'true'){
      e.preventDefault();
      toast(`Insufficient KLY — you need ${ACADEMY_THRESHOLD}+ to unlock this module.`, 'error');
    }
  }

  // Start locked by default
  lockAcademy();

  // =========================
  // EXPORTS EXPECTED BY PAGE
  // =========================
  window.setWallet = function(address){
    if(!walletLabel || !walletChip) return;
    if(!address){
      walletLabel.textContent = "Not connected";
      if(statusWallet) statusWallet.textContent = "Not connected";
      if(statusMsg) statusMsg.textContent = "Connect wallet to continue.";
      return;
    }
    const short = address.slice(0,6) + "…" + address.slice(-4);
    walletLabel.textContent = short;
    if(statusWallet) statusWallet.textContent = short;
    if(statusMsg) statusMsg.textContent = "Connected on BNB Smart Chain.";
  };

  window.__KLY = Object.assign(window.__KLY || {}, {
    CONTRACT,
    toast,
    setEligibility: function(kly){
      if(kly >= ACADEMY_THRESHOLD) unlockAcademy();
      else lockAcademy();
    }
  });

  // =========================
  // PROVIDER HELPERS
  // =========================
  const hasProvider = ()=> typeof window.ethereum !== "undefined";

  async function ensureBSC(){
    const current = await window.ethereum.request({ method: "eth_chainId" });
    if(current === BSC.chainId) return true;
    try{
      await window.ethereum.request({
        method: "wallet_switchEthereumChain",
        params: [{ chainId: BSC.chainId }]
      });
      return true;
    }catch(err){
      // 4902 => Chain not added
      if(err && err.code === 4902){
        await window.ethereum.request({ method: "wallet_addEthereumChain", params: [BSC] });
        return true;
      }
      // 4001 => user rejected; surface but don't spam console
      if(!(err && err.code === 4001)){
        console.error('[ensureBSC]', err);
      }
      throw err;
    }
  }

  async function attachListeners(){
    if(!window.ethereum) return;
    window.ethereum.removeListener?.("accountsChanged", onAccountsChanged);
    window.ethereum.removeListener?.("chainChanged", onChainChanged);
    window.ethereum.on("accountsChanged", onAccountsChanged);
    window.ethereum.on("chainChanged", onChainChanged);
  }

  async function onAccountsChanged(accounts){
    if(!accounts || !accounts.length){
      userAddress = undefined;
      window.setWallet(null);
      __KLY.setEligibility(0);
      currentBalance = 0;
      return;
    }
    userAddress = ethers.getAddress(accounts[0]);
    window.setWallet(userAddress);
    await updateKlyBalance();
  }

  async function onChainChanged(chainId){
    if(chainId !== BSC.chainId){
      if(statusMsg) statusMsg.textContent = "Wrong network — switch to BNB Smart Chain.";
      toast("Wrong network — switching to BNB…");
      try{
        await ensureBSC();
        await updateKlyBalance();
      }catch{
        // user rejected; stay degraded
      }
    }else{
      await updateKlyBalance();
    }
  }

  // =========================
  // KLY BALANCE
  // =========================
  async function getKlyContractReadable(){
    // Use a plain provider for reads to avoid signer perms
    const readProv = provider || (hasProvider() ? new ethers.BrowserProvider(window.ethereum, "any") : null);
    if(!readProv) throw new Error("No provider available");
    const prov = await readProv.getSigner().provider; // ensures a Networkish provider
    return new ethers.Contract(CONTRACT, ERC20_ABI, prov);
  }

  async function readMeta(contract){
    if(!klyDecimals){
      try{ klyDecimals = await contract.decimals(); } catch { klyDecimals = 18; }
    }
    if(!klySymbol || klySymbol === "KLY"){
      try{ klySymbol = await contract.symbol(); } catch { klySymbol = "KLY"; }
    }
    return { klyDecimals, klySymbol };
  }

  async function updateKlyBalance(){
    try{
      if(!userAddress) return;
      const contract = await getKlyContractReadable();
      const { klyDecimals } = await readMeta(contract);
      const raw = await contract.balanceOf(userAddress);
      currentBalance = Number(ethers.formatUnits(raw, klyDecimals));
      if(statusMsg){
        statusMsg.textContent = `Balance: ${currentBalance.toLocaleString(undefined, { maximumFractionDigits: 4 })} ${klySymbol}`;
      }
      __KLY.setEligibility(currentBalance);
      // Update quest UI if present
      markQuestStates();
    }catch(err){
      console.error('[updateKlyBalance]', err);
      if(statusMsg) statusMsg.textContent = "Balance unavailable.";
      toast("Could not fetch KLY balance.", "error");
    }
  }

  // Optional: reflect quests (if markup exists)
  function markQuestStates(){
    // "Connect on BNB" done if address present and network is BSC
    const questCards = document.querySelectorAll('.quest');
    if(!questCards.length) return;
    const [connectCard, stakeCard, reachCard] = questCards;
    if(connectCard){
      const badge = connectCard.querySelector('.state');
      if(userAddress) { badge.textContent = "Completed"; badge.className = "state done"; }
      else { badge.textContent = "Locked"; badge.className = "state lock"; }
    }
    if(reachCard){
      const badge = reachCard.querySelector('.state');
      if(currentBalance >= ACADEMY_THRESHOLD){ badge.textContent = "Completed"; badge.className = "state done"; }
      else { badge.textContent = "Locked"; badge.className = "state lock"; }
    }
  }

  // =========================
  // CONNECT FLOW
  // =========================
  async function connect(){
    if(!hasProvider()){
      toast("No wallet detected. Install MetaMask or a compatible wallet.", "error");
      if(statusMsg) statusMsg.textContent = "Wallet not found.";
      return;
    }
    // Button loading UI
    connectBtn.disabled = true;
    const prev = connectBtn.innerHTML;
    connectBtn.innerHTML = '<span class="spinner" aria-hidden="true"></span><span>Connecting…</span>';

    try{
      await ensureBSC();
      const accounts = await window.ethereum.request({ method: "eth_requestAccounts" });
      userAddress = ethers.getAddress(accounts[0]);

      provider = new ethers.BrowserProvider(window.ethereum, "any");
      signer   = await provider.getSigner();

      window.setWallet(userAddress);
      toast("Wallet connected.", "success");

      await updateKlyBalance();
      await attachListeners();
    }catch(err){
      if(err && err.code === 4001){
        toast("Connection cancelled.", "error");
        if(statusMsg) statusMsg.textContent = "Connection cancelled.";
      }else{
        console.error('[connect]', err);
        toast("Connection failed. Check your wallet.", "error");
        if(statusMsg) statusMsg.textContent = "Connection failed.";
      }
    }finally{
      connectBtn.disabled = false;
      connectBtn.innerHTML = prev;
    }
  }

  // =========================
  // COPY CONTRACT + SHORT LABEL
  // =========================
  try{
    if(contractShortEl) contractShortEl.textContent = CONTRACT.slice(0,6) + "..." + CONTRACT.slice(-4);
    if(copyContractBtn){
      copyContractBtn.addEventListener('click', async ()=>{
        try{
          await navigator.clipboard.writeText(CONTRACT);
          toast("Contract copied.", "success");
        }catch{
          toast("Failed to copy contract.", "error");
        }
      });
    }
  }catch(e){ /* ignore */ }

  // =========================
  // KEYBOARD SUPPORT FOR BUTTON-LINKS
  // (ensures Space/Enter click)
  // =========================
  document.querySelectorAll('a.btn').forEach(a=>{
    a.setAttribute('role','button');
    a.addEventListener('keydown', (e)=>{
      if(e.key === ' ' || e.key === 'Enter'){ e.preventDefault(); a.click(); }
    });
  });

  // =========================
  // WIRE EVENTS
  // =========================
  if(connectBtn) connectBtn.addEventListener('click', connect);

  // Silent hydrate on load (if already connected)
  (async function hydrate(){
    if(!hasProvider()) return;
    try{
      const accounts = await window.ethereum.request({ method: "eth_accounts" });
      if(accounts && accounts[0]){
        await ensureBSC();
        userAddress = ethers.getAddress(accounts[0]);
        provider = new ethers.BrowserProvider(window.ethereum, "any");
        signer   = await provider.getSigner();
        window.setWallet(userAddress);
        await updateKlyBalance();
        await attachListeners();
      }
    }catch(e){ /* ignore */ }
  })();

})();
</script>
</body>
</html>
