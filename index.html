<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>KLY Token | Kelly Legacy Estates</title>

  <meta name="description" content="KLY Token – tokenized education, DeFi, DAO governance & NFTs on BNB Chain. Build wealth. Own legacy.">
  <meta property="og:title" content="KLY Token | Kelly Legacy Estates">
  <meta property="og:description" content="Build wealth and own legacy with KLY Token. Tokenized education, DeFi, DAO governance & NFTs.">
  <meta property="og:image" content="https://blush-worthy-ape-39.mypinata.cloud/ipfs/bafybeifssvwf74gv25c3r76cxfdqraerll7l4kgruqaox6cskrqsu2e2by">

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;700;900&family=Rajdhani:wght@500;700&display=swap" rel="stylesheet">

  <style>
    :root{
      --neon-green:#00ffe7;--neon-pink:#ff00aa;--neon-purple:#aa00ff;--dark-bg:#000;
      --panel-bg:rgba(0,0,0,.85);--text-primary:#e0e0e0;--text-secondary:#888;
      --glow-green:0 0 10px var(--neon-green);
      --transition-fast:.2s;--transition-med:.4s;
      --maxw:1200px;
    }
    *{margin:0;padding:0;box-sizing:border-box}
    html{scroll-behavior:smooth}
    body{
      font-family:'Rajdhani','Orbitron',sans-serif;background:var(--dark-bg);
      color:var(--text-primary);overflow-x:hidden;line-height:1.6;
    }
    a{text-decoration:none;color:inherit}

    /* ===== Preloader ===== */
    #preloader{
      position:fixed;inset:0;background:#000;display:flex;align-items:center;justify-content:center;z-index:9999
    }
    #preloader .logo{
      font-family:'Orbitron',sans-serif;font-size:2.6rem;font-weight:900;color:var(--neon-green);
      text-shadow:0 0 20px var(--neon-green),0 0 40px var(--neon-green);
      animation:pulseLogo 1.5s infinite alternate
    }
    #preloader .logo span{color:var(--neon-pink);text-shadow:0 0 16px var(--neon-pink)}
    @keyframes pulseLogo{
      0%{transform:scale(1);opacity:1}
      100%{transform:scale(1.2);opacity:.7}
    }

    /* ===== Particles layer ===== */
    #particles-js{
      position:fixed;inset:0;z-index:-1;background:radial-gradient(ellipse at bottom,#0a0a0a 0%,#000 100%);
      opacity:.9;
    }

    /* ===== Header / Nav ===== */
    header{
      position:fixed;top:0;left:0;width:100%;z-index:1000;background:var(--panel-bg);
      backdrop-filter:blur(10px);border-bottom:1px solid var(--neon-green);
      box-shadow:var(--glow-green);padding:.9rem 1.2rem;display:flex;justify-content:space-between;align-items:center;
    }
    .logo{
      font-family:'Orbitron',sans-serif;font-weight:900;font-size:1.8rem;color:var(--neon-green);
      text-shadow:var(--glow-green);
    }
    .logo span{color:var(--neon-pink)}
    .nav-button-group{
      display:flex;flex-wrap:wrap;gap:.75rem;justify-content:flex-end;align-items:center;
      max-width:100%;
    }
    .nav-btn{
      color:var(--text-primary);font-weight:700;font-size:.95rem;letter-spacing:1px;padding:.55rem 1rem;border-radius:10px;
      background:rgba(0,0,0,.75);transition:all var(--transition-med);
      box-shadow:0 0 6px rgba(0,255,231,.15),inset 0 0 6px rgba(0,255,231,.08);
    }
    .nav-btn:hover{color:var(--neon-green);box-shadow:0 0 14px var(--neon-green),inset 0 0 10px rgba(0,255,231,.25)}
    .new-badge{
      background:var(--neon-pink);color:#000;font-family:'Orbitron',sans-serif;font-size:.6rem;font-weight:700;
      padding:2px 5px;border-radius:6px;margin-left:6px;box-shadow:0 0 12px var(--neon-pink);text-transform:uppercase
    }

    /* ===== Generic layout ===== */
    main{margin-top:90px}
    section.section{
      max-width:var(--maxw);margin:5rem auto;padding:3rem;border-radius:16px;background:var(--panel-bg);
      border:1px solid rgba(0,255,231,.1);box-shadow:0 0 30px rgba(0,255,231,.15);
      position:relative;overflow:hidden;
    }
    .section-title{
      font-family:'Orbitron',sans-serif;font-size:2.6rem;margin-bottom:2rem;color:var(--neon-green);
      position:relative;display:inline-block;
    }
    .section-title:after{
      content:'';position:absolute;left:0;bottom:-8px;height:2px;width:100%;
      background:linear-gradient(90deg,var(--neon-green),transparent);
    }
    .section-content{
      display:grid;grid-template-columns:1fr 1fr;gap:2.5rem;
    }
    .section-text p{color:var(--text-secondary);margin-bottom:1.1rem;font-size:1.05rem;line-height:1.7}
    .section-image img{
      max-width:100%;border-radius:12px;box-shadow:0 0 15px rgba(0,255,231,.15)
    }

    /* ===== Hero ===== */
    .hero-section{
      min-height:70vh;display:flex;flex-direction:column;justify-content:center;align-items:center;text-align:center;padding:6rem 1rem 4rem;
      position:relative;overflow:hidden;
    }
    .hero-title{
      font-family:'Orbitron',sans-serif;font-size:4rem;font-weight:900;letter-spacing:3px;
      background:linear-gradient(90deg,var(--neon-green),var(--neon-purple),var(--neon-pink));
      -webkit-background-clip:text;background-clip:text;color:transparent;text-shadow:0 0 22px rgba(0,255,231,.3);
    }
    .hero-subtitle{
      max-width:800px;color:var(--text-secondary);font-size:1.25rem;margin:1.1rem auto 2.2rem;
    }
    .wallet-button-group{
      display:flex;gap:1rem;flex-wrap:wrap;justify-content:center;align-items:center;
    }
    .wallet-button{
      padding:.8rem 1.3rem;background:linear-gradient(135deg,var(--neon-green),var(--neon-purple));
      border:none;border-radius:8px;color:#000;font-weight:700;letter-spacing:1px;cursor:pointer;
      transition:all var(--transition-med);
    }
    .wallet-button:hover{transform:translateY(-3px);box-shadow:0 0 14px var(--neon-green)}
    .wallet-address{
      display:none;font-family:'Orbitron',sans-serif;font-size:.9rem;color:var(--neon-green);
      background:rgba(0,31,29,.5);padding:.6rem 1rem;border:1px solid var(--neon-green);border-radius:8px;
    }

    /* ===== Feature cards ===== */
    .hero-grid{
      max-width:var(--maxw);margin:0 auto 4rem;display:grid;gap:2rem;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));
      padding:0 1rem;
    }
    .hero-card{
      background:var(--panel-bg);border:1px solid rgba(0,255,231,.08);
      border-radius:12px;padding:2rem;text-align:center;transition:all var(--transition-med);
      box-shadow:0 0 10px rgba(0,255,231,.08);
    }
    .hero-card i{font-size:2.2rem;color:var(--neon-green);margin-bottom:1rem}
    .hero-card h3{color:var(--neon-green);margin-bottom:.6rem}
    .hero-card p{color:var(--text-secondary)}
    .hero-card:hover{transform:translateY(-6px);box-shadow:0 0 18px rgba(0,255,231,.2)}

    /* ===== Buttons ===== */
    .cta-button{
      display:inline-block;padding:1rem 2rem;background:linear-gradient(135deg,var(--neon-green),var(--neon-purple));
      color:#000;font-family:'Orbitron',sans-serif;font-weight:700;border:none;border-radius:8px;
      transition:all var(--transition-med);cursor:pointer;text-transform:uppercase;letter-spacing:1px;
    }
    .cta-button:hover{transform:translateY(-3px);box-shadow:0 0 18px var(--neon-green)}

    /* ===== Lists ===== */
    .custom-list{list-style:none;margin:1rem 0 2rem 0;padding:0}
    .custom-list li{margin-bottom:1rem;color:var(--text-secondary);font-size:1.05rem}
    .custom-list li span{color:var(--text-primary)}

    /* ===== NFT card ===== */
    .nft-card{
      background:#111;padding:15px;border-radius:12px;max-width:320px;margin:auto;
      box-shadow:0 0 15px var(--neon-green);text-align:center;
    }
    .nft-card img{
      max-width:100%;border-radius:12px;box-shadow:0 0 15px var(--neon-green);
    }
    .nft-card h3{color:var(--neon-green);margin-top:10px}
    .nft-card p{font-size:.95rem;color:#ccc}

    /* ===== Dashboard stats ===== */
    #dashboardStats p strong{color:var(--neon-green)}

    /* ===== Footer ===== */
    footer{
      background:#0a0a0a;border-top:1px solid rgba(0,255,231,.12);
      padding:3rem 1rem 2rem;margin-top:5rem;text-align:center;
    }
    .footer-links{
      max-width:var(--maxw);margin:0 auto 2rem;display:grid;gap:1.5rem;
      grid-template-columns:repeat(auto-fit,minmax(180px,1fr));
      text-align:left;
    }
    .footer-column h3{
      color:var(--neon-green);font-family:'Orbitron',sans-serif;margin-bottom:.8rem;font-size:1.05rem;
    }
    .footer-column a{
      display:block;color:var(--text-secondary);font-weight:600;margin:.4rem 0;transition:color var(--transition-fast);
    }
    .footer-column a:hover{color:var(--neon-green)}
    .copyright{color:var(--neon-green);font-family:'Orbitron',sans-serif;font-size:.85rem;margin-top:1.2rem}

    /* ===== Fade in on scroll ===== */
    .reveal{opacity:0;transform:translateY(24px);transition:opacity .8s ease,transform .8s ease}
    .reveal.visible{opacity:1;transform:translateY(0)}

    /* ===== Responsive ===== */
    @media(max-width:992px){
      .section-content{grid-template-columns:1fr}
      .hero-title{font-size:3.2rem}
    }
    @media(max-width:768px){
      header{flex-direction:column;align-items:flex-start;gap:.7rem}
      .nav-button-group{justify-content:flex-start}
      .hero-title{font-size:2.5rem}
      .section{padding:2rem}
      .section-title{font-size:2.1rem}
    }
    @media(max-width:576px){
      .hero-title{font-size:2.1rem}
    }
  </style>
</head>
<body>
  <!-- Preloader -->
  <div id="preloader">
    <div class="logo">KLY<span>TOKEN</span></div>
  </div>

  <!-- Particles Background -->
  <div id="particles-js"></div>

  <!-- Header -->
  <header>
    <div class="logo">KLY<span>TOKEN</span></div>
    <nav class="nav-button-group">
      <a href="#mint" class="nav-btn">Mint</a>
      <a href="#dashboard" class="nav-btn">Dashboard</a>
      <a href="#staking" class="nav-btn">Staking</a>
      <a href="#dao" class="nav-btn">DAO</a>
      <a href="kly-academy.html" class="nav-btn">KLY Academy <span class="new-badge">NEW</span></a>
      <a href="launchpad.html" class="nav-btn">Launchpad</a>
      <a href="nft-drop.html" class="nav-btn">NFT Drop</a>
      <a href="KLY-vault.html" class="nav-btn">KLY Vault <span class="new-badge">NEW</span></a>
    </nav>
  </header>

  <main>
    <!-- Hero -->
    <section class="hero-section reveal">
      <h1 class="hero-title">BUILD WEALTH. OWN LEGACY.</h1>
      <p class="hero-subtitle">
        Powered by KLY Token – your gateway to tokenized education, DeFi, and DAO governance on BNB Chain.
      </p>

      <div class="wallet-button-group">
        <button id="connectWallet" class="wallet-button">
          <i class="fas fa-wallet"></i> Connect Wallet
        </button>
        <div class="wallet-address" id="walletAddress">0x0000...0000</div>
        <a href="https://discord.gg/QdanyP34" target="_blank" class="wallet-button">
          <i class="fas fa-users"></i> Join the Tribe
        </a>
      </div>
    </section>

    <!-- Feature cards -->
    <div class="hero-grid reveal">
      <div class="hero-card">
        <i class="fas fa-chart-line"></i>
        <h3>Tokenized Education</h3>
        <p>Access premium courses and earn NFT certifications through KLY tokens</p>
      </div>
      <div class="hero-card">
        <i class="fas fa-coins"></i>
        <h3>DeFi Ecosystem</h3>
        <p>Stake, provide liquidity, and earn rewards in our decentralized finance platform</p>
      </div>
      <div class="hero-card">
        <i class="fas fa-users"></i>
        <h3>DAO Governance</h3>
        <p>Shape the future of KLY through decentralized decision-making</p>
      </div>
      <div class="hero-card">
        <i class="fas fa-rocket"></i>
        <h3>Launchpad</h3>
        <p>Launch your own token projects with KLY's dedicated launch platform</p>
      </div>
    </div>

    <!-- MINT -->
    <section class="section reveal" id="mint">
      <h2 class="section-title">MINT YOUR KLY KEY</h2>
      <div class="section-content">
        <div class="section-text">
          <p>Claim your Genesis NFT to unlock:</p>
          <ul class="custom-list">
            <li>🎓 <span>Access to token-gated courses</span></li>
            <li>🗝️ <span>Entry into the Builder’s Temple</span></li>
            <li>🌕 <span>Staking multipliers + rare DAO access</span></li>
          </ul>
          <button class="cta-button" onclick="mintNFT()">Mint Now</button>
        </div>

        <div class="section-image" style="text-align:center;">
          <div class="nft-card">
            <img
              src="https://blush-worthy-ape-39.mypinata.cloud/ipfs/bafybeifssvwf74gv25c3r76cxfdqraerll7l4kgruqaox6cskrqsu2e2by"
              alt="KLY Genesis NFT Preview"/>
            <h3>KLY Genesis NFT</h3>
            <p>The first drop in the KLY Legacy collection. Own a piece of the movement.</p>
            <button class="cta-button" onclick="mintNFT()">Mint Now</button>
          </div>
        </div>
      </div>
    </section>

    <!-- WHY KLY -->
    <section class="section reveal" id="why">
      <h2 class="section-title">WHY KLY TOKEN?</h2>
      <div class="section-content">
        <div class="section-text">
          <p>The Kelly Legacy Token (KLY) represents a revolutionary approach to wealth building in the Web3 era. We combine education, decentralized finance, and community governance into a single powerful ecosystem.</p>
          <p>Unlike traditional cryptocurrencies, KLY is backed by real-world utility through our educational platform, staking rewards, and DAO governance system. This creates sustainable value that grows with our community.</p>
          <p>Built on BNB Chain for low fees and high speed, KLY is designed to be accessible to everyone while providing enterprise-grade infrastructure for serious investors and builders.</p>
          <a href="#dashboard" class="cta-button">Explore Dashboard</a>
        </div>
        <div class="section-image">
          <img src="https://images.unsplash.com/photo-1639762681057-408e52192e55?q=80&w=1000" alt="Blockchain visualization">
        </div>
      </div>
    </section>

    <!-- DASHBOARD -->
    <section class="section reveal" id="dashboard">
      <h2 class="section-title">DASHBOARD</h2>
      <div class="section-content">
        <div class="section-image">
          <img src="https://images.unsplash.com/photo-1626785774573-4b799315345d?q=80&w=1000" alt="Dashboard visualization">
        </div>

        <div class="section-text">
          <p>Your personal KLY dashboard provides real-time insights into your token holdings, staking rewards, governance participation, and educational progress.</p>
          <p>Connect your wallet to view your personalized stats.</p>

          <div id="dashboardStats" style="display:none;">
            <p><strong>Your Balance:</strong> <span id="userBalance">--</span> KLY</p>
            <p><strong>Staked:</strong> <span id="userStaked">--</span> KLY</p>
            <p><strong>Pending Rewards:</strong> <span id="userRewards">--</span> KLY</p>
            <p><strong>DAO Voting Power:</strong> <span id="votingPower">--</span></p>
          </div>

          <button class="cta-button" id="refreshData" style="display:none;">Refresh Data</button>
        </div>
      </div>
    </section>

    <!-- STAKING -->
    <section class="section reveal" id="staking">
      <h2 class="section-title">STAKING</h2>
      <div class="section-content">
        <div class="section-text">
          <p>Earn passive income by staking your KLY tokens in our secure smart contracts. Choose between flexible staking or lock-up periods for higher rewards.</p>
          <p>Stakers receive bonus NFT rewards and increased DAO voting power based on their staked amount and duration.</p>

          <div style="margin-top:1.2rem;">
            <input id="stakeAmount" type="number" min="0" placeholder="Amount to stake" style="padding:.7rem;border-radius:6px;border:1px solid rgba(0,255,231,.3);background:#111;color:#fff;max-width:220px;margin-right:.6rem;">
            <button class="cta-button" onclick="stakeKLY()">Stake</button>
            <button class="cta-button" style="margin-left:.5rem;" onclick="claimRewards()">Claim</button>
            <button class="cta-button" style="margin-left:.5rem;" onclick="withdrawStake()">Withdraw</button>
          </div>

          <div id="status" style="margin-top:1rem;color:var(--neon-green);font-family:'Orbitron',sans-serif;"></div>
        </div>

        <div class="section-image">
          <img src="https://images.unsplash.com/photo-1621761191319-c6fb62004040?q=80&w=1000" alt="Staking visualization">
        </div>
      </div>
    </section>

    <!-- DAO -->
    <section class="section reveal" id="dao">
      <h2 class="section-title">DAO GOVERNANCE</h2>
      <div class="section-content">
        <div class="section-image">
          <img src="https://images.unsplash.com/photo-1563986768609-322da13575f3?q=80&w=1000" alt="DAO visualization">
        </div>

        <div class="section-text">
          <p>The KLY DAO puts the power in the hands of token holders. Participate in proposals, vote on ecosystem decisions, and help shape the future of the platform.</p>
          <p>Your voting power is proportional to your KLY holdings and staking participation. The more you contribute, the greater your influence.</p>
          <a href="#dao" class="cta-button">Enter DAO</a>
        </div>
      </div>
    </section>
  </main>

  <!-- Footer -->
  <footer>
    <div class="footer-links">
      <div class="footer-column">
        <h3>Ecosystem</h3>
        <a href="#dashboard">Dashboard</a>
        <a href="#staking">Stake</a>
        <a href="#dao">DAO Governance</a>
        <a href="course.html">Education</a>
        <a href="launchpad.html">Launchpad</a>
      </div>
      <div class="footer-column">
        <h3>Resources</h3>
        <a href="white-paper.html">White Paper</a>
        <a href="documentation.html">Documentation</a>
        <a href="smart-contracts.html">Smart Contracts</a>
        <a href="tokenomics.html">Tokenomics</a>
        <a href="roadmap.html">Roadmap</a>
      </div>
      <div class="footer-column">
        <h3>Company</h3>
        <a href="about-us.html">About Us</a>
        <a href="team.html">Team</a>
        <a href="careers.html">Careers</a>
        <a href="contact.html">Contact</a>
        <a href="legal.html">Legal</a>
      </div>
    </div>

    <div class="copyright">
      &copy; 2025 Kelly Legacy Estates. All rights reserved.
    </div>
  </footer>

  <!-- libs -->
  <script src="https://cdn.jsdelivr.net/npm/particles.js@2.0.0/particles.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.min.js"></script>

  <script>
    /***********************
     * CONFIG
     ***********************/
    const STAKE_CONTRACT = "0xe9417Fbe4e1D1E70aaE00b76e9B54599707c49e0";
    const KLY_TOKEN      = "0x2e4fEB2Fe668c8Ebe84f19e6c8fE8Cf8131B4E52";
    const NFT_CONTRACT   = "0xc1a2E9A475779EfD04247EA473638717E26cd5C5";
    const TOKEN_URI      = "https://blush-worthy-ape-39.mypinata.cloud/ipfs/bafybeifssvwf74gv25c3r76cxfdqraerll7l4kgruqaox6cskrqsu2e2by";

    const STAKING_ABI = [
      { "inputs":[{ "internalType":"uint256","name":"_amount","type":"uint256"}], "name":"stake","outputs":[], "stateMutability":"nonpayable","type":"function" },
      { "inputs":[], "name":"claim","outputs":[], "stateMutability":"nonpayable","type":"function" },
      { "inputs":[], "name":"withdraw","outputs":[], "stateMutability":"nonpayable","type":"function" }
    ];

    const ERC20_ABI = [
      { "constant": true,  "inputs":[{ "name":"account","type":"address" }], "name":"balanceOf", "outputs":[{ "name":"","type":"uint256"}], "type":"function" },
      { "constant": true,  "inputs":[], "name":"decimals",   "outputs":[{ "name":"","type":"uint8"}], "type":"function" },
      { "constant": false, "inputs":[{ "name":"spender","type":"address" },{ "name":"amount","type":"uint256"}], "name":"approve", "outputs":[{ "name":"","type":"bool"}], "type":"function" }
    ];

    const NFT_ABI = [
      "function mintTo(address to, string uri) public"
    ];

    /***********************
     * STATE
     ***********************/
    let provider, signer, userAddress;
    let tokenContract, stakeContract, nftContract;
    let tokenDecimals = 18;

    /***********************
     * PRELOADER + PARTICLES + REVEAL
     ***********************/
    window.addEventListener("load", () => {
      const pre = document.getElementById("preloader");
      pre.style.opacity = "0";
      setTimeout(() => pre.style.display = "none", 600);
    });

    particlesJS("particles-js", {
      "particles": {
        "number": {"value": 60, "density": {"enable": true, "value_area": 800}},
        "color": {"value": "#00ffe7"},
        "opacity": {"value": 0.3, "random": true},
        "size": {"value": 3, "random": true},
        "line_linked": {"enable": true, "distance": 150, "color": "#00ffe7", "opacity": 0.2, "width": 1},
        "move": {"enable": true, "speed": 1.4}
      },
      "retina_detect": true
    });

    const revealEls = document.querySelectorAll('.reveal');
    const observer = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if(entry.isIntersecting) {
          entry.target.classList.add('visible');
          observer.unobserve(entry.target);
        }
      });
    }, {threshold: 0.15});
    revealEls.forEach(el => observer.observe(el));

    /***********************
     * WEB3 / ETHERS
     ***********************/
    async function connectWallet() {
      try {
        if (!window.ethereum) return alert("Please install MetaMask.");
        await window.ethereum.request({ method: "eth_requestAccounts" });
        provider = new ethers.providers.Web3Provider(window.ethereum);
        signer   = provider.getSigner();
        userAddress = await signer.getAddress();

        document.getElementById("walletAddress").textContent = userAddress.slice(0,6) + "..." + userAddress.slice(-4);
        document.getElementById("walletAddress").style.display = "inline-block";
        document.getElementById("dashboardStats").style.display = "block";
        document.getElementById("refreshData").style.display = "inline-block";

        tokenContract = new ethers.Contract(KLY_TOKEN, ERC20_ABI, signer);
        stakeContract = new ethers.Contract(STAKE_CONTRACT, STAKING_ABI, signer);
        nftContract   = new ethers.Contract(NFT_CONTRACT, NFT_ABI, signer);

        tokenDecimals = await tokenContract.decimals();

        await loadDashboardData();
      } catch (e) {
        console.error(e);
        alert("Wallet connection failed.");
      }
    }

    async function loadDashboardData() {
      try {
        const balanceRaw = await tokenContract.balanceOf(userAddress);
        const balance = Number(ethers.utils.formatUnits(balanceRaw, tokenDecimals)).toFixed(2);
        document.getElementById("userBalance").textContent = balance;

        // (Optional) - If your staking contract exposes view funcs for staked/rewards, plug them here.
        document.getElementById("userStaked").textContent   = "--";
        document.getElementById("userRewards").textContent  = "--";
        document.getElementById("votingPower").textContent  = "--";
      } catch (e) {
        console.error("loadDashboardData:", e);
      }
    }

    async function stakeKLY() {
      const status = document.getElementById("status");
      if (!signer) return alert("Connect your wallet first.");

      const amount = document.getElementById("stakeAmount").value;
      if (!amount || parseFloat(amount) <= 0) {
        return alert("Enter a valid amount to stake.");
      }

      try {
        const wei = ethers.utils.parseUnits(amount, tokenDecimals);

        status.textContent = "Approving KLY…";
        const approveTx = await tokenContract.approve(STAKE_CONTRACT, wei);
        await approveTx.wait();

        status.textContent = "Staking KLY…";
        const tx = await stakeContract.stake(wei);
        await tx.wait();

        status.textContent = "✅ Staked successfully!";
        await loadDashboardData();
      } catch (e) {
        console.error(e);
        status.textContent = "❌ Transaction failed.";
      }
    }

    async function claimRewards() {
      const status = document.getElementById("status");
      if (!signer) return alert("Connect your wallet first.");
      try {
        status.textContent = "Claiming rewards…";
        const tx = await stakeContract.claim();
        await tx.wait();
        status.textContent = "✅ Rewards claimed!";
        await loadDashboardData();
      } catch (e) {
        console.error(e);
        status.textContent = "❌ Failed to claim.";
      }
    }

    async function withdrawStake() {
      const status = document.getElementById("status");
      if (!signer) return alert("Connect your wallet first.");
      try {
        status.textContent = "Withdrawing stake…";
        const tx = await stakeContract.withdraw();
        await tx.wait();
        status.textContent = "✅ Stake withdrawn!";
        await loadDashboardData();
      } catch (e) {
        console.error(e);
        status.textContent = "❌ Failed to withdraw.";
      }
    }

    async function mintNFT() {
      try {
        if (!signer) return alert("Connect your wallet first.");
        const tx = await nftContract.mintTo(userAddress, TOKEN_URI);
        await tx.wait();
        alert("🎉 NFT Minted Successfully!");
      } catch (e) {
        console.error(e);
        alert("Minting failed. Check console for details.");
      }
    }

    // Events
    document.getElementById("connectWallet").addEventListener("click", connectWallet);
    document.getElementById("refreshData")?.addEventListener("click", loadDashboardData);
  </script>
</body>
</html>
