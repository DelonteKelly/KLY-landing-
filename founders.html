<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>KLY Founders Circle ‚Äî Pre‚ÄëSale</title>
<meta name="description" content="Secure your KLY Founders spot for 0.05 BNB. Only 100 wallets. Lifetime perks, staking boosts, and exclusive Founders NFT.">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
<style>
  :root{
    --bg:#0b0b0d; --panel:#121216; --text:#f4f4f5; --muted:#b6b6b8;
    --gold:#e6c15a; --gold-2:#aa8b2d; --stroke:#232328; --ok:#3ddc97;
  }
  *{box-sizing:border-box}
  body{margin:0;background:radial-gradient(1000px 600px at 50% -10%,#17171b 0%,#0b0b0d 45%,#050506 100%);color:var(--text);font-family:Inter,system-ui,Segoe UI,Roboto,Arial}
  .wrap{max-width:1120px;margin:0 auto;padding:24px}
  .hero{display:grid;grid-template-columns:1.1fr .9fr;gap:28px;align-items:center}
  .card{background:linear-gradient(180deg,#15151a,#0f0f12);border:1px solid var(--stroke);border-radius:18px;padding:22px;box-shadow:0 10px 30px rgba(0,0,0,.35)}
  .badge{display:inline-flex;align-items:center;gap:8px;padding:8px 12px;border:1px solid var(--gold-2);border-radius:999px;color:var(--gold);font-weight:600;background:rgba(166,135,32,.08)}
  h1{font-size:40px;line-height:1.08;margin:14px 0 10px}
  p{color:var(--muted);margin:8px 0 0}
  .cta{display:flex;gap:12px;margin-top:18px;flex-wrap:wrap}
  .btn{appearance:none;border:none;border-radius:14px;padding:14px 18px;font-weight:700;cursor:pointer}
  .btn.primary{background:linear-gradient(180deg,var(--gold),#caa43f);color:#1a1a1a;border:1px solid var(--gold-2)}
  .btn.ghost{background:transparent;color:var(--gold);border:1px solid var(--gold-2)}
  .pill{padding:8px 12px;border-radius:999px;background:#0f0f13;border:1px solid var(--stroke);color:var(--muted)}
  .grid3{display:grid;grid-template-columns:repeat(3,1fr);gap:16px;margin-top:16px}
  .kpi{padding:16px;border:1px solid var(--stroke);border-radius:14px;background:linear-gradient(180deg,#15151a,#101014);text-align:center}
  .kpi h3{margin:6px 0 4px;font-size:22px}
  .kpi span{color:var(--muted);font-size:12px}
  .progress{margin-top:14px;height:12px;background:#101015;border:1px solid var(--stroke);border-radius:999px;overflow:hidden}
  .bar{height:100%;background:linear-gradient(90deg,#f7e08a,#e6c15a,#caa43f)}
  .section{margin-top:36px}
  .list{display:grid;gap:10px}
  .list .row{display:flex;gap:10px;align-items:flex-start}
  .dot{width:10px;height:10px;border-radius:50%;background:var(--gold);margin-top:7px;flex:0 0 10px}
  .faq{display:grid;gap:12px;margin-top:12px}
  .q{padding:14px;border:1px solid var(--stroke);border-radius:12px;background:#111115}
  .foot{margin:34px 0 14px;text-align:center;color:#808087;font-size:12px}
  @media (max-width:960px){.hero{grid-template-columns:1fr}}
</style>
</head>
<body>
  <div class="wrap">
    <!-- HERO -->
    <div class="hero">
      <div class="card">
        <span class="badge">üîë KLY Founders Circle ‚Äî Phase 1</span>
        <h1>Secure your spot ‚Ä¢ <span style="color:var(--gold)">0.05 BNB</span> ‚Ä¢ Only 100 wallets</h1>
        <p>Founders get lifetime perks: staking boost, private academy access, and the first wave of KLY utility. Price is locked for this phase only.</p>
        <div class="cta">
          <a class="btn primary" id="claimBtn" href="https://thirdweb.com/bnb/0x7a732Ae6b2Db2ceACc3Ffe6F63F3B9B0Ce94A026/claim" target="_blank" rel="noopener">Claim on Thirdweb</a>
          <button class="btn ghost" id="copyBtn">Copy Claim Link</button>
          <span class="pill" id="countdown">‚è≥ Ends soon‚Ä¶</span>
        </div>

        <div class="grid3">
          <div class="kpi">
            <h3>0.05 BNB</h3><span>Cost per wallet</span>
          </div>
          <div class="kpi">
            <h3>1,000 KLY</h3><span>Tokens per wallet</span>
          </div>
          <div class="kpi">
            <h3 id="spotsLeft">100</h3><span>Spots remaining</span>
          </div>
        </div>

        <div class="progress" title="Spots filled">
          <div class="bar" id="fillBar" style="width:0%"></div>
        </div>
        <p style="margin-top:6px">Spots filled: <b id="filledText">0</b>/100 ‚Ä¢ Live while supplies last.</p>
      </div>

      <div class="card">
        <h3 style="margin:4px 0 8px">Founders Perks</h3>
        <div class="list">
          <div class="row"><div class="dot"></div><div><b>Lifetime staking boost</b> on KLY Vault rewards.</div></div>
          <div class="row"><div class="dot"></div><div><b>Private Academy access</b> to School of the Scrolls modules.</div></div>
          <div class="row"><div class="dot"></div><div><b>Priority mints</b> + early drops inside the KLY ecosystem.</div></div>
          <div class="row"><div class="dot"></div><div><b>OG role</b> in Discord with gated rooms & AMAs.</div></div>
        </div>
        <div class="section">
          <h3 style="margin:0 0 8px">How it works</h3>
          <div class="list">
            <div class="row"><div class="dot"></div><div>Tap <b>Claim on Thirdweb</b>, connect wallet, select 1,000 tokens.</div></div>
            <div class="row"><div class="dot"></div><div>Pay <b>0.05 BNB</b>. Tokens deliver instantly to your wallet.</div></div>
            <div class="row"><div class="dot"></div><div>Use your KLY to unlock staking and holder utilities.</div></div>
          </div>
        </div>
      </div>
    </div>

    <!-- FAQ / TRUST -->
    <div class="section">
      <div class="card">
        <h3 style="margin:0 0 8px">FAQ</h3>
        <div class="faq">
          <div class="q"><b>What chain?</b><br>BNB Smart Chain (BEP‚Äë20). Make sure your wallet is on BNB.</div>
          <div class="q"><b>What‚Äôs the cap?</b><br>100 wallets for this phase. Each gets 1,000 KLY for 0.05 BNB.</div>
          <div class="q"><b>Where does the purchase happen?</b><br>On the official Thirdweb claim page linked above.</div>
          <div class="q"><b>Is there a next phase?</b><br>Yes ‚Äî price increases after Phase 1 fills.</div>
        </div>
      </div>
    </div>

    <p class="foot">Never trust DMs. We will not change the claim link. ¬© KLY Legacy</p>
  </div>

<script src="https://unpkg.com/ethers@5.7.2/dist/ethers.umd.min.js"></script>
<script>
  // ==== CONFIG YOU CAN EDIT QUICKLY ====
  const TOTAL_SPOTS = 100; // total available in your claim phase
  const CLAIM_URL = "https://thirdweb.com/bnb/0x7a732Ae6b2Db2ceACc3Ffe6F63F3B9B0Ce94A026/claim";
  const END_ISO_FALLBACK = "2025-08-22T23:59:00Z"; // used only if we can't infer end on-chain
  let spotsClaimed = 0; // will be updated automatically from contract

  // Thirdweb contract read settings
  const CONTRACT_ADDRESS = "0x7a732Ae6b2Db2ceACc3Ffe6F63F3B9B0Ce94A026"; 
  const RPC_URL = "https://bsc-dataseed.binance.org/"; // BNB Mainnet RPC
  const ERC20_DROP_ABI = [
    "function getActiveClaimConditionId() view returns (uint256)",
    "function getClaimConditionById(uint256) view returns (tuple(uint256 startTimestamp,uint256 maxClaimableSupply,uint256 supplyClaimed,uint256 quantityLimitPerTransaction,bytes32 merkleRoot,uint256 pricePerToken,address currency))"
  ];
  // =====================================

  const spotsLeftEl = document.getElementById('spotsLeft');
  const filledText = document.getElementById('filledText');
  const bar = document.getElementById('fillBar');
  const cta = document.getElementById('claimBtn');
  const cd = document.getElementById('countdown');
  cta.href = CLAIM_URL;

  // Will be set from-chain if a "next" phase exists
  let dynamicEndMs = null;

  function renderSpots(){
    const left = Math.max(0, TOTAL_SPOTS - spotsClaimed);
    const pct = Math.min(100, (spotsClaimed / TOTAL_SPOTS) * 100);
    if (spotsLeftEl) spotsLeftEl.textContent = left;
    if (filledText)  filledText.textContent = spotsClaimed;
    if (bar)         bar.style.width = pct + "%";
  }

  async function fetchLivePhase(){
    try {
      const provider = new ethers.providers.JsonRpcProvider(RPC_URL);
      const c = new ethers.Contract(CONTRACT_ADDRESS, ERC20_DROP_ABI, provider);

      // Active condition
      const id = await c.getActiveClaimConditionId();
      const cond = await c.getClaimConditionById(id);

      // Spots (since 1 token = 1 spot, we treat values as whole units)
      const claimed = Number(ethers.utils.formatUnits(cond.supplyClaimed, 0));
      spotsClaimed = claimed;
      renderSpots();

      // Try to infer end time from NEXT phase's startTimestamp
      try {
        const nextCond = await c.getClaimConditionById(id.add(1));
        const nextStart = Number(nextCond.startTimestamp) * 1000; // ms
        if (nextStart > Date.now()) dynamicEndMs = nextStart;
      } catch (e) {
        // No next phase found ‚Äî keep fallback
        dynamicEndMs = null;
      }
    } catch(e) {
      console.error("Failed to fetch phase data:", e);
      renderSpots(); // keep whatever we have
    }
  }

  function tick(){
    const fallbackMs = new Date(END_ISO_FALLBACK).getTime();
    const endMs = dynamicEndMs || fallbackMs;

    if (!endMs || isNaN(endMs)) {
      cd.textContent = "‚è≥ Closing soon";
      return;
    }
    const now = Date.now();
    const d = endMs - now;
    if (d <= 0){
      cd.textContent = "‚è≥ Closing soon";
      return;
    }
    const days = Math.floor(d / 86400000);
    const hrs  = Math.floor((d % 86400000) / 3600000);
    const min  = Math.floor((d % 3600000) / 60000);
    cd.textContent = `‚è≥ Ends in ${days}d ${hrs}h ${min}m`;
  }

  // Initial loads + intervals
  renderSpots();
  fetchLivePhase().then(tick);
  setInterval(fetchLivePhase, 30000); // refresh on-chain data every 30s
  setInterval(tick, 30000);           // update countdown every 30s

  // Copy link
  document.getElementById('copyBtn').onclick = async () => {
    try { 
      await navigator.clipboard.writeText(CLAIM_URL); 
      alert("Claim link copied ‚úÖ"); 
    } catch(e){ 
      prompt("Copy the claim link:", CLAIM_URL); 
    }
  };
</script>
</body>
</html>
