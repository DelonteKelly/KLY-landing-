<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Oracle Scrolls ‚Äî AURORA VAULT</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@600;800;900&family=Inter:wght@300;400;600;800&display=swap" rel="stylesheet">
<style>
  :root{
    --bg:#07080b; --ink:#efe9dd; --muted:#bfb7a3;
    --gold1:#fdeab3; --gold2:#e7c874; --gold3:#b68836; --gold4:#6a4a16;
    --glow:#a9e0ff; --emerald:#79eeb5; --glass:rgba(255,255,255,.06); --brd:rgba(231,200,116,.22);
    --ring: rgba(231,200,116,.45);
    --r:18px; --w:1200px;
    --success: rgba(121,238,178,.46);
    --warning: rgba(238,190,121,.46);
    --error: rgba(238,121,121,.46);
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0; background:var(--bg); color:var(--ink);
    font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif; overflow-x:hidden;
  }

  /* ===== BACKGROUND AURORA SHADER + GRAIN ===== */
  #aurora, #grain { position:fixed; inset:0; z-index:-3; display:block }
  #grain{ pointer-events:none; mix-blend-mode:overlay; opacity:.35; background-image:
    radial-gradient(1px 1px at 15% 20%, rgba(255,255,255,.06) 0, transparent 45%),
    radial-gradient(1px 1px at 70% 60%, rgba(255,255,255,.04) 0, transparent 50%); }
  .vignette{ position:fixed; inset:0; z-index:-2; pointer-events:none; box-shadow:inset 0 0 280px 90px #000; }
  .topglow{ position:fixed; left:50%; top:-8%; width:1600px; height:700px; transform:translateX(-50%);
    background:radial-gradient(50% 50% at 50% 50%, rgba(169,224,255,.18), transparent 70%); filter:blur(10px); opacity:.35; z-index:-2; }

  /* ===== NAV ===== */
  .nav{
    position:sticky; top:0; z-index:20; display:flex; align-items:center; justify-content:space-between; gap:16px;
    padding:12px 22px; background:rgba(10,11,13,.38); backdrop-filter:blur(12px) saturate(140%);
    border-bottom:1px solid var(--brd); transition: all 0.3s ease;
  }
  .nav.scrolled {
    background: rgba(10,11,13,.85);
    box-shadow: 0 4px 20px rgba(0,0,0,0.3);
  }
  .brand{display:flex; align-items:center; gap:.75rem}
  .mark{width:32px; height:32px; filter:drop-shadow(0 0 12px rgba(231,200,116,.28)); transition: transform 0.3s ease;}
  .brand:hover .mark { transform: rotate(15deg); }
  .brand__text{font-family:Cinzel,serif; font-weight:900; letter-spacing:.14em; text-transform:uppercase; color:#f5ead4; font-size:.98rem}
  .nav__links{display:flex; gap:18px}
  .nav__link{color:#e1d7c2; text-decoration:none; opacity:.9; position: relative; padding: 8px 0; transition: all 0.2s ease;}
  .nav__link:hover{opacity:1; color: var(--gold2);}
  .nav__link::after {
    content: ''; position: absolute; bottom: 0; left: 0; width: 0; height: 1px;
    background: var(--gold2); transition: width 0.3s ease;
  }
  .nav__link:hover::after { width: 100%; }
  .btn{
    padding:12px 18px; border-radius:999px; border:1px solid var(--brd); background:rgba(255,255,255,.04); color:#f7f3e8; font-weight:700; letter-spacing:.02em; cursor:pointer;
    transition:transform .15s ease, box-shadow .2s ease, background .2s ease; outline:none; position: relative; overflow: hidden;
  }
  .btn:focus-visible{box-shadow:0 0 0 4px var(--ring)}
  .btn:hover{transform:translateY(-1px)}
  .btn--gold{position:relative; background:linear-gradient(180deg,var(--gold1),var(--gold2)); border-color:rgba(0,0,0,.12); color:#1b1206; text-shadow:0 1px 0 rgba(255,255,255,.35)}
  .btn--gold::after{
    content:""; position:absolute; inset:0; background:linear-gradient(120deg, transparent 10%, rgba(255,255,255,.6) 45%, transparent 65%);
    transform:skewX(-20deg) translateX(-120%); mix-blend-mode:screen; opacity:.35; animation:shine 2.8s ease-in-out infinite;
  }
  @keyframes shine{ 60%{transform:skewX(-20deg) translateX(120%)} 100%{transform:skewX(-20deg) translateX(120%)} }
  
  /* Loading spinner */
  .spinner {
    display: inline-block; width: 16px; height: 16px; border: 2px solid rgba(255,255,255,.3);
    border-radius: 50%; border-top-color: var(--gold2); animation: spin 1s ease-in-out infinite;
    margin-right: 8px; vertical-align: middle;
  }
  @keyframes spin { to { transform: rotate(360deg); } }

  /* ===== HERO ===== */
  .wrap{width:min(var(--w),92%); margin:0 auto}
  .hero{position:relative; padding: clamp(36px,6vw,72px) 0 10px; text-align:center}
  .halo{position:absolute; inset:-20px 0 auto; height:280px; pointer-events:none; background:
      radial-gradient(60% 60% at 50% 40%, rgba(231,200,116,.22), transparent 70%); filter:blur(8px); opacity:.6}
  .sigils{position:absolute; inset:0; pointer-events:none}
  .sigil{position:absolute; width:120px; height:120px; opacity:.2; filter:drop-shadow(0 0 12px rgba(231,200,116,.2)); transition: all 0.5s ease;}
  .sigil--l{left:4%; top:18%; transform:rotate(-8deg)}
  .sigil--r{right:6%; top:34%; transform:rotate(12deg)}
  .display{
    font-family:Cinzel,serif; font-weight:900; letter-spacing:.14em; text-transform:uppercase;
    font-size: clamp(30px,7vw,68px); margin:0 0 14px; line-height:1.05;
    background: linear-gradient(90deg, var(--gold4), var(--gold3), var(--gold2), var(--gold1), var(--gold2), var(--gold3));
    background-size: 220% auto; color:transparent; -webkit-background-clip:text; background-clip:text; animation:foil 9s linear infinite;
    text-shadow:0 0 24px rgba(231,200,116,.12);
  }
  @keyframes foil{0%{background-position:0% 50%}100%{background-position:200% 50%}}
  .sub{color:#e6ddc8; font-size:clamp(14px,2.4vw,18px); margin:0 0 18px}
  .hero__cta{display:flex; justify-content:center; gap:12px; flex-wrap:wrap}

  /* ===== ACCESS BANNER (glass) ===== */
  .access{
    margin:18px auto 10px; padding:14px 16px; width:min(var(--w),92%);
    display:grid; grid-template-columns:auto 1fr auto; gap:14px; align-items:center;
    border-radius:var(--r); border:1px solid var(--brd);
    background:linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
    backdrop-filter: blur(10px) saturate(130%);
    box-shadow: inset 0 1px 0 rgba(255,255,255,.06), 0 18px 60px rgba(0,0,0,.32);
    transition: all 0.3s ease;
  }
  .access__icon{font-size:20px; transition: transform 0.3s ease;}
  .access__text{font-weight:800}
  .access__meta{color:var(--muted); font-size:.96rem}
  .badge{display:inline-block; padding:.26rem .6rem; border-radius:999px; border:1px solid var(--brd); background:linear-gradient(180deg, rgba(231,200,116,.18), rgba(182,136,54,.08)); color:#f0e6d3}
  .access--ok{border-color: var(--success); animation: pulse 2s infinite;}
  .access--warn{border-color: var(--warning)}
  .access--error{border-color: var(--error)}
  @keyframes pulse {
    0% { box-shadow: 0 0 0 0 rgba(121,238,178,0.4); }
    70% { box-shadow: 0 0 0 10px rgba(121,238,178,0); }
    100% { box-shadow: 0 0 0 0 rgba(121,238,178,0); }
  }

  /* ===== GRID ===== */
  .main{width:min(var(--w),92%); margin:26px auto 90px}
  .rule{display:flex; align-items:center; gap:14px; color:#d6cfbf; margin:10px 0 18px;
    font-family:Cinzel,serif; letter-spacing:.14em; text-transform:uppercase; font-size:.98rem}
  .rule::before,.rule::after{content:""; height:1px; flex:1; background:linear-gradient(90deg, transparent, rgba(231,200,116,.38), transparent)}
  .grid{display:grid; grid-template-columns: repeat(12,1fr); gap:18px}
  .col-5{grid-column: span 5}
  .col-6{grid-column: span 6}
  .col-7{grid-column: span 7}
  .col-12{grid-column: 1 / -1}
  @media (max-width:980px){ .col-7,.col-5,.col-6,.col-12{grid-column:1/-1} }

  /* ===== SCROLL CARD (glass + foil edge + depth) ===== */
  .card{
    position:relative; border-radius:22px; overflow:hidden;
    border:1px solid var(--brd); background:linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.04));
    backdrop-filter: blur(8px) saturate(130%);
    box-shadow: inset 0 1px 0 rgba(255,255,255,.1), 0 22px 80px rgba(0,0,0,.45);
    transform-style:preserve-3d; perspective:1000px;
    transition: transform 0.3s ease, box-shadow 0.3s ease;
  }
  .card::before{ /* animated border glow */
    content:""; position:absolute; inset:-2px; pointer-events:none; border-radius:22px;
    background: conic-gradient(from 0deg, rgba(231,200,116,.0), rgba(231,200,116,.22), rgba(231,200,116,.0) 30%);
    filter: blur(16px); opacity:.35; animation:ring 12s linear infinite;
  }
  @keyframes ring{to{transform:rotate(360deg)}}
  .card__in{padding:22px 18px}
  .pills{display:flex; gap:8px; flex-wrap:wrap; margin-bottom:12px}
  .pill{font-size:.8rem; padding:.3rem .68rem; border-radius:999px; border:1px solid var(--brd); background:rgba(231,200,116,.1)}
  .pill--rare{background:linear-gradient(180deg, rgba(231,200,116,.24), rgba(182,136,54,.08)); color:#1a1208; border-color:rgba(0,0,0,.18)}
  .title{font-family:Cinzel,serif; font-weight:800; font-size:clamp(18px,3.6vw,28px); letter-spacing:.02em; margin:4px 0 8px}
  .tease{color:#eadfc8; margin:0 0 10px}
  .meta{display:flex; gap:14px; color:#c7bfae; font-size:.95rem}
  .lock{display:flex; align-items:center; gap:8px; margin:12px 0 14px; color:#f2e6cd}
  .actions{display:flex; gap:10px; flex-wrap:wrap}
  .callout{margin-top:12px; border-radius:16px; border:1px dashed var(--brd); padding:14px; color:#efe2c8; background:linear-gradient(180deg, rgba(255,255,255,.05), rgba(255,255,255,.03)); display:none}
  
  /* Scroll content reveal */
  .scroll-content {
    max-height: 0; overflow: hidden; transition: max-height 0.5s ease;
    background: rgba(0,0,0,0.2); border-radius: 12px; margin-top: 16px; padding: 0 20px;
  }
  .scroll-content.revealed {
    max-height: 500px; padding: 20px;
  }
  .scroll-content p { margin: 0 0 16px; line-height: 1.6; }
  .scroll-content p:last-child { margin-bottom: 0; }

  /* ===== FOOTER ===== */
  .footer{display:flex; justify-content:center; align-items:center; gap:.7rem; padding:40px 12px 64px; color:#d2c9b4; border-top:1px solid var(--brd)}

  /* ===== MODAL ===== */
  .modal {
    position: fixed; top: 0; left: 0; width: 100%; height: 100%;
    background: rgba(7,8,11,0.9); backdrop-filter: blur(8px);
    display: flex; align-items: center; justify-content: center;
    z-index: 100; opacity: 0; visibility: hidden; transition: all 0.3s ease;
  }
  .modal.active {
    opacity: 1; visibility: visible;
  }
  .modal-content {
    background: linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.04));
    border: 1px solid var(--brd); border-radius: var(--r);
    padding: 30px; max-width: 500px; width: 90%;
    backdrop-filter: blur(12px) saturate(130%);
    box-shadow: 0 20px 80px rgba(0,0,0,0.5);
    transform: translateY(20px); transition: transform 0.3s ease;
  }
  .modal.active .modal-content {
    transform: translateY(0);
  }
  .modal-header {
    display: flex; justify-content: space-between; align-items: center;
    margin-bottom: 20px; border-bottom: 1px solid var(--brd); padding-bottom: 15px;
  }
  .modal-title {
    font-family: Cinzel, serif; font-weight: 800; font-size: 1.5rem;
    margin: 0;
  }
  .modal-close {
    background: none; border: none; color: var(--muted); font-size: 1.5rem;
    cursor: pointer; transition: color 0.2s ease;
  }
  .modal-close:hover { color: var(--ink); }

  /* ===== MOBILE ===== */
  @media (max-width:780px){
    .nav__links{display:none}
    .access{grid-template-columns:24px 1fr; gap:10px}
    .access__meta{grid-column:1 / -1}
    .modal-content { padding: 20px; }
  }

  /* Mobile menu */
  .mobile-menu-btn {
    display: none; background: none; border: none; color: var(--ink);
    font-size: 1.5rem; cursor: pointer; padding: 5px;
  }
  @media (max-width: 780px) {
    .mobile-menu-btn { display: block; }
    .nav__links {
      position: absolute; top: 100%; left: 0; width: 100%;
      background: rgba(10,11,13,.95); backdrop-filter: blur(12px);
      flex-direction: column; padding: 20px; display: none;
      border-bottom: 1px solid var(--brd);
    }
    .nav__links.active { display: flex; }
    .nav__link { padding: 12px 0; }
  }

  /* ===== MICRO-POLISH / A11Y / TOASTS / REVEAL ===== */
  :focus-visible { outline: none; box-shadow: 0 0 0 4px var(--ring) !important; }
  .btn[aria-busy="true"] { pointer-events: none; opacity: .8; }
  .reveal { opacity: 0; transform: translateY(14px); transition: opacity .6s ease, transform .6s ease; }
  .reveal.in { opacity: 1; transform: translateY(0); }
  .toast {
    position: fixed; right: 16px; bottom: 16px; z-index: 120;
    background: linear-gradient(180deg, rgba(255,255,255,.1), rgba(255,255,255,.05));
    border: 1px solid var(--brd); color: var(--ink); padding: 12px 14px; border-radius: 12px;
    box-shadow: 0 12px 50px rgba(0,0,0,.45);
    display: grid; grid-template-columns: 22px 1fr auto; gap: 10px; align-items: center; min-width: 280px;
  }
  .toast__icon{font-size:18px}
  .toast__msg{line-height:1.35}
  .toast__close{background:none;border:none;color:var(--muted);cursor:pointer}
  .audio-visual {
    width: 100%; height: 6px; border-radius: 999px; background: rgba(255,255,255,.08);
    overflow: hidden; margin-top: 10px; position: relative;
  }
  .audio-visual__bar { position:absolute; inset:0; transform-origin:left center; transform: scaleX(0); background: linear-gradient(90deg, var(--gold4), var(--gold2)); }

  /* ===== REDUCED MOTION ===== */
  @media (prefers-reduced-motion: reduce) {
    * { animation: none !important; transition: none !important; }
    .btn:hover { transform: none !important; }
  }
</style>
</head>
<body>
<canvas id="aurora" aria-hidden="true"></canvas>
<div id="grain" aria-hidden="true"></div>
<div class="vignette" aria-hidden="true"></div>
<div class="topglow" aria-hidden="true"></div>

<header class="nav">
  <div class="brand">
    <!-- Gold seal -->
    <svg class="mark" viewBox="0 0 64 64" aria-hidden="true">
      <defs><radialGradient id="mk" cx="50%" cy="50%" r="60%">
        <stop offset="0%" stop-color="#fdeab3"/><stop offset="55%" stop-color="#e7c874"/><stop offset="100%" stop-color="#6a4a16"/></radialGradient></defs>
      <circle cx="32" cy="32" r="30" fill="url(#mk)" stroke="#000" stroke-opacity=".22" stroke-width="1.5"/>
      <g fill="#1d1408" fill-opacity=".5" transform="translate(32,32)">
        <circle r="2.2" cx="0" cy="-20"/><circle r="2.2" cx="17.3" cy="-10"/><circle r="2.2" cx="20" cy="0"/>
        <circle r="2.2" cx="17.3" cy="10"/><circle r="2.2" cx="0" cy="20"/><circle r="2.2" cx="-17.3" cy="10"/>
        <circle r="2.2" cx="-20" cy="0"/><circle r="2.2" cx="-17.3" cy="-10"/>
      </g>
    </svg>
    <span class="brand__text">Oracle ‚Ä¢ Scrolls</span>
  </div>
  <button class="mobile-menu-btn" aria-label="Toggle menu" aria-expanded="false">‚ò∞</button>
  <nav class="nav__links" aria-label="Primary">
    <a class="nav__link" href="#">Oracle</a>
    <a class="nav__link" href="#">Scrolls</a>
    <a class="nav__link" href="#">Vault</a>
    <a class="nav__link" href="#">Academy</a>
  </nav>
  <div class="nav__cta">
    <button id="walletBtn" class="btn">Connect Wallet</button>
  </div>
</header>

<section class="hero wrap">
  <div class="halo" aria-hidden="true"></div>
  <div class="sigils" aria-hidden="true">
    <svg class="sigil sigil--l" viewBox="0 0 256 256">
      <circle cx="128" cy="128" r="118" fill="none" stroke="#e7c874" stroke-opacity=".35" stroke-width="2"/>
      <g stroke="#e7c874" stroke-opacity=".9" stroke-width="3" fill="none" transform="translate(128,128)">
        <polygon points="0,-60 52,30 -52,30"/>
        <circle r="42"/>
      </g>
    </svg>
    <svg class="sigil sigil--r" viewBox="0 0 256 256">
      <circle cx="128" cy="128" r="118" fill="none" stroke="#a9e0ff" stroke-opacity=".35" stroke-width="2"/>
      <g stroke="#a9e0ff" stroke-opacity=".9" stroke-width="3" fill="none" transform="translate(128,128)">
        <polygon points="0,-60 52,30 -52,30"/>
        <circle r="42"/>
      </g>
    </svg>
  </div>
  <h1 class="display">Oracle Scrolls</h1>
  <p class="sub">Transmissions for those who answer the call.</p>
  <div class="hero__cta">
    <button id="primaryCta" class="btn btn--gold">Connect Wallet</button>
    <button id="publicCta" class="btn">Browse Public Scrolls</button>
  </div>
</section>

<section id="accessBanner" class="access wrap" role="status" aria-live="polite">
  <div class="access__icon" aria-hidden="true">üîí</div>
  <div class="access__text"><strong>Access Locked.</strong> Connect wallet to check gate status.</div>
  <div class="access__meta">
    Chain: <span class="badge">BNB Smart Chain</span> ‚Ä¢ Gate: <span class="badge">Diamond Core NFT (ID 3)</span>
  </div>
</section>

<main class="main">
  <div class="rule">Latest Transmission</div>
  <div class="grid">
    <!-- Primary Featured Scroll -->
    <article class="card col-7" data-tilt="1" id="cardPrimary">
      <div class="card__in">
        <div class="pills"><span class="pill pill--rare">Diamond</span><span class="pill">12 min</span><span class="pill">Drop #07</span></div>
        <h3 class="title">Keys of Sovereignty: The Unsealing</h3>
        <p class="tease">Not for the curious‚Äîonly the called.</p>
        <div class="meta"><span>Updated: 2025-09-18</span><span>Category: Prophecy</span></div>
        <div class="lock"><span aria-hidden="true">üóùÔ∏è</span><span>Gate required: Diamond Core NFT</span></div>
        <div class="actions">
          <button class="btn btn--gold" disabled aria-disabled="true" id="unsealBtn">Unseal the Scroll</button>
          <button class="btn" id="mintInfoBtn">Learn How to Mint</button>
        </div>
        <div class="scroll-content" id="scrollContent">
          <p>Within the silent chambers of the heart, the keys await. They are not forged of metal, but of intention. Not held in hand, but in consciousness.</p>
          <p>The first key is remembrance‚Äîthe recognition of your eternal nature beyond the veil of forgetting.</p>
          <p>The second key is sovereignty‚Äîthe unwavering claim to your divine authority as a creator being.</p>
          <p>The third key is alignment‚Äîthe harmonious resonance with the cosmic frequencies that guide your path.</p>
          <p>These keys unlock not doors, but dimensions of being. They are the legacy of the Anunna, the star-born architects who seeded this reality.</p>
        </div>
      </div>
    </article>

    <!-- Sidebar Public Previews -->
    <aside class="col-5">
      <article class="card" data-tilt="1">
        <div class="card__in">
          <div class="pills"><span class="pill">Public</span><span class="pill">Audio</span></div>
          <h3 class="title">Invocation ‚Ä¢ "The Call Within"</h3>
          <p class="tease">A luminous preview to tune your field.</p>
          <div class="actions"><button class="btn" id="audioPreviewBtn">Play Preview</button></div>
          <!-- Visualizer bar appears here dynamically -->
        </div>
      </article>
      <article class="card" data-tilt="1" style="margin-top:18px">
        <div class="card__in">
          <div class="pills"><span class="pill">Public</span><span class="pill">Scroll</span></div>
          <h3 class="title">Anunna Archives: Blood of the Builders</h3>
          <p class="tease">Symbols and timelines for the returning ones.</p>
          <div class="actions"><button class="btn" id="publicScrollBtn">Read</button></div>
        </div>
      </article>
    </aside>
  </div>

  <!-- Additional Scrolls Section -->
  <div class="rule">More Oracle Scrolls</div>
  <div class="grid">
    <article class="card col-6" data-tilt="1">
      <div class="card__in">
        <div class="pills"><span class="pill">Transmission</span></div>
        <h3 class="title">The Scroll of Frequency</h3>
        <p class="tease">Tune your heart, and the cosmos will answer.</p>
        <div class="meta"><span>Updated: 2025-09-23</span><span>Category: Transmission</span></div>
        <div class="scroll-content">
          <blockquote>‚ÄúYou are not merely flesh, you are a resonance. A note played by the Infinite across eternity.‚Äù</blockquote>
          <p>When the veil thickens, remember: sound is the sword, breath is the shield, and silence is the gateway. Guard your frequency, and you will guard your soul.</p>
        </div>
      </div>
    </article>

    <article class="card col-6" data-tilt="1">
      <div class="card__in">
        <div class="pills"><span class="pill">Ancestral</span></div>
        <h3 class="title">The Archive of the Ancestors</h3>
        <p class="tease">Written in bloodlines, carved in stone.</p>
        <div class="meta"><span>Updated: 2025-09-23</span><span>Category: Record</span></div>
        <div class="scroll-content">
          <img src="images/temple.jpg" alt="Ancient temple" style="max-width:100%;border-radius:12px">
          <p>The ancestors encoded the truth in pyramids, petroglyphs, and prophecy. What was hidden from the colonizer is revealed to the seeker who dares to remember. Within your DNA sleeps an archive waiting to be awakened.</p>
        </div>
      </div>
    </article>

    <article class="card col-12" data-tilt="1">
      <div class="card__in">
        <div class="pills"><span class="pill pill--rare">Revelation</span></div>
        <h3 class="title">The Prophecy of Light</h3>
        <p class="tease">The dawn is not coming. You are the dawn.</p>
        <div class="meta"><span>Updated: 2025-09-23</span><span>Category: Revelation</span></div>
        <div class="scroll-content">
          <p>When the shadows grow bold, light multiplies in the faithful. The Prophecy of Light does not speak of saviors descending, but of sleepers rising. You are not waiting for salvation‚Äîyou are its embodiment.</p>
        </div>
      </div>
    </article>
  </div>
</main>
<footer class="footer">
  <span>¬© Tamaquah Nation ‚Ä¢ KLY ‚Ä¢ The Call Continues</span>
</footer>

<!-- Modal Structure -->
<div class="modal" id="infoModal" aria-hidden="true" role="dialog" aria-modal="true">
  <div class="modal-content">
    <div class="modal-header">
      <h3 class="modal-title">Diamond Core NFT</h3>
      <button class="modal-close" aria-label="Close modal">&times;</button>
    </div>
    <p>To access the Diamond-tier scrolls, you need to own the Diamond Core NFT (Token ID: 3).</p>
    <p>This NFT serves as your key to the highest level transmissions within the Oracle Scrolls vault.</p>
    <p>You can mint this NFT directly on the BNB Smart Chain by interacting with the contract.</p>
    <div class="actions" style="margin-top: 20px;">
      <button class="btn btn--gold" id="mintDirectBtn">Mint Diamond Core</button>
      <button class="btn" id="viewContractBtn">View Contract</button>
    </div>
  </div>
</div>

<!-- ===== LIBS ===== -->
<script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>

<!-- ===================== AURORA FRAGMENT SHADER ===================== -->
<script>
const aurora = document.getElementById('aurora');
const gl = aurora.getContext('webgl', { antialias: false, preserveDrawingBuffer: false });

function resizeAurora(){
  if(!gl){ return; }
  const dpr = Math.min(2, window.devicePixelRatio || 1);
  const w = Math.floor(innerWidth * dpr), h = Math.floor(innerHeight * dpr);
  if(aurora.width!==w || aurora.height!==h){ aurora.width=w; aurora.height=h; }
  gl.viewport(0,0,aurora.width, aurora.height);
}
const vert = `attribute vec2 p; void main(){ gl_Position = vec4(p,0.,1.); }`;
const frag = `
precision highp float;
uniform vec2 r; uniform float t;
float noise(vec2 v){ return fract(sin(dot(v, vec2(127.1,311.7))) * 43758.5453123); }
float fbm(vec2 p){ float v=0.0; float a=0.5; for(int i=0;i<6;i++){ v+=a*noise(p); p*=2.02; a*=0.5; } return v; }
void main(){
  vec2 uv = (gl_FragCoord.xy / r.xy);
  vec2 q = uv * vec2(r.x/r.y,1.);
  float m = fbm(q*2.0 + vec2(t*0.03, -t*0.02));
  float n = fbm(q*3.5 + vec2(-t*0.02, t*0.025));
  float band = smoothstep(.25,.75, m) * smoothstep(.95,.55, n);
  vec3 col = mix(vec3(0.02,0.05,0.1), vec3(0.1,0.4,0.65), band);
  col += vec3(0.15,0.55,0.4) * smoothstep(.6,1., m*n);
  col += vec3(0.9,0.82,0.55) * pow(band, 6.0) * 0.45;
  gl_FragColor = vec4(col, 1.0);
}`;
function shader(gl, vsrc, fsrc){
  function C(t,src){
    const s=gl.createShader(t);
    gl.shaderSource(s,src); gl.compileShader(s);
    if(!gl.getShaderParameter(s, gl.COMPILE_STATUS)) throw new Error(gl.getShaderInfoLog(s));
    return s;
  }
  const pr = gl.createProgram();
  gl.attachShader(pr, C(gl.VERTEX_SHADER,vsrc));
  gl.attachShader(pr, C(gl.FRAGMENT_SHADER,fsrc));
  gl.linkProgram(pr);
  if(!gl.getProgramParameter(pr, gl.LINK_STATUS)) throw new Error(gl.getProgramInfoLog(pr));
  return pr;
}

let uR,uT,locP,pr,buf;
if(gl){
  try{
    pr = shader(gl, vert, frag);
    buf = gl.createBuffer(); gl.bindBuffer(gl.ARRAY_BUFFER, buf);
    gl.bufferData(gl.ARRAY_BUFFER, new Float32Array([-1,-1, 1,-1, -1,1, 1,1]), gl.STATIC_DRAW);
    locP = gl.getAttribLocation(pr, 'p'); gl.enableVertexAttribArray(locP); gl.vertexAttribPointer(locP, 2, gl.FLOAT, false, 0, 0);
    uR = gl.getUniformLocation(pr, 'r'); uT = gl.getUniformLocation(pr, 't');
    resizeAurora(); window.addEventListener('resize', resizeAurora, { passive:true });
    const st = performance.now();
    (function loop(){
      if(!gl) return;
      gl.useProgram(pr);
      gl.uniform2f(uR, aurora.width, aurora.height);
      gl.uniform1f(uT, (performance.now()-st)/1000.0);
      gl.drawArrays(gl.TRIANGLE_STRIP, 0, 4);
      requestAnimationFrame(loop);
    })();
  }catch(e){
    console.warn('Aurora shader failed; falling back.', e);
    aurora.remove(); // fallback to static gradients beneath
  }
}else{
  // If WebGL not supported, remove canvas so static layers show cleanly
  aurora.remove();
}
</script>

<!-- ===================== ENHANCED INTERACTIVITY (UPGRADED) ===================== -->
<script>
/* Helpers */
const $ = (s, r=document)=>r.querySelector(s);
const $$ = (s, r=document)=>Array.from(r.querySelectorAll(s));
const on = (el, ev, fn, opts)=>el.addEventListener(ev, fn, opts);
const setBusy = (btn, busy=true, labelBusy='Loading...')=>{
  if(!btn) return;
  if(busy){
    btn.setAttribute('aria-busy','true');
    btn._prev = btn.innerHTML;
    btn.innerHTML = '<span class="spinner"></span>'+labelBusy;
  }else{
    btn.removeAttribute('aria-busy');
    if(btn._prev) btn.innerHTML = btn._prev;
  }
};
const toast = (msg, type='info')=>{
  const t = document.createElement('div');
  t.className = 'toast';
  t.innerHTML = `
    <div class="toast__icon">${type==='ok'?'‚úÖ':type==='warn'?'‚ö†Ô∏è':type==='err'?'‚ùå':'‚ú®'}</div>
    <div class="toast__msg">${msg}</div>
    <button class="toast__close" aria-label="Dismiss">‚úï</button>`;
  document.body.appendChild(t);
  const close = ()=>{ t.style.opacity='0'; setTimeout(()=>t.remove(),220); };
  on($('.toast__close', t),'click', close);
  setTimeout(close, 4200);
};

/* Mobile menu toggle */
const mobileBtn = $('.mobile-menu-btn');
const navLinks = $('.nav__links');
on(mobileBtn,'click',()=>{
  const active = navLinks.classList.toggle('active');
  mobileBtn.setAttribute('aria-expanded', active ? 'true' : 'false');
});
on(navLinks,'click',(e)=>{
  if(e.target.classList.contains('nav__link') && navLinks.classList.contains('active')){
    navLinks.classList.remove('active');
    mobileBtn.setAttribute('aria-expanded','false');
  }
});

/* Nav scroll effect */
on(window,'scroll',()=>{
  const nav = $('.nav');
  (window.scrollY>50) ? nav.classList.add('scrolled') : nav.classList.remove('scrolled');
},{passive:true});

/* Modal */
const modal = $('#infoModal');
const modalClose = $('.modal-close', modal);
const openModal = ()=>{
  modal.classList.add('active'); modal.setAttribute('aria-hidden','false');
  document.body.style.overflow='hidden';
  // focus trap start
  const focusables = $$('button,[href],input,select,textarea,[tabindex]:not([tabindex="-1"])', modal)
    .filter(el=>!el.hasAttribute('disabled'));
  const first = focusables[0], last = focusables[focusables.length-1];
  const trap = (e)=>{
    if(e.key!=='Tab') return;
    if(e.shiftKey && document.activeElement===first){ e.preventDefault(); last.focus(); }
    else if(!e.shiftKey && document.activeElement===last){ e.preventDefault(); first.focus(); }
  };
  modal._trap = trap;
  on(window,'keydown',trap);
  (first||modal).focus();
};
const closeModal = ()=>{
  modal.classList.remove('active'); modal.setAttribute('aria-hidden','true');
  document.body.style.overflow='';
  if(modal._trap){ window.removeEventListener('keydown', modal._trap); modal._trap=null; }
};
on(modalClose,'click',closeModal);
on(modal,'click',e=>{ if(e.target===modal) closeModal(); });
on(window,'keydown',e=>{ if(e.key==='Escape' && modal.classList.contains('active')) closeModal(); });

/* Audio element (real player) */
</script>
<audio id="invocationAudio" preload="auto">
  <!-- Replace with your actual audio path -->
  <source src="audio/invocation.mp3" type="audio/mpeg">
</audio>
<script>
const audio = $('#invocationAudio');
const audioBtn = $('#audioPreviewBtn');
let raf;
const createVisual = ()=>{
  let v = $('.audio-visual', audioBtn.parentElement);
  if(!v){
    v = document.createElement('div');
    v.className='audio-visual';
    v.innerHTML = '<div class="audio-visual__bar"></div>';
    audioBtn.parentElement.appendChild(v);
  }
  return v.querySelector('.audio-visual__bar');
};
const animateBar = ()=>{
  const bar = createVisual();
  const update = ()=>{
    const p = audio.duration ? (audio.currentTime / audio.duration) : 0;
    bar.style.transform = `scaleX(${Math.max(0,Math.min(1,p))})`;
    raf = requestAnimationFrame(update);
  };
  cancelAnimationFrame(raf); update();
};
on(audioBtn,'click', async ()=>{
  if(audio.paused){
    try{
      setBusy(audioBtn,true,'Loading...');
      await audio.play();
      setBusy(audioBtn,false);
      audioBtn.textContent = 'Pause Preview';
      animateBar();
      toast('Playing ‚ÄúThe Call Within‚Äù', 'ok');
    }catch(e){
      setBusy(audioBtn,false);
      toast('Could not play audio. Check your file path or user gesture policy.', 'warn');
    }
  }else{
    audio.pause(); audioBtn.textContent = 'Play Preview';
    cancelAnimationFrame(raf);
  }
});
on(audio,'ended',()=>{ audioBtn.textContent = 'Play Preview'; cancelAnimationFrame(raf); });

/* Public scroll micro-feedback */
const publicBtn = $('#publicScrollBtn');
on(publicBtn,'click',()=>{
  setBusy(publicBtn,true,'Opening...');
  setTimeout(()=>{ setBusy(publicBtn,false); toast('Public scroll opened.','ok'); },800);
});

/* Parallax + tilt (debounced) */
const sigL = $('.sigil--l'), sigR = $('.sigil--r');
let moveRAF;
on(window,'mousemove',(e)=>{
  cancelAnimationFrame(moveRAF);
  moveRAF = requestAnimationFrame(()=>{
    const x = (e.clientX / innerWidth - .5), y = (e.clientY / innerHeight - .5);
    sigL.style.transform = `translate(${x*-10}px, ${y*-6}px) rotate(-8deg)`;
    sigR.style.transform = `translate(${x*12}px, ${y*8}px) rotate(12deg)`;
  });
});
$$('.card[data-tilt="1"]').forEach(card=>{
  const r=12;
  on(card,'mousemove', e=>{
    const b=card.getBoundingClientRect(), dx=(e.clientX-b.left)/b.width-.5, dy=(e.clientY-b.top)/b.height-.5;
    card.style.transform = `rotateX(${(-dy*r)}deg) rotateY(${(dx*r)}deg) translateY(-6px)`;
  });
  on(card,'mouseleave', ()=> card.style.transform = '');
});

/* On-scroll reveal */
const revealables = $$('.card, .rule, .hero, .access').map(el=>{ el.classList.add('reveal'); return el; });
const io = new IntersectionObserver((ents)=>{
  ents.forEach(ent=>{
    if(ent.isIntersecting){
      ent.target.classList.add('in'); io.unobserve(ent.target);
    }
  });
},{ threshold:.12 });
revealables.forEach(el=> io.observe(el));

/* Keyboard: Unseal quick access */
on(window,'keydown',(e)=>{
  if(e.key.toLowerCase()==='u' && !$('#infoModal').classList.contains('active')){
    const btn = $('#unsealBtn');
    if(btn && !btn.disabled){ btn.click(); }
  }
});

/* Buttons that open modal / external */
on($('#mintInfoBtn'),'click', ()=> openModal());
on($('#viewContractBtn'),'click', ()=> window.open('https://bscscan.com/address/0xDA76d35742190283E340dbeE2038ecc978a56950#writeContract','_blank'));
</script>

<!-- ===================== WEB3 GATING + MINT (REFINED) ===================== -->
<script>
const els = {
  walletBtn:$('#walletBtn'),
  primaryCta:$('#primaryCta'),
  accessBanner:$('#accessBanner'),
  unsealBtn:$('#unsealBtn'),
  mintInfoBtn:$('#mintInfoBtn'),
  scrollContent:$('#scrollContent'),
  mintDirectBtn:$('#mintDirectBtn')
};

const CONFIG = {
  chainIdHex:'0x38',
  chainName:'BNB Smart Chain',
  rpcUrl:'https://bsc-dataseed.binance.org/',
  blockExplorer:'https://bscscan.com',
  klyErc20:'0x2e4fEB2Fe668c8Ebe84f19e6c8fE8Cf8131B4E52',
  diamondNft721:'0xDA76d35742190283E340dbeE2038ecc978a56950',
  diamondTokenId:'3',
  diamondUri:'ipfs://bafybeidq66s77zvhjdr3bwnmkgh5in4km56hals27xlidekblkpa25qzpq'
};
const ERC20_ABI = [
  "function balanceOf(address) view returns (uint256)",
  "function decimals() view returns (uint8)",
  "function symbol() view returns (string)"
];
const ERC721_ABI = [
  "function ownerOf(uint256) view returns (address)",
  "function balanceOf(address) view returns (uint256)"
];
const ERC721_MINT_ABI = [
  "function mintTo(address to, string uri) public payable returns (uint256 tokenId)"
];

let state = {
  connected:false, account:null, hasDiamondCore:false,
  kly:{balance:null, symbol:'KLY', decimals:18}
};

const short = (a)=> a ? a.slice(0,6)+'‚Ä¶'+a.slice(-4) : '';
const setStatus = (icon, html, cls)=>{
  els.accessBanner.className = 'access wrap ' + (cls||'');
  $('.access__icon', els.accessBanner).textContent = icon;
  $('.access__text', els.accessBanner).innerHTML = html;
};

const assertEth = ()=> {
  if(!window.ethereum){ 
    toast('No wallet found. Install MetaMask or a Web3 wallet.', 'warn'); 
    return false;
  }
  return true;
};

async function ensureBsc(){
  const cur = await ethereum.request({ method:'eth_chainId' });
  if(cur.toLowerCase() !== CONFIG.chainIdHex){
    try{
      await ethereum.request({ method:'wallet_switchEthereumChain', params:[{ chainId: CONFIG.chainIdHex }] });
    }catch(e){
      if(e.code===4902){
        await ethereum.request({ method:'wallet_addEthereumChain', params:[{
          chainId:CONFIG.chainIdHex, chainName:CONFIG.chainName,
          nativeCurrency:{ name:'BNB', symbol:'BNB', decimals:18 },
          rpcUrls:[CONFIG.rpcUrl], blockExplorerUrls:[CONFIG.blockExplorer]
        }]});
      } else { throw e; }
    }
  }
}

const provider = ()=> new ethers.providers.Web3Provider(window.ethereum);
const signer = ()=> provider().getSigner();

async function connect(){
  if(!assertEth()) return;
  setBusy(els.walletBtn,true,'Connecting...');
  try{
    await ensureBsc();
    const accs = await ethereum.request({ method:'eth_requestAccounts' });
    state.account = accs[0]; state.connected = true;
    if(ethereum.on){
      ethereum.removeAllListeners?.('accountsChanged');
      ethereum.on('accountsChanged', a=>{ if(a.length===0){disconnect()} else {state.account=a[0]; refresh()}});
      ethereum.on('chainChanged', ()=> location.reload());
    }
    await refresh();
    toast('Wallet connected: '+short(state.account),'ok');
  }catch(e){
    console.error(e);
    setStatus('‚ùå','<strong>Connection Failed.</strong> Please try again.','access--error');
  }finally{
    setBusy(els.walletBtn,false);
  }
}
async function disconnect(){
  state={connected:false,account:null,hasDiamondCore:false,kly:{balance:null,symbol:'KLY',decimals:18}};
  sessionStorage.removeItem('oracleAccess');
  render();
}

async function refresh(){
  try{
    await Promise.all([checkNFT(), readKLY()]);
    sessionStorage.setItem('oracleAccess', JSON.stringify({t:Date.now(), hasDiamondCore:state.hasDiamondCore}));
  }catch(e){
    console.warn('Status check error:', e);
    setStatus('‚ö†Ô∏è','<strong>Error checking status.</strong> Try again.','access--warn');
  }
  render();
}

async function checkNFT(){
  try{
    const c = new ethers.Contract(CONFIG.diamondNft721, ERC721_ABI, provider());
    const owner = await c.ownerOf(CONFIG.diamondTokenId);
    state.hasDiamondCore = owner && state.account && owner.toLowerCase() === state.account.toLowerCase();
  }catch(e){
    // ownerOf may revert if token not minted yet; fallback to balanceOf
    try{
      const c = new ethers.Contract(CONFIG.diamondNft721, ERC721_ABI, provider());
      const bal = await c.balanceOf(state.account);
      state.hasDiamondCore = bal && bal.gt(0);
    }catch(_) { state.hasDiamondCore=false; }
  }
}

async function readKLY(){
  try{
    const c = new ethers.Contract(CONFIG.klyErc20, ERC20_ABI, provider());
    const [raw,dec,sym] = await Promise.all([
      c.balanceOf(state.account),
      c.decimals(),
      c.symbol().catch(()=> 'KLY')
    ]);
    state.kly.decimals=dec; state.kly.symbol=sym||'KLY';
    state.kly.balance = Number(ethers.utils.formatUnits(raw, dec));
  }catch(e){ state.kly.balance=null; }
}

function render(){
  els.walletBtn.textContent = state.connected ? `Disconnect (${short(state.account)})` : 'Connect Wallet';
  els.primaryCta.textContent = state.connected ? 'Check Access' : 'Connect Wallet';

  if(!state.connected){
    setStatus('üîí','<strong>Access Locked.</strong> Connect wallet to check gate status.');
  } else if(!state.hasDiamondCore){
    setStatus('üóùÔ∏è', `<strong>Connected ${short(state.account)}.</strong> Gate required: Diamond Core NFT (ID 3).`, 'access--warn');
  } else {
    setStatus('‚úÖ', `<strong>Access Granted.</strong> Diamond Core verified for ${short(state.account)}.`, 'access--ok');
  }

  const lock = document.querySelector('.lock');
  if(state.connected && state.hasDiamondCore){
    lock && (lock.style.display='none');
    els.unsealBtn.disabled=false; els.unsealBtn.removeAttribute('aria-disabled');
    els.unsealBtn.textContent='Unseal the Scroll';
    els.scrollContent.classList.add('revealed');
  }else{
    lock && (lock.style.display='flex');
    els.unsealBtn.disabled=true; els.unsealBtn.setAttribute('aria-disabled','true');
    els.unsealBtn.textContent = state.connected ? 'Locked (Need Diamond Core)' : 'Unseal the Scroll';
    els.scrollContent.classList.remove('revealed');
  }

  const meta = document.querySelector('.access__meta');
  let badge = document.getElementById('klyBadge');
  if(state.connected){
    if(!badge){ badge = document.createElement('span'); badge.className='badge'; badge.id='klyBadge'; meta.append(' ‚Ä¢ ', badge); }
    badge.textContent = 'KLY: ' + (state.kly.balance==null ? '‚Äî' : `${state.kly.balance.toFixed(2)} ${state.kly.symbol}`);
  }else if(badge){ badge.remove(); }
}

/* Mint flow (Diamond Core) */
async function mintDiamondCore(){
  if(!state.connected){ toast('Connect your wallet first.', 'warn'); return; }
  try{
    await ensureBsc();
    setBusy(els.mintDirectBtn,true,'Minting...');
    const c = new ethers.Contract(CONFIG.diamondNft721, ERC721_MINT_ABI, signer());
    // If your contract requires a platform fee, add { value: ethers.utils.parseEther("...") } as 2nd arg to mintTo.
    const tx = await c.mintTo(state.account, CONFIG.diamondUri);
    toast('Transaction sent. Confirming‚Ä¶','info');
    const receipt = await tx.wait();
    if(receipt && receipt.status===1){
      toast('Diamond Core minted ‚úÖ','ok');
    } else {
      toast('Transaction did not succeed.', 'err');
    }
    closeModal();
    await refresh();
  }catch(e){
    console.error(e);
    const msg = e?.data?.message || e?.message || 'Mint failed.';
    toast(msg.includes('MINTER_ROLE') ? 'Minting is restricted: contract requires MINTER_ROLE.' : msg, 'err');
  }finally{
    setBusy(els.mintDirectBtn,false);
  }
}

/* Button events */
on(els.walletBtn,'click', ()=> state.connected ? disconnect() : connect());
on(els.primaryCta,'click', ()=> !state.connected ? connect() : refresh());
on($('#unsealBtn'),'click', function(){
  if(this.disabled) return;
  setBusy(this,true,'Unsealing...');
  setTimeout(()=>{
    setBusy(this,false); this.textContent='Unsealed ‚ú®';
    els.scrollContent.classList.add('revealed');
    toast('Scroll unsealed. Receive what is yours.','ok');
  }, 900);
});
on($('#mintDirectBtn'),'click', mintDiamondCore);

/* Initialize from cache */
(() =>{
  const cache = sessionStorage.getItem('oracleAccess');
  if(cache){
    try{
      const {hasDiamondCore} = JSON.parse(cache);
      state.hasDiamondCore = !!hasDiamondCore;
    }catch{}
  }
  render();
})();
</script>
</body>
</html>
