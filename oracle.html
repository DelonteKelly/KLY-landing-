<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Oracle Scrolls ‚Äî Plug & Play</title>
  <meta name="description" content="Oracle Scrolls: ancient-futurist Web3 page with wallet gating and KLY balance."/>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700;800&family=Inter:wght@300;400;600;800&display=swap" rel="stylesheet">

  <style>
    :root{
      --obsidian:#0A0B0D; --brass:#C5A25A; --gold:#D9B65D; --ether:#A9E0FF;
      --ink:#EAE7DF; --muted:#9DA3AE; --ring: rgba(217,182,93,.45); --radius:14px;
    }
    *{box-sizing:border-box} html,body{height:100%}
    body{
      margin:0; color:var(--ink); font-family:Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; line-height:1.55;
      background:
        radial-gradient(1200px 600px at 50% -10%, rgba(169,224,255,.08), transparent),
        linear-gradient(180deg, #0A0B0D 0%, #0A0B0D 30%, #0b0c0f 100%);
    }
    .bg{position:fixed; inset:0; pointer-events:none; z-index:-1}
    .fx-vignette{box-shadow: inset 0 0 220px 80px #000;}
    .fx-particles{
      background-image:
        radial-gradient(2px 2px at 20% 30%, rgba(255,255,255,.12), transparent),
        radial-gradient(1.5px 1.5px at 70% 60%, rgba(169,224,255,.2), transparent),
        radial-gradient(1.5px 1.5px at 40% 80%, rgba(255,255,255,.08), transparent),
        radial-gradient(2px 2px at 85% 25%, rgba(255,255,255,.14), transparent);
      filter: blur(.3px) brightness(.8); animation: drift 40s linear infinite; opacity:.5;
    }
    @keyframes drift { 0%{transform:translateY(0)} 100%{transform:translateY(-120px)} }

    .nav{
      position:sticky; top:0; z-index:10; display:flex; align-items:center; justify-content:space-between;
      padding:12px 24px; background:rgba(10,11,13,.4); backdrop-filter:saturate(140%) blur(8px);
      border-bottom:1px solid rgba(217,182,93,.12);
    }
    .nav__left{display:flex; align-items:center; gap:.6rem}
    .brand{font-family:Cinzel,serif; letter-spacing:.08em; text-transform:uppercase; font-weight:700; font-size:.95rem; color:#f2eada}
    .nav__links{display:flex; gap:1rem}
    .nav__link{color:#cfc7b6; text-decoration:none; font-size:.95rem; opacity:.86}
    .nav__link:hover{opacity:1}

    .btn{
      --py:12px; --px:18px; padding:var(--py) var(--px); border-radius:999px; border:1px solid rgba(217,182,93,.35);
      background:transparent; color:#f9f6ee; font-weight:600; letter-spacing:.02em; cursor:pointer;
      transition: transform .15s ease, box-shadow .15s ease, background .2s ease; outline:none;
    }
    .btn:focus-visible{box-shadow:0 0 0 4px var(--ring)}
    .btn:hover{transform:translateY(-1px)} .btn:active{transform:translateY(0)}
    .btn--gold{background:linear-gradient(180deg, var(--gold), var(--brass)); color:#1b1206; border-color:rgba(0,0,0,.15); text-shadow:0 1px 0 rgba(255,255,255,.3)}
    .btn--gold:disabled{opacity:.55; cursor:not-allowed; filter:grayscale(.2)}
    .btn--ghost{background:rgba(255,255,255,.04)}

    .hero{padding: clamp(48px,6vw,96px) 24px 24px; text-align:center; position:relative}
    .hero__sealwrap{position:relative; width:140px; height:140px; margin:0 auto 16px}
    .hero__halo{position:absolute; inset:-12px; border-radius:50%; background:radial-gradient(60% 60% at 50% 50%, rgba(217,182,93,.18), transparent 70%); filter: blur(10px)}
    .hero__title{font-family:Cinzel,serif; font-weight:800; letter-spacing:.08em; text-transform:uppercase; font-size:clamp(28px,6vw,52px); margin:6px 0 8px}
    .hero__subtitle{color:#d9d4c7; margin:0 0 18px; font-size:clamp(14px,2.4vw,18px)}
    .hero__ctas{display:flex; gap:12px; justify-content:center; flex-wrap:wrap}

    .access{
      --bg: rgba(255,255,255,.035);
      margin:18px auto; border:1px solid rgba(217,182,93,.22); background:var(--bg);
      width:min(1100px, 92%); border-radius:var(--radius);
      display:grid; grid-template-columns:auto 1fr auto; gap:14px; align-items:center; padding:12px 16px;
    }
    .access__icon{font-size:20px}
    .access__text{font-weight:600}
    .access__meta{color:var(--muted); font-size:.92rem}
    .badge{display:inline-block; padding:.2rem .55rem; border-radius:999px; border:1px solid rgba(217,182,93,.28); color:#eaddc6;
      background:linear-gradient(180deg, rgba(217,182,93,.16), rgba(197,162,90,.08));}
    .access--ok{border-color: rgba(90,201,120,.45)}
    .access--ok .access__icon{filter: drop-shadow(0 0 8px rgba(90,201,120,.4))}

    .main{width:min(1100px, 92%); margin:18px auto 64px}
    .section-title{font-family:Cinzel,serif; text-transform:uppercase; letter-spacing:.1em; font-size:1rem; color:#d6cfbf; opacity:.9; margin:8px 0 16px}

    .scroll__frame{
      position:relative; padding:18px 18px 16px; border-radius:var(--radius);
      background:
        radial-gradient(80% 60% at 50% 0%, rgba(169,224,255,.05), transparent 70%),
        linear-gradient(180deg, rgba(255,255,255,.04), rgba(255,255,255,.02));
      border:1px solid rgba(217,182,93,.22);
      box-shadow: inset 0 1px 0 rgba(255,255,255,.06), 0 10px 30px rgba(0,0,0,.35);
      overflow:hidden;
    }
    .scroll__frame::before{
      content:""; position:absolute; inset:-2px;
      background:conic-gradient(from 180deg at 50% 50%, rgba(217,182,93,.0), rgba(217,182,93,.15), rgba(217,182,93,.0));
      filter: blur(16px); opacity:.22; pointer-events:none;
    }
    .scroll__top{display:flex; gap:8px; flex-wrap:wrap; margin-bottom:10px}
    .pill{font-size:.78rem; padding:.25rem .6rem; border-radius:999px; background:rgba(217,182,93,.08); border:1px solid rgba(217,182,93,.25)}
    .pill--rarity{background:linear-gradient(180deg, rgba(217,182,93,.22), rgba(197,162,90,.08)); color:#1a1208; border-color:rgba(0,0,0,.2)}
    .pill--len,.pill--drop{color:#eae4d5}
    .scroll__title{font-family:Cinzel,serif; font-weight:700; font-size:clamp(18px,3.5vw,26px); letter-spacing:.02em; margin:6px 0 6px}
    .scroll__tease{color:#d9d4c7; margin:0 0 10px}
    .scroll__meta{display:flex; gap:14px; color:var(--muted); font-size:.92rem}
    .scroll__lock{display:flex; align-items:center; gap:8px; margin:12px 0 14px; color:#e8dfc9; opacity:.9}
    .scroll__actions{display:flex; gap:10px; flex-wrap:wrap}

    .footer{display:flex; gap:.6rem; align-items:center; justify-content:center; color:#bfb9a7; padding:36px 12px 48px; border-top:1px solid rgba(217,182,93,.12)}
    .footer__text{font-size:.95rem}

    @media (max-width:780px){
      .nav__links{display:none}
      .access{grid-template-columns:24px 1fr; gap:10px}
      .access__meta{grid-column:1 / -1}
    }
  </style>
</head>
<body>
  <div class="bg fx-particles" aria-hidden="true"></div>
  <div class="bg fx-vignette" aria-hidden="true"></div>

  <header class="nav">
    <div class="nav__left">
      <!-- Inline golden seal -->
      <svg width="32" height="32" viewBox="0 0 512 512" aria-hidden="true">
        <defs>
          <radialGradient id="g" cx="50%" cy="50%" r="60%">
            <stop offset="0%" stop-color="#FFDFA3"/><stop offset="55%" stop-color="#D9B65D"/><stop offset="100%" stop-color="#8C6B2A"/>
          </radialGradient>
        </defs>
        <circle cx="256" cy="256" r="238" fill="url(#g)" stroke="#2a1b06" stroke-opacity=".35" stroke-width="6"/>
        <circle cx="256" cy="256" r="206" fill="none" stroke="#ffffff" stroke-opacity=".25" stroke-width="3"/>
      </svg>
      <span class="brand">Oracle ‚Ä¢ Scrolls</span>
    </div>
    <nav class="nav__links" aria-label="Primary">
      <a href="#" class="nav__link">Oracle</a>
      <a href="#" class="nav__link">Scrolls</a>
      <a href="#" class="nav__link">Vault</a>
      <a href="#" class="nav__link">Academy</a>
    </nav>
    <div class="nav__right">
      <button id="walletBtn" class="btn btn--ghost" aria-live="polite">Connect Wallet</button>
    </div>
  </header>

  <section class="hero">
    <div class="hero__sealwrap">
      <!-- Larger seal -->
      <svg width="140" height="140" viewBox="0 0 512 512" style="animation:slowspin 18s linear infinite; filter: drop-shadow(0 0 24px rgba(217,182,93,.16));">
        <defs>
          <radialGradient id="g2" cx="50%" cy="50%" r="60%">
            <stop offset="0%" stop-color="#FFDFA3"/><stop offset="55%" stop-color="#D9B65D"/><stop offset="100%" stop-color="#8C6B2A"/>
          </radialGradient>
        </defs>
        <circle cx="256" cy="256" r="238" fill="url(#g2)" stroke="#2a1b06" stroke-opacity=".35" stroke-width="6"/>
        <circle cx="256" cy="256" r="206" fill="none" stroke="#ffffff" stroke-opacity=".25" stroke-width="3"/>
      </svg>
      <div class="hero__halo" aria-hidden="true"></div>
    </div>
    <h1 class="hero__title">Oracle Scrolls</h1>
    <p class="hero__subtitle">Transmissions for those who answer the call.</p>
    <div class="hero__ctas">
      <button id="primaryCta" class="btn btn--gold">Connect Wallet</button>
      <a href="#" class="btn btn--ghost">Browse Public Scrolls</a>
    </div>
  </section>

  <section id="accessBanner" class="access access--disconnected" role="status" aria-live="polite">
    <div class="access__icon" aria-hidden="true">üîí</div>
    <div class="access__text">
      <strong>Access Locked.</strong> Connect wallet to check gate status.
    </div>
    <div class="access__meta">
      Chain: <span class="badge">BNB Smart Chain</span> ‚Ä¢ Gate: <span class="badge">Diamond Core NFT (ID 3)</span>
    </div>
  </section>

  <main class="main">
    <h2 class="section-title">Latest Scroll</h2>

    <article class="scroll">
      <div class="scroll__frame">
        <div class="scroll__top">
          <span class="pill pill--rarity">Diamond</span>
          <span class="pill pill--len">12 min</span>
          <span class="pill pill--drop">Drop #07</span>
        </div>

        <h3 class="scroll__title">Keys of Sovereignty: The Unsealing</h3>
        <p class="scroll__tease">Not for the curious‚Äîonly the called.</p>

        <div class="scroll__meta">
          <span class="meta">Updated: 2025-09-18</span>
          <span class="meta">Category: Prophecy</span>
        </div>

        <div class="scroll__lock">
          <span class="lock__icon" aria-hidden="true">üîí</span>
          <span class="lock__text">Gate required: Diamond Core NFT</span>
        </div>

        <div class="scroll__actions">
          <button class="btn btn--gold" disabled aria-disabled="true">Unseal the Scroll</button>
          <button class="btn btn--ghost" id="learnMintBtn">Learn How to Mint</button>
        </div>
      </div>
    </article>
  </main>

  <footer class="footer">
    <span class="footer__text">¬© Tamaquah Nation ‚Ä¢ KLY ‚Ä¢ The Call Continues</span>
  </footer>

  <!-- ethers v5 CDN -->
  <script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>
  <script>
    // CONFIG
    const CONFIG = {
      chainIdHex: '0x38', // 56
      chainIdDec: 56,
      chainName: 'BNB Smart Chain',
      rpcUrl: 'https://bsc-dataseed.binance.org/',
      blockExplorer: 'https://bscscan.com',
      klyErc20: '0x2e4fEB2Fe668c8Ebe84f19e6c8fE8Cf8131B4E52',
      diamondNft721: '0xDA76d35742190283E340dbeE2038ecc978a56950',
      diamondTokenId: '3',
      selectors: { walletBtn:'#walletBtn', primaryCta:'#primaryCta', accessBanner:'#accessBanner' }
    };

    const ERC20_ABI = [
      "function balanceOf(address owner) view returns (uint256)",
      "function decimals() view returns (uint8)",
      "function symbol() view returns (string)"
    ];
    const ERC721_ABI = [
      "function ownerOf(uint256 tokenId) view returns (address)",
      "function balanceOf(address owner) view returns (uint256)"
    ];

    const els = {
      walletBtn: document.querySelector(CONFIG.selectors.walletBtn),
      primaryCta: document.querySelector(CONFIG.selectors.primaryCta),
      accessBanner: document.querySelector(CONFIG.selectors.accessBanner),
      learnMintBtn: document.getElementById('learnMintBtn'),
      klyBadge: null
    };

    let state = {
      connected:false, account:null, hasDiamondCore:false,
      kly:{ balance:null, symbol:'KLY', decimals:18 }
    };

    function short(a){ return a ? a.slice(0,6)+'‚Ä¶'+a.slice(-4) : ''; }
    function setStatus(icon, html, cls){
      els.accessBanner.className = 'access ' + (cls || '');
      els.accessBanner.querySelector('.access__icon').textContent = icon;
      els.accessBanner.querySelector('.access__text').innerHTML = html;
    }
    function assertEthereum(){
      if(!window.ethereum){ alert('No wallet found. Install MetaMask or use a Web3-enabled browser.'); return false; }
      return true;
    }
    async function switchToBsc(){
      try{
        await window.ethereum.request({ method:'wallet_switchEthereumChain', params:[{ chainId: CONFIG.chainIdHex }] });
      }catch(e){
        if(e.code === 4902){
          await window.ethereum.request({
            method:'wallet_addEthereumChain',
            params:[{ chainId:CONFIG.chainIdHex, chainName:CONFIG.chainName,
              nativeCurrency:{ name:'BNB', symbol:'BNB', decimals:18 },
              rpcUrls:[CONFIG.rpcUrl], blockExplorerUrls:[CONFIG.blockExplorer] }]
          });
        } else { throw e; }
      }
    }
    async function ensureBsc(){
      const cur = await window.ethereum.request({ method:'eth_chainId' });
      if(cur.toLowerCase() !== CONFIG.chainIdHex.toLowerCase()) await switchToBsc();
    }
    function getProvider(){ return new ethers.providers.Web3Provider(window.ethereum); }

    async function connect(){
      if(!assertEthereum()) return;
      await ensureBsc();
      const accounts = await window.ethereum.request({ method:'eth_requestAccounts' });
      state.account = accounts[0]; state.connected = true;

      window.ethereum.removeAllListeners && window.ethereum.removeAllListeners('accountsChanged');
      window.ethereum.on && window.ethereum.on('accountsChanged', (accs)=>{ if(accs.length===0){disconnect();} else {state.account=accs[0]; refresh();}});
      window.ethereum.on && window.ethereum.on('chainChanged', ()=> location.reload());

      await refresh();
    }
    async function disconnect(){
      state.connected=false; state.account=null; state.hasDiamondCore=false; state.kly.balance=null; render();
    }
    async function refresh(){
      try{
        await Promise.all([checkDiamondCore(), readKlyBalance()]);
      }catch(err){ console.error(err); }
      render();
    }

    async function checkDiamondCore(){
      try{
        const provider = getProvider();
        const nft = new ethers.Contract(CONFIG.diamondNft721, ERC721_ABI, provider);
        const owner = await nft.ownerOf(CONFIG.diamondTokenId);
        state.hasDiamondCore = owner.toLowerCase() === state.account.toLowerCase();
      }catch(err){
        // fallback: any NFT balance
        try{
          const provider = getProvider();
          const nft = new ethers.Contract(CONFIG.diamondNft721, ERC721_ABI, provider);
          const bal = await nft.balanceOf(state.account);
          state.hasDiamondCore = bal && bal.gt(0);
        }catch(e){ state.hasDiamondCore=false; }
      }
    }

    async function readKlyBalance(){
      try{
        const provider = getProvider();
        const erc20 = new ethers.Contract(CONFIG.klyErc20, ERC20_ABI, provider);
        const [raw, decimals, symbol] = await Promise.all([
          erc20.balanceOf(state.account),
          erc20.decimals(),
          erc20.symbol().catch(()=> 'KLY')
        ]);
        state.kly.decimals = decimals; state.kly.symbol = symbol || 'KLY';
        state.kly.balance = Number(ethers.utils.formatUnits(raw, decimals));
      }catch(err){ state.kly.balance=null; }
    }

    function render(){
      // buttons
      els.walletBtn.textContent = state.connected ? `Disconnect (${short(state.account)})` : 'Connect Wallet';
      els.primaryCta.textContent = state.connected ? 'Check Access' : 'Connect Wallet';

      // banner
      if(!state.connected){
        setStatus('üîí', '<strong>Access Locked.</strong> Connect wallet to check gate status.');
      } else if(!state.hasDiamondCore){
        setStatus('üóùÔ∏è', `<strong>Connected ${short(state.account)}.</strong> Gate required: Diamond Core NFT (ID ${CONFIG.diamondTokenId}).`);
      } else {
        setStatus('‚úÖ', `<strong>Access Granted.</strong> Diamond Core verified for ${short(state.account)}.`, 'access--ok');
      }

      // card controls
      const lock = document.querySelector('.scroll__lock');
      const actionBtn = document.querySelector('.scroll__actions .btn--gold');
      const learnBtn = els.learnMintBtn;

      if(state.connected && state.hasDiamondCore){
        if(lock) lock.style.display = 'none';
        if(actionBtn){ actionBtn.disabled=false; actionBtn.removeAttribute('aria-disabled'); actionBtn.textContent='Unseal the Scroll'; }
        if(learnBtn) learnBtn.style.display='none';
      } else {
        if(lock) lock.style.display = 'flex';
        if(actionBtn){
          actionBtn.disabled=true; actionBtn.setAttribute('aria-disabled','true');
          actionBtn.textContent = state.connected ? 'Locked (Need Diamond Core)' : 'Unseal the Scroll';
        }
        if(learnBtn) learnBtn.style.display='inline-flex';
      }

      // KLY badge
      const meta = document.querySelector('.access__meta');
      if(state.connected){
        if(!document.getElementById('klyBadge')){
          const s = document.createElement('span'); s.className='badge'; s.id='klyBadge';
          meta && meta.appendChild(document.createTextNode(' ‚Ä¢ ')); meta && meta.appendChild(s);
        }
        const v = state.kly.balance==null ? '‚Äî' : `${state.kly.balance.toFixed(2)} ${state.kly.symbol}`;
        document.getElementById('klyBadge').textContent = `KLY: ${v}`;
      }else{
        const b = document.getElementById('klyBadge'); if(b) b.remove();
      }
    }

    // events
    document.getElementById('walletBtn').addEventListener('click', async () => {
      if(state.connected){ await disconnect(); } else { await connect(); }
    });
    document.getElementById('primaryCta').addEventListener('click', async () => {
      if(!state.connected){ await connect(); } else { await refresh(); }
    });
    document.getElementById('learnMintBtn').addEventListener('click', () => {
      window.open('https://bscscan.com/address/0xDA76d35742190283E340dbeE2038ecc978a56950#writeContract', '_blank');
    });

    // initial
    render();
  </script>

  <style>@keyframes slowspin { from{transform:rotate(0)} to{transform:rotate(360deg)} }</style>
</body>
</html>
