<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ascension Portal | KLY Token</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
:root {
  --neon-green: #00ffe7;
  --neon-pink: #ff00aa;
  --neon-purple: #aa00ff;
  --neon-blue: #00aaff;
  --dark-bg: #000000;
  --darker-bg: #0a0a0a;
  --panel-bg: rgba(0, 0, 0, 0.85);
  --text-primary: #e0e0e0;
  --text-secondary: #888888;
  --glow-green: 0 0 10px var(--neon-green);
  --glow-pink: 0 0 10px var(--neon-pink);
  --transition-medium: 0.3s;
}

body {
  font-family: 'Orbitron', sans-serif;
  background: var(--dark-bg);
  color: var(--text-primary);
  margin: 0;
  padding: 0;
  min-height: 100vh;
  display: flex;
  flex-direction: column;
}

header {
  background: var(--panel-bg);
  border-bottom: 1px solid var(--neon-green);
  box-shadow: var(--glow-green);
  padding: 1rem 2rem;
  position: relative;
  z-index: 100;
}

.logo {
  font-size: 1.8rem;
  font-weight: 900;
  color: var(--neon-green);
  text-shadow: var(--glow-green);
  letter-spacing: 2px;
}

.portal-container {
  max-width: 1200px;
  margin: 2rem auto;
  padding: 2rem;
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 2rem;
}

.portal-header {
  grid-column: 1 / -1;
  text-align: center;
  margin-bottom: 2rem;
}

.portal-header h1 {
  font-size: 3rem;
  background: linear-gradient(90deg, var(--neon-green), var(--neon-purple));
  -webkit-background-clip: text;
  background-clip: text;
  color: transparent;
  text-shadow: 0 0 20px rgba(0, 255, 231, 0.5);
  margin-bottom: 1rem;
}

.portal-header p {
  font-size: 1.2rem;
  color: var(--text-secondary);
  max-width: 800px;
  margin: 0 auto;
}

.stake-panel, .nft-panel {
  background: var(--panel-bg);
  border: 1px solid rgba(0, 255, 231, 0.2);
  border-radius: 16px;
  padding: 2rem;
  box-shadow: 0 0 20px rgba(0, 255, 231, 0.1);
  transition: all var(--transition-medium) ease;
  position: relative;
  overflow: hidden;
}

.stake-panel:hover, .nft-panel:hover {
  transform: translateY(-5px);
  box-shadow: 0 10px 30px rgba(0, 255, 231, 0.3);
}

.panel-title {
  font-size: 1.5rem;
  color: var(--neon-green);
  margin-bottom: 1.5rem;
  position: relative;
  display: inline-block;
}

.panel-title::after {
  content: '';
  position: absolute;
  bottom: -5px;
  left: 0;
  width: 100%;
  height: 2px;
  background: var(--neon-green);
}

.stats-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 1rem;
  margin-bottom: 2rem;
}

.stat-item {
  background: rgba(0, 0, 0, 0.5);
  border: 1px solid var(--neon-green);
  border-radius: 8px;
  padding: 1rem;
}

.stat-label {
  color: var(--text-secondary);
  font-size: 0.9rem;
  margin-bottom: 0.5rem;
}

.stat-value {
  font-size: 1.2rem;
  color: var(--neon-green);
  font-weight: bold;
}

.wallet-btn {
  width: 100%;
  padding: 1rem;
  background: linear-gradient(135deg, var(--neon-green), var(--neon-purple));
  color: #000;
  border: none;
  border-radius: 8px;
  font-family: 'Orbitron', sans-serif;
  font-weight: bold;
  cursor: pointer;
  transition: all var(--transition-medium) ease;
  margin-bottom: 1.5rem;
  box-shadow: 0 0 15px var(--neon-green);
}

.wallet-btn:hover {
  transform: translateY(-3px);
  box-shadow: 0 0 25px var(--neon-purple);
}

.stake-form {
  margin-top: 1.5rem;
}

.input-group {
  margin-bottom: 1.5rem;
}

.input-group label {
  display: block;
  margin-bottom: 0.5rem;
  color: var(--text-secondary);
}

.input-group input {
  width: 100%;
  padding: 0.8rem;
  background: rgba(0, 0, 0, 0.5);
  border: 1px solid var(--neon-green);
  border-radius: 8px;
  color: var(--text-primary);
  font-family: 'Orbitron', sans-serif;
}

.action-btn {
  width: 100%;
  padding: 1rem;
  background: linear-gradient(135deg, var(--neon-green), var(--neon-pink));
  color: #000;
  border: none;
  border-radius: 8px;
  font-family: 'Orbitron', sans-serif;
  font-weight: bold;
  cursor: pointer;
  transition: all var(--transition-medium) ease;
  margin-top: 1rem;
  box-shadow: 0 0 15px var(--neon-green);
}

.action-btn:hover {
  transform: translateY(-3px);
  box-shadow: 0 0 25px var(--neon-pink);
}

.nft-display {
  background: rgba(0, 0, 0, 0.5);
  border: 1px solid var(--neon-green);
  border-radius: 8px;
  padding: 1.5rem;
  text-align: center;
  margin-bottom: 2rem;
  min-height: 200px;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
}

.nft-image {
  max-width: 150px;
  border-radius: 8px;
  margin-bottom: 1rem;
  box-shadow: 0 0 15px var(--neon-green);
}

.nft-name {
  font-size: 1.2rem;
  color: var(--neon-green);
}

@media (max-width: 768px) {
  .portal-container {
    grid-template-columns: 1fr;
    padding: 1rem;
  }
  
  .portal-header h1 {
    font-size: 2rem;
  }
}
  </style>
</head>
<body>
  <header>
    <div class="logo">KLY TOKEN</div>
  </header>

  <main>
    <div class="portal-container">
      <div class="portal-header">
        <h1>ASCENSION PORTAL</h1>
        <p>Stake KLY tokens, mint Ascenders NFTs, and unlock exclusive rewards.</p>
      </div>

      <div class="stake-panel">
        <h2 class="panel-title">STAKING VAULT</h2>
        
        <button class="wallet-btn" id="connectWallet">
          <i class="fas fa-wallet"></i> CONNECT WALLET
        </button>
        
        <div class="stats-grid">
          <div class="stat-item">
            <div class="stat-label">TVL</div>
            <div class="stat-value" id="tvlValue">1,250,000 KLY</div>
          </div>
          <div class="stat-item">
            <div class="stat-label">Your Staked</div>
            <div class="stat-value" id="stakedValue">0 KLY</div>
          </div>
          <div class="stat-item">
            <div class="stat-label">Daily Reward</div>
            <div class="stat-value" id="rewardValue">12.5 KLY</div>
          </div>
          <div class="stat-item">
            <div class="stat-label">APY</div>
            <div class="stat-value" id="apyValue">365%</div>
          </div>
        </div>
        
        <div class="stake-form">
          <div class="input-group">
            <label for="stakeAmount">Amount to Stake</label>
            <input type="number" id="stakeAmount" placeholder="Enter KLY amount">
          </div>
          <button class="action-btn" id="stakeBtn">
            <i class="fas fa-lock"></i> STAKE KLY
          </button>
        </div>
      </div>

      <div class="nft-panel">
        <h2 class="panel-title">ASCENDERS NFT</h2>
        
        <div class="nft-display">
          <img src="https://via.placeholder.com/150" alt="Ascender NFT" class="nft-image" id="nftImage">
          <div class="nft-name" id="nftName">Connect Wallet to View</div>
        </div>
        
        <div class="stats-grid">
          <div class="stat-item">
            <div class="stat-label">Total Minted</div>
            <div class="stat-value">1,025</div>
          </div>
          <div class="stat-item">
            <div class="stat-label">Mint Price</div>
            <div class="stat-value">500 KLY</div>
          </div>
        </div>
        
        <button class="action-btn" id="mintBtn">
          <i class="fas fa-plus-circle"></i> MINT ASCENDER
        </button>
      </div>
    </div>
  </main>

  <script src="https://cdn.jsdelivr.net/npm/web3@1.5.2/dist/web3.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@walletconnect/web3-provider@1.7.8/dist/umd/index.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/web3modal@1.9.7/dist/index.js"></script>
  <script>
    // Contract addresses
    const KLY_TOKEN = "0x2e4fEB2Fe668c8Ebe84f19e6c8fE8Cf8131B4E52";
    const STAKE_CONTRACT = "0xe9417Fbe4e1D1E70aaE00b76e9B54599707c49e0";
    const NFT_CONTRACT = "0xDA76d35742190283E340dbeE2038ecc978a56950";

    // Contract ABIs (simplified for example)
    const tokenABI = [
      {"constant":false,"inputs":[{"name":"spender","type":"address"},{"name":"amount","type":"uint256"}],"name":"approve","outputs":[{"name":"","type":"bool"}],"payable":false,"stateMutability":"nonpayable","type":"function"},
      {"constant":true,"inputs":[{"name":"account","type":"address"}],"name":"balanceOf","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"}
    ];
    
    const stakeABI = [
      {"constant":false,"inputs":[{"name":"_amount","type":"uint256"}],"name":"stake","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},
      {"constant":false,"inputs":[],"name":"claim","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},
      {"constant":true,"inputs":[{"name":"_user","type":"address"}],"name":"getUserStake","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"}
    ];
    
    const nftABI = [
      {"constant":false,"inputs":[{"name":"to","type":"address"},{"name":"uri","type":"string"}],"name":"mintTo","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},
      {"constant":true,"inputs":[{"name":"tokenId","type":"uint256"}],"name":"tokenURI","outputs":[{"name":"","type":"string"}],"payable":false,"stateMutability":"view","type":"function"}
    ];

    let web3;
    let web3Modal;
    let provider;
    let accounts;
    let klyContract;
    let stakeContract;
    let nftContract;

    // Initialize Web3Modal
    function initWeb3Modal() {
      const providerOptions = {
        walletconnect: {
          package: WalletConnectProvider,
          options: {
            rpc: {
              56: "https://bsc-dataseed.binance.org/"
            }
          }
        }
      };

      web3Modal = new Web3Modal({
        cacheProvider: true,
        providerOptions,
        theme: "dark"
      });
    }

    // Connect wallet
    async function connectWallet() {
      try {
        provider = await web3Modal.connect();
        web3 = new Web3(provider);
        
        // Get accounts
        accounts = await web3.eth.getAccounts();
        
        // Initialize contracts
        klyContract = new web3.eth.Contract(tokenABI, KLY_TOKEN);
        stakeContract = new web3.eth.Contract(stakeABI, STAKE_CONTRACT);
        nftContract = new web3.eth.Contract(nftABI, NFT_CONTRACT);
        
        // Update UI
        updateUI();
        
        // Set up event listeners
        provider.on("accountsChanged", () => window.location.reload());
        provider.on("chainChanged", () => window.location.reload());
        provider.on("disconnect", () => {
          web3Modal.clearCachedProvider();
          window.location.reload();
        });
        
      } catch (error) {
        console.error("Could not connect to wallet:", error);
      }
    }

    // Update UI with wallet data
    async function updateUI() {
      if (!accounts || accounts.length === 0) return;
      
      document.getElementById('connectWallet').textContent = accounts[0].slice(0, 6) + '...' + accounts[0].slice(-4);
      
      // Get staking data
      const stakedAmount = await stakeContract.methods.getUserStake(accounts[0]).call();
      document.getElementById('stakedValue').textContent = web3.utils.fromWei(stakedAmount, 'ether') + ' KLY';
      
      // Check for NFTs (simplified - would need proper NFT checking logic)
      checkNFTs();
    }

    // Stake KLY tokens
    async function stakeTokens() {
      if (!accounts || accounts.length === 0) {
        alert("Please connect your wallet first");
        return;
      }
      
      const amount = document.getElementById('stakeAmount').value;
      if (!amount || amount <= 0) {
        alert("Please enter a valid amount");
        return;
      }
      
      try {
        // Approve tokens first
        const amountWei = web3.utils.toWei(amount, 'ether');
        await klyContract.methods.approve(STAKE_CONTRACT, amountWei).send({ from: accounts[0] });
        
        // Then stake
        await stakeContract.methods.stake(amountWei).send({ from: accounts[0] });
        
        // Update UI
        updateUI();
        alert("Successfully staked " + amount + " KLY");
        
      } catch (error) {
        console.error("Staking failed:", error);
        alert("Staking failed: " + error.message);
      }
    }

    // Mint NFT
    async function mintNFT() {
      if (!accounts || accounts.length === 0) {
        alert("Please connect your wallet first");
        return;
      }
      
      try {
        // For demo purposes - would need actual minting logic
        document.getElementById('nftImage').src = "https://via.placeholder.com/150/00ffe7/000000?text=Ascender";
        document.getElementById('nftName').textContent = "Ascender #1025";
        
        alert("Minting successful! Your Ascender NFT has been added to your wallet.");
        
      } catch (error) {
        console.error("Minting failed:", error);
        alert("Minting failed: " + error.message);
      }
    }

    // Check for user's NFTs (simplified demo)
    function checkNFTs() {
      // In a real implementation, you would query the NFT contract for the user's tokens
      // For demo, we'll just show a placeholder
      document.getElementById('nftImage').src = "https://via.placeholder.com/150/00ffe7/000000?text=Ascender";
      document.getElementById('nftName').textContent = "Ascender #1025";
    }

    // Initialize when page loads
    window.addEventListener('load', async () => {
      initWeb3Modal();
      
      // Set up button event listeners
      document.getElementById('connectWallet').addEventListener('click', connectWallet);
      document.getElementById('stakeBtn').addEventListener('click', stakeTokens);
      document.getElementById('mintBtn').addEventListener('click', mintNFT);
      
      // Check if wallet is already connected
      if (web3Modal.cachedProvider) {
        await connectWallet();
      }
    });
  </script>
</body>
</html>
