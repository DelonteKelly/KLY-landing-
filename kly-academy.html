<!DOCTYPE html>
<html lang="en">
<head>
  <script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>KLY Academy Portal</title>
  <style>
    body {
      background-color: #000;
      color: #fff;
      font-family: 'Arial', sans-serif;
      margin: 0;
      padding: 0;
      text-align: center;
    }

    h1 {
      font-size: 2em;
      color: #0ff;
      margin-top: 30px;
      text-shadow: 0 0 10px #0ff;
    }

    .course-box, .codes-box {
      border: 1px solid #0ff;
      border-radius: 20px;
      margin: 20px auto;
      padding: 20px;
      width: 90%;
      max-width: 400px;
      background: linear-gradient(145deg, #111, #000);
      box-shadow: 0 0 25px #0ff;
    }

    .course-box h2, .codes-box h2 {
      color: #ff00cc;
      text-shadow: 0 0 8px #ff00cc;
    }

    .button {
      margin: 10px;
      padding: 15px 25px;
      border: none;
      border-radius: 12px;
      background: linear-gradient(to right, #00f0ff, #ff00cc);
      color: black;
      font-weight: bold;
      font-size: 1em;
      cursor: pointer;
      box-shadow: 0 0 10px #ff00cc;
    }

    .button:hover {
      opacity: 0.9;
    }

    p {
      color: #f0f0f0;
      font-size: 1em;
      margin-top: 20px;
    }

    .note {
      color: #ff00cc;
      font-size: 0.9em;
    }

    /* Module styles */
    .module-card {
      display: none;
      border: 1px solid #0ff;
      border-radius: 20px;
      margin: 20px auto;
      padding: 20px;
      width: 90%;
      max-width: 800px;
      background: linear-gradient(145deg, #111, #000);
      box-shadow: 0 0 25px #0ff;
      text-align: left;
    }

    .module-title {
      font-size: 1.5em;
      color: #0ff;
      margin-bottom: 20px;
      text-align: center;
      text-shadow: 0 0 8px #0ff;
    }

    .module-content h3 {
      color: #ff00cc;
      margin-top: 20px;
    }

    .module-next {
      color: #0ff;
      cursor: pointer;
      text-decoration: none;
      font-weight: bold;
    }

    .module-next:hover {
      text-decoration: underline;
    }

    #wallet-status {
      color: #ff00cc;
      margin-top: 10px;
    }

    #mint-status {
      margin-top: 1rem;
      color: #00ffe7;
      font-weight: bold;
    }

    .nav-button {
      margin: 10px;
      padding: 15px 25px;
      border: none;
      border-radius: 12px;
      background: linear-gradient(to right, #00f0ff, #ff00cc);
      color: black;
      font-weight: bold;
      font-size: 1em;
      cursor: pointer;
      box-shadow: 0 0 10px #ff00cc;
    }
  </style>
</head>
<body>

  <h1>KLY Beginner DeFi Course</h1>
  <div class="course-box">
    <button class="button">Module 1</button>
    <button class="button">Module 2</button>
    <button class="button">Module 3</button>
    <button class="button">Module 4</button>
    <button class="button">Module 5</button>
    <p class="note">This course is only available to wallets holding 500+ KLY tokens.</p>
    <button id="connect-btn" class="button" onclick="connectWallet()">Connect Wallet to Unlock Course</button>
    <div id="wallet-status"></div>
  </div>

  <div class="codes-box">
    <h2>Spiritual Wealth Codes</h2>
    <p>A 7-Code transmission of wealth remembrance from your Higher Self. No token required. Fully open scroll.</p>
    <button class="button" onclick="window.location.href='Spiritual%20wealth%20codes.html'">✨ Enter Spiritual Wealth Codes ✨</button>
  </div>

<div id="course-wrapper" style="display: none;">

  <!-- MODULE 1 -->
  <div id="module1" class="module-card">
    <div class="module-title">Module 1: What is DeFi?</div>
    <div class="module-content">
      <h3>Overview</h3>
      <p>Decentralized Finance (DeFi) is a groundbreaking evolution of traditional finance. Instead of relying on banks or intermediaries, DeFi uses blockchain technology to give you direct, secure, and transparent control over your finances.</p>

      <h3>Objectives</h3>
      <ul>
        <li>Understand the fundamentals of DeFi</li>
        <li>Explore the benefits of decentralization</li>
        <li>Recognize the risks and responsibilities involved</li>
      </ul>

      <h3>Core Concepts</h3>
      <ul>
        <li><strong>Blockchain:</strong> A secure, transparent ledger that records every transaction.</li>
        <li><strong>Smart Contracts:</strong> Self-executing digital contracts coded directly into the blockchain.</li>
        <li><strong>Non-Custodial:</strong> Full ownership of your funds — no banks, no middlemen.</li>
      </ul>

      <h3>Why It Matters</h3>
      <p>Traditional finance is often slow, costly, and exclusive. DeFi removes gatekeepers, lowers fees, and democratizes access to financial tools — all you need is a crypto wallet.</p>

      <h3>Real-World Example</h3>
      <p>Imagine lending crypto to someone in another country and earning interest — instantly, without banks or paperwork. That’s DeFi in action.</p>

      <h3>KLY Integration</h3>
      <p>KLY is a utility token designed to power DeFi education and access. Holding KLY unlocks premium content, platform features, and DAO governance rights.</p>

      <blockquote>“DeFi is finance by the people, for the people.”</blockquote>

      <div class="module-navigation">
        <a class="module-next" onclick="showModule('module2')">Next: Setting Up Your Wallet</a>
      </div>
    </div>
  </div>

  <div id="module2" class="module-card">
    <div class="module-title">Module 2: Setting Up Your Wallet</div>
    <div class="module-content">
      <h3>Overview</h3>
      <p>Your DeFi wallet is your digital passport. It stores your assets, connects you to dApps, and empowers you to interact directly with Web3 platforms. In this module, you'll learn how to create, secure, and fund your wallet.</p>

      <h3>Objectives</h3>
      <ul>
        <li>Understand what DeFi wallets do</li>
        <li>Create and back up your wallet securely</li>
        <li>Fund and connect your wallet to the DeFi ecosystem</li>
      </ul>

      <h3>Step-by-Step: Create Your Wallet</h3>

      <h4>Step 1: Choose a Wallet</h4>
      <ul>
        <li><strong>MetaMask:</strong> Leading browser/mobile wallet for Ethereum and BNB Chain.</li>
        <li><strong>Trust Wallet:</strong> Mobile-first wallet supporting multiple blockchains.</li>
        <li><strong>Coinbase Wallet:</strong> Ideal for beginners — not the same as Coinbase Exchange.</li>
      </ul>

      <h4>Step 2: Install the Wallet</h4>
      <p>Use official sources only:</p>
      <ul>
        <li><a href="https://metamask.io" target="_blank">MetaMask.io</a></li>
        <li>Or download from the App Store / Google Play</li>
      </ul>

      <h4>Step 3: Backup Your Secret Phrase</h4>
      <p>Write down your 12- or 24-word recovery phrase during setup. Never store it online or share it. It’s the master key to your funds.</p>

      <h4>Step 4: Fund Your Wallet</h4>
      <ul>
        <li>Transfer BNB (for BNB Chain) or ETH (for Ethereum) from a centralized exchange</li>
        <li>Receive crypto directly from another wallet</li>
      </ul>

      <h4>Step 5: Connect to a dApp</h4>
      <p>Visit any DeFi-enabled site (like <strong>kellylegacyestates.com</strong>) and click <em>"Connect Wallet"</em>. Confirm the connection in your wallet app.</p>

      <h3>Wallet Safety Tips</h3>
      <ul>
        <li>Verify URLs before connecting</li>
        <li>Use a hardware wallet for large balances</li>
        <li>Enable password and biometric protection</li>
        <li>Never share your recovery phrase</li>
      </ul>

      <h3>Real-World Example</h3>
      <p>John installs MetaMask, sends $100 in BNB from Binance, and connects to PancakeSwap. He’s trading within minutes — no banks, no delays.</p>

      <h3>KLY Integration</h3>
      <p>To unlock advanced KLY features like certificate minting and governance, you’ll need a wallet with KLY tokens connected to the platform.</p>

      <div class="module-navigation">
        <a class="module-next" onclick="showModule('module3')">Next: Using Decentralized Exchanges</a>
      </div>
    </div>
  </div>
  
  <div id="module3" class="module-card">
    <div class="module-title">Module 3: Using Decentralized Exchanges (DEXs)</div>
    <div class="module-content">

      <h3>Overview</h3>
      <p>Decentralized Exchanges (DEXs) allow you to trade crypto directly from your wallet — no registration, no middlemen. These platforms use smart contracts to enable peer-to-peer trading securely and transparently.</p>

      <h3>Objectives</h3>
      <ul>
        <li>Understand how DEXs differ from centralized exchanges</li>
        <li>Learn how to swap tokens using your wallet</li>
        <li>Explore top DEX platforms on Ethereum and BNB Chain</li>
      </ul>

      <h3>How to Trade on a DEX</h3>

      <h4>Step 1: Connect Your Wallet</h4>
      <p>Go to a trusted DEX like <a href="https://pancakeswap.finance" target="_blank">PancakeSwap</a> or <a href="https://uniswap.org" target="_blank">Uniswap</a>. Click “Connect Wallet” and approve the request from your wallet app.</p>

      <h4>Step 2: Select Tokens</h4>
      <p>Choose the crypto you want to swap (e.g., BNB) and the one you want to receive (e.g., KLY). Enter the amount.</p>

      <h4>Step 3: Review and Confirm</h4>
      <p>Click “Swap” and approve the transaction in your wallet. Pay the small gas fee, and your tokens will appear in your wallet within seconds.</p>

      <h3>Popular DEX Platforms</h3>
      <ul>
        <li><a href="https://pancakeswap.finance" target="_blank">PancakeSwap</a> – Best for BNB Chain</li>
        <li><a href="https://uniswap.org" target="_blank">Uniswap</a> – Pioneer DEX on Ethereum</li>
        <li><a href="https://app.1inch.io" target="_blank">1inch</a> – Aggregates best rates across multiple DEXs</li>
      </ul>

      <h3>What You’ll Need</h3>
      <ul>
        <li>A DeFi wallet (e.g., MetaMask or Trust Wallet)</li>
        <li>BNB or ETH to pay gas fees</li>
        <li>The crypto you want to trade</li>
      </ul>

      <h3>Benefits of DEXs</h3>
      <ul>
        <li>Full control of your funds — no third-party custody</li>
        <li>No KYC or personal data required</li>
        <li>Access to new and community-driven tokens like KLY</li>
      </ul>

      <h3>Real-World Example</h3>
      <p>Jane connects Trust Wallet to PancakeSwap, swaps BNB for KLY, and receives her tokens in real time — no signup, no wait.</p>

      <h3>KLY Integration</h3>
      <p>You can buy KLY using BNB on PancakeSwap. Always verify the official token address from the KLY dashboard before swapping.</p>

      <div class="module-navigation">
        <a class="module-next" onclick="showModule('module4')">Next: Earning with DeFi</a>
      </div>
    </div>
  </div>
  
  <div id="module4" class="module-card">
    <div class="module-title">Module 4: Earning with DeFi (Yield & Lending)</div>
    <div class="module-content">

      <h3>Overview</h3>
      <p>DeFi enables passive income through staking, lending, and yield farming — allowing you to earn without actively trading. This module breaks down each method and how to get started safely.</p>

      <h3>Objectives</h3>
      <ul>
        <li>Understand how DeFi generates passive income</li>
        <li>Compare staking, lending, and yield farming</li>
        <li>Identify top platforms to start earning</li>
      </ul>

      <h3>1. Staking</h3>
      <p>Lock your tokens in a smart contract to earn rewards. You help secure the network or support a protocol while earning more of the same token.</p>
      <ul>
        <li><strong>Example:</strong> Stake KLY to earn additional KLY</li>
        <li><strong>Platforms:</strong> Kelly Legacy Platform, PancakeSwap</li>
      </ul>

      <h3>2. Lending</h3>
      <p>Deposit crypto into a lending pool where borrowers pay interest. You earn that interest passively.</p>
      <ul>
        <li><strong>Example:</strong> Lend BUSD on Venus to earn up to 12% APY</li>
        <li><strong>Assets:</strong> BUSD, USDT, BNB, ETH</li>
      </ul>

      <h3>3. Yield Farming</h3>
      <p>Provide liquidity to a DEX (by pairing two tokens), then earn trading fees and bonus tokens. This is higher risk but can generate higher returns.</p>
      <ul>
        <li><strong>Example:</strong> Add KLY/USDT liquidity to PancakeSwap</li>
        <li><strong>Note:</strong> Be aware of impermanent loss</li>
      </ul>

      <h3>Top Platforms</h3>
      <ul>
        <li><a href="https://app.venus.io" target="_blank">Venus</a> – Lending on BNB Chain</li>
        <li><a href="https://pancakeswap.finance" target="_blank">PancakeSwap</a> – Staking and LP rewards</li>
        <li><a href="https://aave.com" target="_blank">Aave</a> – Lending on Ethereum and Polygon</li>
      </ul>

      <h3>Tips for Earning Safely</h3>
      <ul>
        <li>Start small and test the platform</li>
        <li>Only use trusted, audited platforms</li>
        <li>Track your rewards and set goals</li>
      </ul>

      <h3>Real-World Example</h3>
      <p>Marcus stakes 5,000 KLY and earns 250 KLY in rewards after 30 days — no trading required.</p>

      <h3>KLY Integration</h3>
      <p>Use the Liberty Pool on PancakeSwap to farm KLY/USDT LP tokens. Staking also grants governance rights in the KLY DAO.</p>

      <div class="module-navigation">
        <a class="module-next" onclick="showModule('module5')">Next: DeFi Safety & Strategy</a>
      </div>
    </div>
  </div>
  
  <div id="module5" class="module-card">
    <div class="module-title">Module 5: DeFi Safety & Long-Term Strategy</div>
    <div class="module-content">

      <h3>Overview</h3>
      <p>With great freedom comes great responsibility. This module helps you protect your assets, avoid common scams, and build a smart, sustainable crypto strategy.</p>

      <h3>Objectives</h3>
      <ul>
        <li>Learn the major risks in DeFi</li>
        <li>Practice wallet safety and protection</li>
        <li>Build a smart, long-term investment strategy</li>
      </ul>

      <h3>Common Risks</h3>
      <ul>
        <li><strong>Rugpulls:</strong> When developers abandon a project after draining funds</li>
        <li><strong>Phishing:</strong> Fake links and impostor sites tricking users</li>
        <li><strong>Smart Contract Bugs:</strong> Code flaws hackers can exploit</li>
        <li><strong>Impermanent Loss:</strong> Value loss from providing liquidity</li>
      </ul>

      <h3>Security Best Practices</h3>
      <ul>
        <li>Bookmark trusted platforms — avoid random links</li>
        <li>Never share your seed phrase — ever</li>
        <li>Use hardware wallets for high-value holdings</li>
        <li>Use “burner wallets” to test new dApps</li>
      </ul>

      <h3>Long-Term Wealth Strategy</h3>
      <ul>
        <li><strong>Diversify:</strong> Spread risk across assets and protocols</li>
        <li><strong>Reinvest:</strong> Compound your yield over time</li>
        <li><strong>Take Profits:</strong> Secure gains into stablecoins or move to cold storage</li>
        <li><strong>Stay Informed:</strong> Follow news, audits, and governance changes</li>
      </ul>

      <h3>KLY Wealth Blueprint</h3>
      <p>After completing this course, you can stake KLY, mint your NFT Certificate, and even launch your own project via the KLY Launchpad. Education is just the beginning.</p>

      <blockquote style="border-left: 4px solid #00ffe7; padding-left: 1rem; margin-top: 2rem; color: #aaa;">
        “In DeFi, the most powerful strategy is education + protection.”
      </blockquote>

      <div class="module-navigation">
        <a class="module-next" onclick="showModule('module1')">Return to Module 1</a>
      </div>
    </div>
  </div>

</div>
    <div style="text-align: center; margin-top: 2.5rem;">
      <button class="nav-button" onclick="mintCertificate()">Mint NFT Certificate</button>
      <p id="mint-status"></p>
    </div>
  </div>

  <script>
    // Contract addresses and ABIs
    const KLY_TOKEN_ADDRESS = "0x2e4fEB2Fe668c8Ebe84f19e6c8fE8Cf8131B4E52";
    const NFT_CONTRACT_ADDRESS = "0xc1a2E9A475779EfD04247EA473638717E26cd5C5";

    const KLY_TOKEN_ABI = [
      "function balanceOf(address) view returns (uint256)",
      "function decimals() view returns (uint8)"
    ];

    const NFT_CONTRACT_ABI = [
      "function mintTo(address to, string memory uri) public"
    ];

    // Global variables
    let provider, signer, userAddress;
    const connectBtn = document.getElementById('connect-btn');
    const walletStatus = document.getElementById('wallet-status');
    const courseWrapper = document.getElementById('course-wrapper');

    // Connect wallet function
    async function connectWallet() {
      if (typeof window.ethereum === 'undefined') {
        walletStatus.textContent = "MetaMask not detected. Please install it first.";
        return;
      }

      try {
        connectBtn.textContent = "Connecting...";
        walletStatus.textContent = "";
        
        // Request account access
        provider = new ethers.providers.Web3Provider(window.ethereum);
        await provider.send("eth_requestAccounts", []);
        signer = provider.getSigner();
        userAddress = await signer.getAddress();
        
        // Shorten address for display
        const shortAddress = `${userAddress.substring(0, 6)}...${userAddress.substring(38)}`;
        walletStatus.textContent = `Connected: ${shortAddress}`;
        
        // Check KLY balance
        const klyContract = new ethers.Contract(KLY_TOKEN_ADDRESS, KLY_TOKEN_ABI, provider);
        const rawBalance = await klyContract.balanceOf(userAddress);
        const decimals = await klyContract.decimals();
        const adjustedBalance = parseFloat(ethers.utils.formatUnits(rawBalance, decimals));
        
        if (adjustedBalance >= 500) {
          // Grant access to course
          connectBtn.style.display = 'none';
          document.querySelector('.course-box p.note').style.display = 'none';
          courseWrapper.style.display = 'block';
          showModule('module1');
        } else {
          walletStatus.textContent = `Insufficient KLY balance: ${adjustedBalance.toFixed(2)}/500 required`;
        }
      } catch (error) {
        console.error("Wallet connection error:", error);
        walletStatus.textContent = error.code === 4001 
          ? "Connection rejected by user" 
          : "Failed to connect wallet";
      } finally {
        connectBtn.textContent = "Connect Wallet to Unlock Course";
      }
    }

    // Mint certificate function
    async function mintCertificate() {
      if (!signer) {
        alert("Please connect your wallet first");
        return;
      }

      try {
        document.getElementById("mint-status").textContent = "Minting in progress...";
        
        const contract = new ethers.Contract(NFT_CONTRACT_ADDRESS, NFT_CONTRACT_ABI, signer);
        const tx = await contract.mintTo(
          userAddress, 
          "ipfs://bafybeihkmkaf2mgx7xkrnkhmzd2uvhr6ddgj6z3vkqcgnvlaa3z7x263r4"
        );
        
        await tx.wait();
        document.getElementById("mint-status").textContent = "Certificate Minted Successfully!";
      } catch (error) {
        console.error("Minting error:", error);
        document.getElementById("mint-status").textContent = "Minting failed. Please try again.";
      }
    }

    // Show module function
    function showModule(moduleId) {
      document.querySelectorAll('.module-card').forEach(card => {
        card.style.display = 'none';
      });
      document.getElementById(moduleId).style.display = 'block';
    }

    // Event listeners
    window.addEventListener('load', async () => {
      if (window.ethereum) {
        // Check if already connected
        const accounts = await window.ethereum.request({ method: 'eth_accounts' });
        if (accounts.length > 0) {
          await connectWallet();
        }
        
        // Listen for account changes
        window.ethereum.on('accountsChanged', (accounts) => {
          if (accounts.length === 0) {
            // Wallet disconnected
            connectBtn.style.display = 'block';
            document.querySelector('.course-box p.note').style.display = 'block';
            courseWrapper.style.display = 'none';
            walletStatus.textContent = "Wallet disconnected";
          } else {
            // Account changed
            connectWallet();
          }
        });
        
        // Listen for chain changes
        window.ethereum.on('chainChanged', () => {
          window.location.reload();
        });
      }
    });

    // Make functions available globally
    window.connectWallet = connectWallet;
    window.mintCertificate = mintCertificate;
    window.showModule = showModule;
  </script>
</body>
</html>
