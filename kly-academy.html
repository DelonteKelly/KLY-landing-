<!DOCTYPE html>
<html lang="en">
<head>
  <script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>KLY Academy Portal</title>
  <style>
    body {
      background-color: #000;
      color: #fff;
      font-family: 'Arial', sans-serif;
      margin: 0;
      padding: 0;
      text-align: center;
    }

    h1 {
      font-size: 2em;
      color: #0ff;
      margin-top: 30px;
      text-shadow: 0 0 10px #0ff;
    }

    .course-box, .codes-box {
      border: 1px solid #0ff;
      border-radius: 20px;
      margin: 20px auto;
      padding: 20px;
      width: 90%;
      max-width: 400px;
      background: linear-gradient(145deg, #111, #000);
      box-shadow: 0 0 25px #0ff;
    }

    .course-box h2, .codes-box h2 {
      color: #ff00cc;
      text-shadow: 0 0 8px #ff00cc;
    }

    .button {
      margin: 10px;
      padding: 15px 25px;
      border: none;
      border-radius: 12px;
      background: linear-gradient(to right, #00f0ff, #ff00cc);
      color: black;
      font-weight: bold;
      font-size: 1em;
      cursor: pointer;
      box-shadow: 0 0 10px #ff00cc;
    }

    .button:hover {
      opacity: 0.9;
    }

    p {
      color: #f0f0f0;
      font-size: 1em;
      margin-top: 20px;
    }

    .note {
      color: #ff00cc;
      font-size: 0.9em;
    }

    /* Module styles */
    .module-card {
      display: none;
      border: 1px solid #0ff;
      border-radius: 20px;
      margin: 20px auto;
      padding: 20px;
      width: 90%;
      max-width: 800px;
      background: linear-gradient(145deg, #111, #000);
      box-shadow: 0 0 25px #0ff;
      text-align: left;
    }

    .module-title {
      font-size: 1.5em;
      color: #0ff;
      margin-bottom: 20px;
      text-align: center;
      text-shadow: 0 0 8px #0ff;
    }

    .module-content h3 {
      color: #ff00cc;
      margin-top: 20px;
    }

    .module-next {
      color: #0ff;
      cursor: pointer;
      text-decoration: none;
      font-weight: bold;
    }

    .module-next:hover {
      text-decoration: underline;
    }

    #wallet-status {
      color: #ff00cc;
      margin-top: 10px;
    }

    #mint-status {
      margin-top: 1rem;
      color: #00ffe7;
      font-weight: bold;
    }

    .nav-button {
      margin: 10px;
      padding: 15px 25px;
      border: none;
      border-radius: 12px;
      background: linear-gradient(to right, #00f0ff, #ff00cc);
      color: black;
      font-weight: bold;
      font-size: 1em;
      cursor: pointer;
      box-shadow: 0 0 10px #ff00cc;
    }
  </style>
</head>
<body>

  <h1>KLY Beginner DeFi Course</h1>
  <div class="course-box">
    <button class="button">Module 1</button>
    <button class="button">Module 2</button>
    <button class="button">Module 3</button>
    <button class="button">Module 4</button>
    <button class="button">Module 5</button>
    <p class="note">This course is only available to wallets holding 500+ KLY tokens.</p>
    <button id="connect-btn" class="button" onclick="connectWallet()">Connect Wallet to Unlock Course</button>
    <div id="wallet-status"></div>
  </div>

  <div class="codes-box">
    <h2>Spiritual Wealth Codes</h2>
    <p>A 7-Code transmission of wealth remembrance from your Higher Self. No token required. Fully open scroll.</p>
    <button class="button" onclick="window.location.href='Spiritual%20wealth%20codes.html'">✨ Enter Spiritual Wealth Codes ✨</button>
  </div>

  <div id="course-wrapper" style="display: none;">
    <!-- MODULES -->
    <div id="module1" class="module-card">
      <div class="module-title">Module 1: What is DeFi?</div>
      <div class="module-content">
        <h3>Overview</h3>
        <p>Decentralized Finance (DeFi) is a revolutionary shift in the global financial system. Instead of relying on banks, DeFi uses blockchain technology to give you direct access to your money and financial tools.</p>

        <h3>Objectives</h3>
        <ul>
          <li>Understand what DeFi is and how it works</li>
          <li>Learn the benefits of decentralization</li>
          <li>Recognize the risks and responsibilities of DeFi</li>
        </ul>

        <h3>Core Concepts</h3>
        <ul>
          <li><strong>Blockchain:</strong> A digital ledger where every transaction is recorded transparently.</li>
          <li><strong>Smart Contracts:</strong> Self-executing agreements coded on the blockchain.</li>
          <li><strong>Non-Custodial:</strong> You control your funds — not a bank or third party.</li>
        </ul>

        <h3>Why DeFi Matters</h3>
        <p>Traditional finance is often restrictive, expensive, and slow. DeFi removes gatekeepers, reduces fees, and opens access to wealth tools for anyone with a crypto wallet.</p>

        <h3>Real-World Example</h3>
        <p>Imagine lending your crypto directly to someone in Brazil and earning interest — without a bank, credit check, or delay. DeFi makes this possible in seconds, globally.</p>

        <h3>KLY Integration Tip</h3>
        <p>KLY is a utility token built to empower DeFi education and wealth access. Holding KLY gives you access to private courses, governance, and platform rewards.</p>

        <blockquote>“DeFi is finance by the people, for the people.”</blockquote>

        <div style="text-align: center; margin-top: 2rem;">
          <a class="module-next" onclick="showModule('module2')">Next: Setting Up Your Wallet</a>
        </div>
      </div>
    </div>

    <div id="module2" class="module-card">
      <div class="module-title">Module 2: Setting Up Your Wallet</div>
      <div class="module-content">
        <h3>Overview</h3>
        <p>Your wallet is your passport to the DeFi world. It allows you to store crypto, connect to decentralized apps (dApps), and interact directly with the blockchain. In this module, you'll set up a wallet and learn how to use it securely.</p>

        <h3>Objectives</h3>
        <ul>
          <li>Understand the role of DeFi wallets</li>
          <li>Create and back up your first wallet</li>
          <li>Safely fund and connect your wallet to Web3 platforms</li>
        </ul>

        <h3>Step-by-Step: Creating Your Wallet</h3>

        <h4>Step 1: Choose a Wallet</h4>
        <ul>
          <li><strong>MetaMask:</strong> Popular browser and mobile wallet (supports Ethereum, BNB, etc.)</li>
          <li><strong>Trust Wallet:</strong> Mobile-first wallet with multi-chain support</li>
          <li><strong>Coinbase Wallet:</strong> Separate from Coinbase exchange, ideal for beginners</li>
        </ul>

        <h4>Step 2: Install the Wallet</h4>
        <p>Go to the official website or app store:</p>
        <ul>
          <li><a href="https://metamask.io" target="_blank">MetaMask.io</a></li>
          <li>Or download from Google Play / Apple App Store</li>
        </ul>

        <h4>Step 3: Save Your Secret Phrase</h4>
        <p>Write down the 12- or 24-word recovery phrase shown during setup. This is your backup key. If you lose it, you lose access. Never store it digitally or share it with anyone.</p>

        <h4>Step 4: Fund Your Wallet</h4>
        <ul>
          <li>Send BNB (for Binance Smart Chain) or ETH (for Ethereum) from a centralized exchange</li>
          <li>You can also receive funds from another wallet</li>
        </ul>

        <h4>Step 5: Connect to a dApp</h4>
        <p>Visit any Web3 platform like <strong>kellylegacyestates.com</strong> and click "Connect Wallet." Approve the prompt from your wallet app.</p>

        <h3>Best Practices for Wallet Security</h3>
        <ul>
          <li>Always check the website URL before connecting</li>
          <li>Use a hardware wallet for large amounts (e.g., Ledger or Trezor)</li>
          <li>Never share your seed phrase</li>
          <li>Enable password and biometric protection</li>
        </ul>

        <h3>Real-World Example</h3>
        <p>John sets up MetaMask, transfers $100 in BNB from Binance, and connects to PancakeSwap. Within minutes, he's swapping tokens and exploring the DeFi ecosystem — no bank needed.</p>

        <h3>KLY Integration Tip</h3>
        <p>To access advanced features on the KLY platform (like minting certificates or launching a token), you'll need a DeFi wallet with KLY tokens. Wallet connection is required to unlock your full course journey.</p>

        <div style="text-align: center; margin-top: 2rem;">
          <a class="module-next" onclick="showModule('module3')">Next: Using Decentralized Exchanges</a>
        </div>
      </div>
    </div>

    <div id="module3" class="module-card">
      <div class="module-title">Module 3: Using Decentralized Exchanges (DEXs)</div>
      <div class="module-content">

        <h3>Overview</h3>
        <p>Decentralized Exchanges (DEXs) allow users to trade cryptocurrencies without relying on a centralized intermediary. Trades happen directly between wallets using smart contracts, providing you full control and privacy.</p>

        <h3>Objectives</h3>
        <ul>
          <li>Understand how DEXs operate vs. centralized exchanges</li>
          <li>Learn to swap tokens securely using your wallet</li>
          <li>Explore top DEX platforms on BNB and Ethereum networks</li>
        </ul>

        <h3>Step-by-Step: Trading on a DEX</h3>

        <h4>Step 1: Connect Your Wallet</h4>
        <p>Visit a trusted DEX (e.g., PancakeSwap or Uniswap) and click <strong>"Connect Wallet."</strong> Approve the connection in your wallet app (like MetaMask).</p>

        <h4>Step 2: Choose Your Tokens</h4>
        <p>Select the token you want to swap (e.g., BNB) and the token you want to receive (e.g., KLY). Enter the amount.</p>

        <h4>Step 3: Review and Swap</h4>
        <p>Click <strong>"Swap"</strong> and confirm the transaction. Your wallet will prompt for gas fee approval. Once confirmed, the trade executes and tokens appear in your wallet.</p>

        <h3>Popular DEX Platforms</h3>
        <ul>
          <li><a href="https://pancakeswap.finance" target="_blank">PancakeSwap</a> – Best for BNB Chain (low fees)</li>
          <li><a href="https://uniswap.org" target="_blank">Uniswap</a> – Ethereum-based, pioneer of DEX trading</li>
          <li><a href="https://app.1inch.io" target="_blank">1inch</a> – Finds the best swap rates across multiple DEXs</li>
        </ul>

        <h3>What You'll Need</h3>
        <ul>
          <li>A connected wallet (MetaMask, Trust Wallet, etc.)</li>
          <li>BNB (for BNB Chain) or ETH (for Ethereum) to cover gas fees</li>
          <li>Some crypto to swap</li>
        </ul>

        <h3>Benefits of Using a DEX</h3>
        <ul>
          <li>100% control of your funds — no custody risk</li>
          <li>No registration, KYC, or personal data</li>
          <li>Access to early-stage and community tokens like KLY</li>
        </ul>

        <h3>Real-World Example</h3>
        <p>Jane connects to PancakeSwap with her Trust Wallet, swaps BNB for KLY, and receives KLY instantly — no account, no delay, no bank required.</p>

        <h3>KLY Integration Tip</h3>
        <p>You can trade into KLY directly from PancakeSwap using the BNB/KLY pair. Add the official token address from the KLY dashboard to make sure you're swapping the correct token.</p>

        <div style="text-align: center; margin-top: 2rem;">
          <a class="module-next" onclick="showModule('module4')">Next: Earning with DeFi (Yield & Lending)</a>
        </div>
      </div>
    </div>

    <div id="module4" class="module-card">
      <div class="module-title">Module 4: Earning with DeFi (Yield & Lending)</div>
      <div class="module-content">

        <h3>Overview</h3>
        <p>One of the most powerful opportunities in DeFi is the ability to earn passive income through staking, lending, and yield farming. These methods let you grow your crypto without needing to actively trade.</p>

        <h3>Objectives</h3>
        <ul>
          <li>Understand how DeFi generates yield</li>
          <li>Learn the differences between staking, lending, and yield farming</li>
          <li>Explore platforms that offer passive income opportunities</li>
        </ul>

        <h3>1. Staking</h3>
        <p>Staking involves locking your tokens in a smart contract to support a network or protocol. In return, you earn rewards — usually in the same token.</p>
        <ul>
          <li><strong>Example:</strong> Stake KLY tokens to earn more KLY over time.</li>
          <li><strong>Platforms:</strong> KLY Platform, PancakeSwap Syrup Pools</li>
        </ul>

        <h3>2. Lending</h3>
        <p>With DeFi lending, you deposit tokens into a lending pool. Borrowers take loans from the pool and pay interest, which is distributed to lenders like you.</p>
        <ul>
          <li><strong>Example:</strong> Lend BUSD on Venus or Aave and earn 5–12% APY</li>
          <li><strong>Assets:</strong> Stablecoins (BUSD, USDT), BNB, ETH, etc.</li>
        </ul>

        <h3>3. Yield Farming</h3>
        <p>Yield farming involves providing liquidity to a DEX and earning rewards from trading fees and bonus tokens. It's higher risk but can offer higher returns.</p>
        <ul>
          <li><strong>Example:</strong> Add KLY/USDT liquidity to PancakeSwap and earn LP rewards</li>
          <li><strong>Risk Note:</strong> You may face impermanent loss — make sure to understand the mechanics</li>
        </ul>

        <h3>Top Platforms to Explore</h3>
        <ul>
          <li><a href="https://app.venus.io" target="_blank">Venus</a> – Lending & borrowing on BNB Chain</li>
          <li><a href="https://pancakeswap.finance" target="_blank">PancakeSwap</a> – Staking and farming</li>
          <li><a href="https://aave.com" target="_blank">Aave</a> – Lending on Ethereum and Polygon</li>
        </ul>

        <h3>Tips for Earning Safely</h3>
        <ul>
          <li>Always start small and test the platform before depositing large amounts</li>
          <li>Look for audited smart contracts and community trust</li>
          <li>Track your yield and set long-term goals</li>
        </ul>

        <h3>Real-World Example</h3>
        <p>Marcus stakes 5,000 KLY on the Kelly Legacy Platform. In 30 days, he earns 250 KLY in staking rewards — all without trading or selling.</p>

        <h3>KLY Integration Tip</h3>
        <p>Use the <strong>Liberty Pool</strong> on PancakeSwap to provide KLY/USDT liquidity and farm LP tokens. Stakers also gain governance power in the KLY DAO.</p>

        <div style="text-align: center; margin-top: 2rem;">
          <a class="module-next" onclick="showModule('module5')">Next: DeFi Safety & Long-Term Strategy</a>
        </div>
      </div>
    </div>

    <div id="module5" class="module-card">
      <div class="module-title">Module 5: DeFi Safety & Long-Term Strategy</div>
      <div class="module-content">

        <h3>Overview</h3>
        <p>DeFi offers freedom, but also places responsibility in your hands. This module teaches you how to avoid scams, secure your wallet, and build a sustainable strategy for growing your digital wealth over time.</p>

        <h3>Objectives</h3>
        <ul>
          <li>Learn the most common DeFi risks and how to avoid them</li>
          <li>Master wallet safety and identity protection</li>
          <li>Build a long-term crypto investment strategy</li>
        </ul>

        <h3>1. Common DeFi Risks</h3>
        <ul>
          <li><strong>Rugpulls:</strong> A scam where developers drain a project's liquidity and disappear</li>
          <li><strong>Phishing:</strong> Fake links or messages that trick you into sharing wallet access</li>
          <li><strong>Smart Contract Bugs:</strong> Code vulnerabilities hackers can exploit</li>
          <li><strong>Impermanent Loss:</strong> A loss in value from providing liquidity to unstable pairs</li>
        </ul>

        <h3>2. Safety Tips</h3>
        <ul>
          <li>Only use verified links and bookmark your favorite DeFi platforms</li>
          <li>Never share your recovery phrase — not even with "support agents"</li>
          <li>Use a hardware wallet (e.g., Ledger or Trezor) for large holdings</li>
          <li>Use burner wallets for testing new dApps</li>
        </ul>

        <h3>3. Long-Term Strategy</h3>
        <ul>
          <li><strong>Diversify:</strong> Don't put all your assets in one protocol or token</li>
          <li><strong>Reinvest profits:</strong> Grow your staking, LP, or lending positions over time</li>
          <li><strong>Take profits:</strong> Periodically convert yield into stablecoins or reinvest wisely</li>
          <li><strong>Stay educated:</strong> Follow news, audits, and DAO governance updates</li>
        </ul>

        <h3>KLY Wealth Blueprint Tip</h3>
        <p>Once you've completed this course, stake your KLY or launch your own token via the <strong>KLY Launchpad</strong>. Use your NFT certificate to unlock bonus content and governance rights.</p>

        <blockquote style="border-left: 4px solid #00ffe7; padding-left: 1rem; margin-top: 2rem; color: #aaa;">
          "In DeFi, the most powerful strategy is education + protection."  
        </blockquote>

        <div style="text-align: center; margin-top: 2rem;">
          <a class="module-next" onclick="showModule('module1')">Return to DeFi Course</a>
        </div>
      </div>
    </div>

    <div style="text-align: center; margin-top: 2.5rem;">
      <button class="nav-button" onclick="mintCertificate()">Mint NFT Certificate</button>
      <p id="mint-status"></p>
    </div>
  </div>

  <script>
    // Contract addresses and ABIs
    const KLY_TOKEN_ADDRESS = "0x2e4fEB2Fe668c8Ebe84f19e6c8fE8Cf8131B4E52";
    const NFT_CONTRACT_ADDRESS = "0xc1a2E9A475779EfD04247EA473638717E26cd5C5";

    const KLY_TOKEN_ABI = [
      "function balanceOf(address) view returns (uint256)",
      "function decimals() view returns (uint8)"
    ];

    const NFT_CONTRACT_ABI = [
      "function mintTo(address to, string memory uri) public"
    ];

    // Global variables
    let provider, signer, userAddress;
    const connectBtn = document.getElementById('connect-btn');
    const walletStatus = document.getElementById('wallet-status');
    const courseWrapper = document.getElementById('course-wrapper');

    // Connect wallet function
    async function connectWallet() {
      if (typeof window.ethereum === 'undefined') {
        walletStatus.textContent = "MetaMask not detected. Please install it first.";
        return;
      }

      try {
        connectBtn.textContent = "Connecting...";
        walletStatus.textContent = "";
        
        // Request account access
        provider = new ethers.providers.Web3Provider(window.ethereum);
        await provider.send("eth_requestAccounts", []);
        signer = provider.getSigner();
        userAddress = await signer.getAddress();
        
        // Shorten address for display
        const shortAddress = `${userAddress.substring(0, 6)}...${userAddress.substring(38)}`;
        walletStatus.textContent = `Connected: ${shortAddress}`;
        
        // Check KLY balance
        const klyContract = new ethers.Contract(KLY_TOKEN_ADDRESS, KLY_TOKEN_ABI, provider);
        const rawBalance = await klyContract.balanceOf(userAddress);
        const decimals = await klyContract.decimals();
        const adjustedBalance = parseFloat(ethers.utils.formatUnits(rawBalance, decimals));
        
        if (adjustedBalance >= 500) {
          // Grant access to course
          connectBtn.style.display = 'none';
          document.querySelector('.course-box p.note').style.display = 'none';
          courseWrapper.style.display = 'block';
          showModule('module1');
        } else {
          walletStatus.textContent = `Insufficient KLY balance: ${adjustedBalance.toFixed(2)}/500 required`;
        }
      } catch (error) {
        console.error("Wallet connection error:", error);
        walletStatus.textContent = error.code === 4001 
          ? "Connection rejected by user" 
          : "Failed to connect wallet";
      } finally {
        connectBtn.textContent = "Connect Wallet to Unlock Course";
      }
    }

    // Mint certificate function
    async function mintCertificate() {
      if (!signer) {
        alert("Please connect your wallet first");
        return;
      }

      try {
        document.getElementById("mint-status").textContent = "Minting in progress...";
        
        const contract = new ethers.Contract(NFT_CONTRACT_ADDRESS, NFT_CONTRACT_ABI, signer);
        const tx = await contract.mintTo(
          userAddress, 
          "ipfs://bafybeihkmkaf2mgx7xkrnkhmzd2uvhr6ddgj6z3vkqcgnvlaa3z7x263r4"
        );
        
        await tx.wait();
        document.getElementById("mint-status").textContent = "Certificate Minted Successfully!";
      } catch (error) {
        console.error("Minting error:", error);
        document.getElementById("mint-status").textContent = "Minting failed. Please try again.";
      }
    }

    // Show module function
    function showModule(moduleId) {
      document.querySelectorAll('.module-card').forEach(card => {
        card.style.display = 'none';
      });
      document.getElementById(moduleId).style.display = 'block';
    }

    // Event listeners
    window.addEventListener('load', async () => {
      if (window.ethereum) {
        // Check if already connected
        const accounts = await window.ethereum.request({ method: 'eth_accounts' });
        if (accounts.length > 0) {
          await connectWallet();
        }
        
        // Listen for account changes
        window.ethereum.on('accountsChanged', (accounts) => {
          if (accounts.length === 0) {
            // Wallet disconnected
            connectBtn.style.display = 'block';
            document.querySelector('.course-box p.note').style.display = 'block';
            courseWrapper.style.display = 'none';
            walletStatus.textContent = "Wallet disconnected";
          } else {
            // Account changed
            connectWallet();
          }
        });
        
        // Listen for chain changes
        window.ethereum.on('chainChanged', () => {
          window.location.reload();
        });
      }
    });

    // Make functions available globally
    window.connectWallet = connectWallet;
    window.mintCertificate = mintCertificate;
    window.showModule = showModule;
  </script>
</body>
</html>
