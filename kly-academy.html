<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Updated Meta Tags -->
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="KLY Academy - Master DeFi with our token-gated educational platform">
  <title>KLY Academy | DeFi Education Portal</title>
 
  <!-- Favicon -->
  <link rel="icon" href="favicon.ico" type="image/x-icon">
 
  <!-- Fonts & Icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Kanit:wght@300;500&display=swap" rel="stylesheet">
 
  <!-- Libraries -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
  <script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>
  <script src="https://unpkg.com/web3modal@1.9.12/dist/index.js"></script>
  <script src="https://unpkg.com/@walletconnect/web3-provider@1.8.0/dist/umd/index.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
 
  <style>
    :root {
      --neon-blue: #0ff;
      --neon-pink: #ff00cc;
      --dark-bg: #050505;
      --card-bg: linear-gradient(145deg, #0a0a0a, #000);
      --success: #00ff88;
    }
 
    /* Base Styles (similar to Path of Awakening) */
    body {
      background: var(--dark-bg) url('https://i.imgur.com/JWqJZQb.png') no-repeat fixed;
      background-size: cover;
      color: #fff;
      font-family: 'Kanit', sans-serif;
      margin: 0;
      padding: 0;
      min-height: 100vh;
    }
 
    /* Academy-Specific Enhancements */
    .academy-header {
      text-align: center;
      padding: 2rem 0;
      background: rgba(0,0,0,0.7);
      margin-bottom: 2rem;
      border-bottom: 1px solid var(--neon-blue);
    }
   
    .academy-title {
      font-family: 'Orbitron', sans-serif;
      font-size: 2.8rem;
      background: linear-gradient(90deg, var(--neon-blue), var(--neon-pink));
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
      text-shadow: 0 0 20px rgba(0, 255, 255, 0.3);
      margin: 0;
      animation: pulse 3s ease-in-out infinite;
    }
 
    .academy-subtitle {
      color: #aaa;
      font-size: 1.2rem;
      margin-top: 0.5rem;
    }
 
    @keyframes pulse {
      0%, 100% { opacity: 0.9; }
      50% { opacity: 1; text-shadow: 0 0 30px rgba(0, 255, 255, 0.5); }
    }
 
    /* Enhanced Module Cards */
    .module-card {
      border: 2px solid var(--neon-blue);
      border-radius: 1.5rem;
      margin: 2rem auto;
      padding: 2rem;
      max-width: 800px;
      background: var(--card-bg);
      box-shadow: 0 0 40px rgba(0, 255, 255, 0.2);
      backdrop-filter: blur(10px);
      transition: all 0.3s ease;
    }
 
    .module-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 0 50px rgba(0, 255, 255, 0.4);
    }
 
    /* Badges for Completed Modules */
    .badge-completed {
      display: inline-block;
      background: var(--success);
      color: #000;
      padding: 0.3rem 0.8rem;
      border-radius: 1rem;
      font-weight: bold;
      font-size: 0.8rem;
      margin-left: 1rem;
      animation: pulse 2s infinite;
    }
 
    /* Responsive Improvements */
    @media (max-width: 768px) {
      .academy-title {
        font-size: 2rem;
      }
     
      .module-card {
        padding: 1.5rem;
        margin: 1.5rem auto;
      }
    }
 
  </style>
</head>
<body>
 
  <!-- New Academy Header -->
  <header class="academy-header animate__animated animate__fadeIn">
    <h1 class="academy-title">KLY ACADEMY</h1>
    <p class="academy-subtitle">Token-Gated DeFi Education</p>
  </header>
 
  <div class="container">
    <!-- Token Gate Section -->
    <div class="course-box">
      <div class="module-nav-container">
        <!-- Module navigation buttons -->
      </div>
     
      <p class="note">Hold 100+ KLY tokens to access the full course</p>
      <button id="connect-btn" class="button" onclick="connectWallet()">
        <i class="fas fa-lock-open"></i> Connect Wallet to Unlock
      </button>
      <div id="wallet-status"></div>
     
      <div class="progress-container" style="display: none;">
        <div class="progress-bar-bg">
          <div id="progress-bar" class="progress-bar"></div>
        </div>
        <p id="progress-text">0/5 modules completed</p>
      </div>
    </div>
 
    <!-- Course Content (hidden until wallet connects) -->
    <div id="course-wrapper" style="display: none;">

    <!-- MODULE 1 -->
    <div id="module1" class="module-card animate__animated">
      <div class="module-title">Module 1: What is DeFi?</div>
      <div class="module-content">
        <h3>Overview</h3>
        <p>Decentralized Finance (DeFi) is a groundbreaking evolution of traditional finance. Instead of relying on banks or intermediaries, DeFi uses blockchain technology to give you direct, secure, and transparent control over your finances.</p>

        <h3>Objectives</h3>
        <ul>
          <li>Understand the fundamentals of DeFi</li>
          <li>Explore the benefits of decentralization</li>
          <li>Recognize the risks and responsibilities involved</li>
        </ul>

        <h3>Core Concepts</h3>
        <ul>
          <li><strong>Blockchain:</strong> A secure, transparent ledger that records every transaction.</li>
          <li><strong>Smart Contracts:</strong> Self-executing digital contracts coded directly into the blockchain.</li>
          <li><strong>Non-Custodial:</strong> Full ownership of your funds — no banks, no middlemen.</li>
        </ul>

        <h3>Why It Matters</h3>
        <p>Traditional finance is often slow, costly, and exclusive. DeFi removes gatekeepers, lowers fees, and democratizes access to financial tools — all you need is a crypto wallet.</p>

        <h3>Real-World Example</h3>
        <p>Imagine lending crypto to someone in another country and earning interest — instantly, without banks or paperwork. That's DeFi in action.</p>

        <h3>KLY Integration</h3>
        <p>KLY is a utility token designed to power DeFi education and access. Holding KLY unlocks premium content, platform features, and DAO governance rights.</p>

        <blockquote style="border-left: 3px solid var(--neon-pink); padding-left: 15px; font-style: italic;">
          "DeFi is finance by the people, for the people."
        </blockquote>

        <div class="module-navigation">
          <a class="module-next" onclick="showModule('module2')">
            <i class="fas fa-arrow-right"></i> Next: Setting Up Your Wallet
          </a>
        </div>
      </div>
    </div>

    <!-- MODULE 2 -->
    <div id="module2" class="module-card animate__animated">
      <div class="module-title">Module 2: Setting Up Your Wallet</div>
      <div class="module-content">
        <h3>Overview</h3>
        <p>Your DeFi wallet is your digital passport. It stores your assets, connects you to dApps, and empowers you to interact directly with Web3 platforms. In this module, you'll learn how to create, secure, and fund your wallet.</p>

        <h3>Objectives</h3>
        <ul>
          <li>Understand what DeFi wallets do</li>
          <li>Create and back up your wallet securely</li>
          <li>Fund and connect your wallet to the DeFi ecosystem</li>
        </ul>

        <h3>Step-by-Step: Create Your Wallet</h3>

        <h4>Step 1: Choose a Wallet</h4>
        <ul>
          <li><strong>MetaMask:</strong> Leading browser/mobile wallet for Ethereum and BNB Chain.</li>
          <li><strong>Trust Wallet:</strong> Mobile-first wallet supporting multiple blockchains.</li>
          <li><strong>Coinbase Wallet:</strong> Ideal for beginners — not the same as Coinbase Exchange.</li>
        </ul>

        <h4>Step 2: Install the Wallet</h4>
        <p>Use official sources only:</p>
        <ul>
          <li><a href="https://metamask.io" target="_blank" style="color: var(--neon-blue);">MetaMask.io</a></li>
          <li>Or download from the App Store / Google Play</li>
        </ul>

        <h4>Step 3: Backup Your Secret Phrase</h4>
        <p>Write down your 12- or 24-word recovery phrase during setup. Never store it online or share it. It's the master key to your funds.</p>

        <h4>Step 4: Fund Your Wallet</h4>
        <ul>
          <li>Transfer BNB (for BNB Chain) or ETH (for Ethereum) from a centralized exchange</li>
          <li>Receive crypto directly from another wallet</li>
        </ul>

        <h4>Step 5: Connect to a dApp</h4>
        <p>Visit any DeFi-enabled site (like <strong>kellylegacyestates.com</strong>) and click <em>"Connect Wallet"</em>. Confirm the connection in your wallet app.</p>

        <h3>Wallet Safety Tips</h3>
        <ul>
          <li>Verify URLs before connecting</li>
          <li>Use a hardware wallet for large balances</li>
          <li>Enable password and biometric protection</li>
          <li>Never share your recovery phrase</li>
        </ul>

        <h3>Real-World Example</h3>
        <p>John installs MetaMask, sends $100 in BNB from Binance, and connects to PancakeSwap. He's trading within minutes — no banks, no delays.</p>

        <h3>KLY Integration</h3>
        <p>To unlock advanced KLY features like certificate minting and governance, you'll need a wallet with KLY tokens connected to the platform.</p>

        <div class="module-navigation">
          <a class="module-next" onclick="showModule('module3')">
            <i class="fas fa-arrow-right"></i> Next: Using Decentralized Exchanges
          </a>
        </div>
      </div>
    </div>
    
    <!-- MODULE 3 -->
    <div id="module3" class="module-card animate__animated">
      <div class="module-title">Module 3: Using Decentralized Exchanges (DEXs)</div>
      <div class="module-content">

        <h3>Overview</h3>
        <p>Decentralized Exchanges (DEXs) allow you to trade crypto directly from your wallet — no registration, no middlemen. These platforms use smart contracts to enable peer-to-peer trading securely and transparently.</p>

        <h3>Objectives</h3>
        <ul>
          <li>Understand how DEXs differ from centralized exchanges</li>
          <li>Learn how to swap tokens using your wallet</li>
          <li>Explore top DEX platforms on Ethereum and BNB Chain</li>
        </ul>

        <h3>How to Trade on a DEX</h3>

        <h4>Step 1: Connect Your Wallet</h4>
        <p>Go to a trusted DEX like <a href="https://pancakeswap.finance" target="_blank" style="color: var(--neon-blue);">PancakeSwap</a> or <a href="https://uniswap.org" target="_blank" style="color: var(--neon-blue);">Uniswap</a>. Click "Connect Wallet" and approve the request from your wallet app.</p>

        <h4>Step 2: Select Tokens</h4>
        <p>Choose the crypto you want to swap (e.g., BNB) and the one you want to receive (e.g., KLY). Enter the amount.</p>

        <h4>Step 3: Review and Confirm</h4>
        <p>Click "Swap" and approve the transaction in your wallet. Pay the small gas fee, and your tokens will appear in your wallet within seconds.</p>

        <h3>Popular DEX Platforms</h3>
        <ul>
          <li><a href="https://pancakeswap.finance" target="_blank" style="color: var(--neon-blue);">PancakeSwap</a> – Best for BNB Chain</li>
          <li><a href="https://uniswap.org" target="_blank" style="color: var(--neon-blue);">Uniswap</a> – Pioneer DEX on Ethereum</li>
          <li><a href="https://app.1inch.io" target="_blank" style="color: var(--neon-blue);">1inch</a> – Aggregates best rates across multiple DEXs</li>
        </ul>

        <h3>What You'll Need</h3>
        <ul>
          <li>A DeFi wallet (e.g., MetaMask or Trust Wallet)</li>
          <li>BNB or ETH to pay gas fees</li>
          <li>The crypto you want to trade</li>
        </ul>

        <h3>Benefits of DEXs</h3>
        <ul>
          <li>Full control of your funds — no third-party custody</li>
          <li>No KYC or personal data required</li>
          <li>Access to new and community-driven tokens like KLY</li>
        </ul>

        <h3>Real-World Example</h3>
        <p>Jane connects Trust Wallet to PancakeSwap, swaps BNB for KLY, and receives her tokens in real time — no signup, no wait.</p>

        <h3>KLY Integration</h3>
        <p>You can buy KLY using BNB on PancakeSwap. Always verify the official token address from the KLY dashboard before swapping.</p>

        <div class="module-navigation">
          <a class="module-next" onclick="showModule('module4')">
            <i class="fas fa-arrow-right"></i> Next: Earning with DeFi
          </a>
        </div>
      </div>
    </div>
    
    <!-- MODULE 4 -->
    <div id="module4" class="module-card animate__animated">
      <div class="module-title">Module 4: Earning with DeFi (Yield & Lending)</div>
      <div class="module-content">

        <h3>Overview</h3>
        <p>DeFi enables passive income through staking, lending, and yield farming — allowing you to earn without actively trading. This module breaks down each method and how to get started safely.</p>

        <h3>Objectives</h3>
        <ul>
          <li>Understand how DeFi generates passive income</li>
          <li>Compare staking, lending, and yield farming</li>
          <li>Identify top platforms to start earning</li>
        </ul>

        <h3>1. Staking</h3>
        <p>Lock your tokens in a smart contract to earn rewards. You help secure the network or support a protocol while earning more of the same token.</p>
        <ul>
          <li><strong>Example:</strong> Stake KLY to earn additional KLY</li>
          <li><strong>Platforms:</strong> Kelly Legacy Platform, PancakeSwap</li>
        </ul>

        <h3>2. Lending</h3>
        <p>Deposit crypto into a lending pool where borrowers pay interest. You earn that interest passively.</p>
        <ul>
          <li><strong>Example:</strong> Lend BUSD on Venus to earn up to 12% APY</li>
          <li><strong>Assets:</strong> BUSD, USDT, BNB, ETH</li>
        </ul>

        <h3>3. Yield Farming</h3>
        <p>Provide liquidity to a DEX (by pairing two tokens), then earn trading fees and bonus tokens. This is higher risk but can generate higher returns.</p>
        <ul>
          <li><strong>Example:</strong> Add KLY/USDT liquidity to PancakeSwap</li>
          <li><strong>Note:</strong> Be aware of impermanent loss</li>
        </ul>

        <h3>Top Platforms</h3>
        <ul>
          <li><a href="https://app.venus.io" target="_blank" style="color: var(--neon-blue);">Venus</a> – Lending on BNB Chain</li>
          <li><a href="https://pancakeswap.finance" target="_blank" style="color: var(--neon-blue);">PancakeSwap</a> – Staking and LP rewards</li>
          <li><a href="https://aave.com" target="_blank" style="color: var(--neon-blue);">Aave</a> – Lending on Ethereum and Polygon</li>
        </ul>

        <h3>Tips for Earning Safely</h3>
        <ul>
          <li>Start small and test the platform</li>
          <li>Only use trusted, audited platforms</li>
          <li>Track your rewards and set goals</li>
        </ul>

        <h3>Real-World Example</h3>
        <p>Marcus stakes 5,000 KLY and earns 250 KLY in rewards after 30 days — no trading required.</p>

        <h3>KLY Integration</h3>
        <p>Use the Liberty Pool on PancakeSwap to farm KLY/USDT LP tokens. Staking also grants governance rights in the KLY DAO.</p>

        <div class="module-navigation">
          <a class="module-next" onclick="showModule('module5')">
            <i class="fas fa-arrow-right"></i> Next: DeFi Safety & Strategy
          </a>
        </div>
      </div>
    </div>
    
    <!-- MODULE 5 -->
    <div id="module5" class="module-card animate__animated">
      <div class="module-title">Module 5: DeFi Safety & Long-Term Strategy</div>
      <div class="module-content">

        <h3>Overview</h3>
        <p>With great freedom comes great responsibility. This module helps you protect your assets, avoid common scams, and build a smart, sustainable crypto strategy.</p>

        <h3>Objectives</h3>
        <ul>
          <li>Learn the major risks in DeFi</li>
          <li>Practice wallet safety and protection</li>
          <li>Build a smart, long-term investment strategy</li>
        </ul>

        <h3>Common Risks</h3>
        <ul>
          <li><strong>Rugpulls:</strong> When developers abandon a project after draining funds</li>
          <li><strong>Phishing:</strong> Fake links and impostor sites tricking users</li>
          <li><strong>Smart Contract Bugs:</strong> Code flaws hackers can exploit</li>
          <li><strong>Impermanent Loss:</strong> Value loss from providing liquidity</li>
        </ul>

        <h3>Security Best Practices</h3>
        <ul>
          <li>Bookmark trusted platforms — avoid random links</li>
          <li>Never share your seed phrase — ever</li>
          <li>Use hardware wallets for high-value holdings</li>
          <li>Use "burner wallets" to test new dApps</li>
        </ul>

        <h3>Long-Term Wealth Strategy</h3>
        <ul>
          <li><strong>Diversify:</strong> Spread risk across assets and protocols</li>
          <li><strong>Reinvest:</strong> Compound your yield over time</li>
          <li><strong>Take Profits:</strong> Secure gains into stablecoins or move to cold storage</li>
          <li><strong>Stay Informed:</strong> Follow news, audits, and governance changes</li>
        </ul>

        <h3>KLY Wealth Blueprint</h3>
        <p>After completing this course, you can stake KLY, mint your NFT Certificate, and even launch your own project via the KLY Launchpad. Education is just the beginning.</p>

        <blockquote style="border-left: 4px solid var(--neon-blue); padding-left: 1rem; margin-top: 2rem; color: #aaa;">
          "In DeFi, the most powerful strategy is education + protection."
        </blockquote>

        <div class="module-navigation">
          <a class="module-next" onclick="showModule('module1')">
            <i class="fas fa-arrow-left"></i> Return to Module 1
          </a>
        </div>
      </div>
    </div>

    </div>
 
    <!-- Certificate Section -->
    <div id="certificate-section" style="display: none; text-align: center;">
      <h3 style="color: var(--neon-blue); margin-bottom: 1rem;">Complete all modules to mint your NFT Certificate</h3>
      <button class="button" onclick="mintCertificate()">
        <i class="fas fa-award"></i> Mint Completion Certificate
      </button>
      <div id="mint-status"></div>
    </div>
  </div>
 
<script>
  // Updated Token and Contract Addresses (verify these are correct)
  const KLY_TOKEN_ADDRESS = "0x2e4fEB2Fe668c8Ebe84f19e6c8fE8Cf8131B4E52";
  const NFT_CONTRACT_ADDRESS = "0xc1a2E9A475779EfD04247EA473638717E26cd5C5";
 
  // Initialize Web3Modal
  async function initWeb3Modal() {
    const providerOptions = {
      walletconnect: {
        package: window.WalletConnectProvider.default,
        options: {
          rpc: {
            56: "https://bsc-dataseed.binance.org/" // Updated BSC endpoint
          }
        }
      }
    };
   
    web3Modal = new window.Web3Modal.default({
      cacheProvider: true,
      providerOptions,
      theme: "dark"
    });
  }
 
  // Enhanced connectWallet function
  async function connectWallet() {
    try {
      const connectBtn = document.getElementById('connect-btn');
      connectBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Connecting...';
     
      const instance = await web3Modal.connect();
      provider = new ethers.providers.Web3Provider(instance);
      signer = provider.getSigner();
      userAddress = await signer.getAddress();
 
      // Network check
      const network = await provider.getNetwork();
      if (network.chainId !== 56) {
        showNotification("Please switch to BNB Chain", "warning");
        await promptSwitchNetwork();
        return;
      }
 
      // Verify KLY balance
      const hasAccess = await verifyTokenAccess();
      if (hasAccess) {
        unlockCourseContent();
        showNotification("Welcome to KLY Academy!", "success");
      }
     
    } catch (error) {
      console.error("Connection error:", error);
      showNotification(`Connection failed: ${error.message}`, "error");
    } finally {
      const connectBtn = document.getElementById('connect-btn');
      connectBtn.innerHTML = '<i class="fas fa-lock-open"></i> Connect Wallet to Unlock';
    }
  }
 
  // New function to prompt network switch
  async function promptSwitchNetwork() {
    try {
      await window.ethereum.request({
        method: 'wallet_switchEthereumChain',
        params: [{ chainId: '0x38' }], // BNB Chain ID
      });
      return true;
    } catch (error) {
      if (error.code === 4902) {
        try {
          await window.ethereum.request({
            method: 'wallet_addEthereumChain',
            params: [{
              chainId: '0x38',
              chainName: 'BNB Smart Chain',
              nativeCurrency: {
                name: 'BNB',
                symbol: 'BNB',
                decimals: 18
              },
              rpcUrls: ['https://bsc-dataseed.binance.org/'],
              blockExplorerUrls: ['https://bscscan.com']
            }]
          });
          return true;
        } catch (addError) {
          console.error("Error adding BSC network:", addError);
          return false;
        }
      }
      console.error("Error switching network:", error);
      return false;
    }
  }
 
  // Enhanced token verification
  async function verifyTokenAccess() {
    const walletStatus = document.getElementById('wallet-status');
   
    try {
      const klyContract = new ethers.Contract(KLY_TOKEN_ADDRESS, [
        "function balanceOf(address) view returns (uint256)",
        "function decimals() view returns (uint8)"
      ], provider);
 
      const balance = await klyContract.balanceOf(userAddress);
      const decimals = await klyContract.decimals();
      const formattedBalance = ethers.utils.formatUnits(balance, decimals);
      const klyBalance = parseFloat(formattedBalance);
 
      const displayBalance = klyBalance.toFixed(2);
      const displayAddress = `${userAddress.substring(0, 6)}...${userAddress.slice(-4)}`;
 
      walletStatus.innerHTML = `
        <div style="margin-top: 1rem;">
          <span style="color: var(--neon-blue)">Connected:</span> ${displayAddress}
          <br>
          <span style="color: ${klyBalance >= 100 ? 'var(--success)' : '#ff5555'}">
            KLY Balance: ${displayBalance}/100
          </span>
          ${klyBalance < 100 ? `
            <br>
            <a href="https://pancakeswap.finance/swap?outputCurrency=${KLY_TOKEN_ADDRESS}"
               target="_blank"
               style="color: var(--neon-pink); text-decoration: none;">
              <i class="fas fa-external-link-alt"></i> Get KLY on PancakeSwap
            </a>
          ` : ''}
        </div>
      `;
 
      return klyBalance >= 100;
     
    } catch (error) {
      console.error("Token verification failed:", error);
      walletStatus.innerHTML = `
        <div style="color: #ff5555; margin-top: 1rem;">
          Error verifying token balance. Please try again.
        </div>
      `;
      return false;
    }
  }

  async function disconnectWallet() {
    if (web3Modal && web3Modal.clearCachedProvider) {
      await web3Modal.clearCachedProvider();
    }
    walletStatus.textContent = "Wallet disconnected";
    connectBtn.style.display = 'block';
    document.querySelector('.course-box p.note').style.display = 'block';
    courseWrapper.style.display = 'none';
    certificateSection.style.display = 'none';
  }

 
  // Function to unlock course content
  function unlockCourseContent() {
    document.getElementById('connect-btn').style.display = 'none';
    document.querySelector('.course-box p.note').style.display = 'none';
    document.getElementById('course-wrapper').style.display = 'block';
    document.getElementById('certificate-section').style.display = 'block';
   
    // Show first module by default
    showModule('module1');
  }
 
  // Initialize when page loads
  window.addEventListener('load', async () => {
    await initWeb3Modal();
    if (web3Modal.cachedProvider) {
      await connectWallet();
    }
   
    // Add any other initialization code
  });
 

  async function mintCertificate() {
    if (!signer) return showNotification("Connect wallet first", "error");
    const mintStatus = document.getElementById("mint-status");
    try {
      mintStatus.innerHTML = `<div class="loader" style="display:block;"></div><p>Preparing your NFT certificate...</p>`;
      const nft = new ethers.Contract(NFT_CONTRACT_ADDRESS, NFT_CONTRACT_ABI, signer);
      const gas = await nft.estimateGas.mintTo(userAddress, "ipfs://bafybeihkmkaf2mgx7xkrnkhmzd2uvhr6ddgj6z3vkqcgnvlaa3z7x263r4");
      const tx = await nft.mintTo(userAddress, "ipfs://bafybeihkmkaf2mgx7xkrnkhmzd2uvhr6ddgj6z3vkqcgnvlaa3z7x263r4", { gasLimit: gas.mul(120).div(100) });
      mintStatus.innerHTML = `<div class="loader" style="display:block;"></div><p>Minting in progress...</p>
        <a href="https://bscscan.com/tx/${tx.hash}" target="_blank" style="color: var(--neon-blue)">View on BscScan</a>`;
      await tx.wait();
      mintStatus.innerHTML = `<p style="color: #4caf50">✅ Certificate Minted Successfully!</p>`;
      launchConfetti();
    } catch (err) {
      console.error(err);
      showNotification(`Minting failed: ${err.message}`, "error");
      mintStatus.innerHTML = `<p style="color: #ff5555">❌ Minting failed</p><p>${err.message}</p>`;
    }
  }

  function showModule(id) {
    document.querySelectorAll('.module-card').forEach(el => {
      el.style.display = 'none';
      el.classList.remove('animate__fadeIn');
    });
    const el = document.getElementById(id);
    el.style.display = 'block';
    el.classList.add('animate__animated', 'animate__fadeIn');
  }

  function launchConfetti() {
    if (typeof confetti === 'function') {
      confetti({ particleCount: 150, spread: 70, origin: { y: 0.6 }, colors: ['#0ff', '#ff00cc', '#ffffff'] });
    }
  }

  function showNotification(msg, type = 'info') {
    const color = {
      info: '#2196F3',
      success: '#4CAF50',
      error: '#F44336',
      warning: '#FF9800'
    }[type];
    const note = document.createElement('div');
    note.className = `notification ${type}`;
    note.innerHTML = msg;
    note.style.backgroundColor = color;
    document.body.appendChild(note);
    setTimeout(() => {
      note.style.animation = 'fadeOut 0.5s';
      setTimeout(() => note.remove(), 500);
    }, 5000);
  }

  window.addEventListener('load', async () => {
    await initWeb3Modal();
    if (web3Modal.cachedProvider) {
      await connectWallet();
    }
  });

  window.connectWallet = connectWallet;
  window.disconnectWallet = disconnectWallet;
  window.mintCertificate = mintCertificate;
  window.showModule = showModule;
</script>
</body>
</html>

